---
title: Regression Models & Descriptive Statistics

date: 2018-10-21T00:00:00.000Z
lastmod: 2018-10-21T00:00:00.000Z

draft: false
type: docs

output:
  blogdown::html_page:
    toc: true
    
linktitle: Regression Models & Descriptive Statistics
menu:
  statsformdl:
    parent: Overview
    weight: 2
---


<div id="TOC">
<ul>
<li><a href="#generate-the-data">Generate the data</a></li>
<li><a href="#descriptive-statistics">Descriptive statistics</a></li>
<li><a href="#regression-analysis">Regression analysis</a></li>
<li><a href="#looking-at-gender-and-disease-at-the-same-time">Looking at gender and disease at the same time</a></li>
<li><a href="#a-collapsible-section-with-markdown">A collapsible section with markdown</a></li>
<li><a href="#take-away-message">Take-away message</a></li>
<li><a href="#what-to-do-in-more-complex-settings">What to do in more complex settings?</a></li>
</ul>
</div>

<p>Sometimes, the results from a multivariable regression analysis seem to disagre
with with what we find when we look at simple descriptive statistics of the
data. Do demonstrate the issue we look at a simple example, which we simulate.</p>
<div id="generate-the-data" class="section level3">
<h3>Generate the data</h3>
<p>We simulate some data for this simple example:</p>
<pre class="r"><code>set.seed(2018)
gender &lt;- rep(c(0,1), c(700, 300))
exposure &lt;- runif(1000, min = 0 + gender*0.3, 0.5 + gender*0.5)
disease &lt;- rbinom(1000, size = 1, prob = plogis(1.5 * gender - 0.9 * exposure))

DF = data.frame(gender = factor(gender, labels = c(&#39;female&#39;, &#39;male&#39;)),
                exposure = exposure,
                disease = factor(disease, labels = c(&#39;healthy&#39;, &#39;diseased&#39;)))</code></pre>
<p>We now have data from 1000 subjects:</p>
<pre class="r"><code>summary(DF)</code></pre>
<pre><code>##     gender       exposure            disease   
##  female:700   Min.   :0.001435   healthy :497  
##  male  :300   1st Qu.:0.183470   diseased:503  
##               Median :0.344952                 
##               Mean   :0.364893                 
##               3rd Qu.:0.472183                 
##               Max.   :0.995796</code></pre>
</div>
<div id="descriptive-statistics" class="section level3">
<h3>Descriptive statistics</h3>
<p>When we look at descriptive statistics of the exposure, stratified by disease
status, we see that diseased subjects tend to have higher values of the exposure
than the healthy subjects:</p>
<pre class="r"><code>library(ggplot2)
ggplot(DF, aes(x = disease, y = exposure)) + 
  geom_boxplot()</code></pre>
<p><img src="/statsformdl/RmdExample0_files/figure-html/unnamed-chunk-3-1.png" width="80%" /></p>
<pre class="r"><code>lapply(split(DF$exposure, DF$disease),
       function(x) round(summary(x), 3))</code></pre>
<pre><code>## $healthy
##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   0.002   0.167   0.310   0.331   0.440   0.989 
## 
## $diseased
##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   0.001   0.206   0.380   0.399   0.530   0.996</code></pre>
</div>
<div id="regression-analysis" class="section level3">
<h3>Regression analysis</h3>
<p>The result of a logistic regression, adjusted for gender, tells us something
else:</p>
<pre class="r"><code>(res &lt;- summary(glm(disease ~ gender + exposure, family = &#39;binomial&#39;, data = DF)))</code></pre>
<pre><code>## 
## Call:
## glm(formula = disease ~ gender + exposure, family = &quot;binomial&quot;, 
##     data = DF)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.6566  -1.0563   0.7646   1.2528   1.4009  
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)  -0.1303     0.1273  -1.024   0.3058    
## gendermale    1.4454     0.2156   6.702 2.05e-11 ***
## exposure     -0.7648     0.4058  -1.885   0.0595 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 1386.3  on 999  degrees of freedom
## Residual deviance: 1317.0  on 997  degrees of freedom
## AIC: 1323
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<p>The exposure has a negative association with the outcome: the log odds ratio is
-0.765
(odds ratio: 0.465).</p>
<p>How can that be?</p>
<p>Looking at the distribution of the exposure within the diseased and healthy
subjects, we ignored gender. But gender is associated with both the exposure
and the disease status:</p>
<pre class="r"><code>ggplot(DF, aes(x = gender, y = exposure)) +
  geom_boxplot()</code></pre>
<p><img src="/statsformdl/RmdExample0_files/figure-html/unnamed-chunk-5-1.png" width="80%" /></p>
<pre class="r"><code>ggplot(DF, aes(fill = gender, x = disease)) + 
  geom_bar()</code></pre>
<p><img src="/statsformdl/RmdExample0_files/figure-html/unnamed-chunk-5-2.png" width="80%" /></p>
<p>From these plots it becomes clear that men have much higher values of the exposure
than females and that men are more often diseased than females.</p>
</div>
<div id="looking-at-gender-and-disease-at-the-same-time" class="section level3">
<h3>Looking at gender and disease at the same time</h3>
<p>Only when we plot the distribution of the exposure stratified for disease
status AND gender, we see the what the logistic regression has found:</p>
<ul>
<li>males have higher values of the exposure than females</li>
<li>within the males, diseased subjects have lower values of the exposure</li>
<li>within the females diseased subjects have slightly lower values of the exposure</li>
</ul>
<pre class="r"><code>ggplot(DF, aes(x = disease, y = exposure, fill = gender)) + 
  geom_boxplot()</code></pre>
<p><img src="/statsformdl/RmdExample0_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>The positive association between exposure and disease that we saw in the
descriptive statistics (when ignoring gender) is explained by gender.
Because men have higher values of the exposure and are more oftend diseased
it seemed that higher values of the exposure are associated with disease.</p>
<p>Because gender is associated with the exposure and the response it is called
a <em>confounder</em>.</p>
</div>
<div id="a-collapsible-section-with-markdown" class="section level3">
<h3>A collapsible section with markdown</h3>
<details>
<p><summary>Statistical details!</summary></p>
<p><strong>Heading</strong></p>
<ol style="list-style-type: decimal">
<li>A numbered</li>
<li>list
<ul>
<li>With some</li>
<li>Sub bullets</li>
</ul></li>
</ol>
<pre class="r"><code>summary(rnorm(500))</code></pre>
<pre><code>##     Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
## -2.73786 -0.76923 -0.03030 -0.03192  0.69668  3.42544</code></pre>
<p><span class="math display">\[\frac{1}{2}\sum_{i=1}^N \log(x)\]</span></p>
</details>
</div>
<div id="take-away-message" class="section level2">
<h2>Take-away message</h2>
<p><span class="math display">\[\frac{1}{2}\sum_{i=1}^N \log(x)\]</span></p>
<p><span class="math display">\[\frac{1}{2}\sum_{i=1}^N \log(x)\]</span></p>
<p>Associations found in direct comparison of exposure and outcome are biased when
there is one or more confounding factor(s).
Resuls from univariable models or descriptive statistics can be misleading when
there is confounding.</p>
</div>
<div id="what-to-do-in-more-complex-settings" class="section level2">
<h2>What to do in more complex settings?</h2>
<p>When models are adjusted for more than one confounder, and/or confounders are
continuous, stratifying the plot or descriptive statistic for all confounding
variables is often not possible.
The results found in a multivariable regression model can still be visualized,
using the fitted value.</p>
<p>The idea is to predict the outcome for one (or more) patients with specific
values for the confounders. When interest is only in the exposure, all other
variables can be set to the reference category (for categorical variables)
or the median for continuous variables.</p>
<p>This allows to compare two hypothetical subjecs that are identical except in
the value of the variable of interest (usually the exposure).</p>
</div>

<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Bayesian Imputation of Time-varying Covariates in Mixed Models | Bayesian Imputation of Missing Covariates</title>
  <meta name="description" content="Chapter 5 Bayesian Imputation of Time-varying Covariates in Mixed Models | Bayesian Imputation of Missing Covariates" />
  <meta name="generator" content="bookdown 0.13 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Bayesian Imputation of Time-varying Covariates in Mixed Models | Bayesian Imputation of Missing Covariates" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="figures/CoverImage_Erler.jpeg" />
  <meta property="og:description" content="Chapter 5 Bayesian Imputation of Time-varying Covariates in Mixed Models | Bayesian Imputation of Missing Covariates" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Bayesian Imputation of Time-varying Covariates in Mixed Models | Bayesian Imputation of Missing Covariates" />
  
  <meta name="twitter:description" content="Chapter 5 Bayesian Imputation of Time-varying Covariates in Mixed Models | Bayesian Imputation of Missing Covariates" />
  <meta name="twitter:image" content="figures/CoverImage_Erler.jpeg" />

<meta name="author" content="Nicole S. Erler" />


<meta name="date" content="2019-08-21" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="ch-Vincent.html"/>
<link rel="next" href="ch-JSS.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<script src="libs/htmlwidgets-1.3/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.8/datatables.js"></script>
<link href="libs/dt-core-bootstrap-1.10.16/css/dataTables.bootstrap.min.css" rel="stylesheet" />
<link href="libs/dt-core-bootstrap-1.10.16/css/dataTables.bootstrap.extra.css" rel="stylesheet" />
<script src="libs/dt-core-bootstrap-1.10.16/js/jquery.dataTables.min.js"></script>
<script src="libs/dt-core-bootstrap-1.10.16/js/dataTables.bootstrap.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Bayesian imputation of Missing Covariates</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> General Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#mechanisms-and-patterns-of-missing-data"><i class="fa fa-check"></i><b>1.1</b> Mechanisms and Patterns of Missing Data</a><ul>
<li class="chapter" data-level="1.1.1" data-path="index.html"><a href="index.html#missing-data-mechanism"><i class="fa fa-check"></i><b>1.1.1</b> Missing Data Mechanism</a></li>
<li class="chapter" data-level="1.1.2" data-path="index.html"><a href="index.html#missing-data-pattern"><i class="fa fa-check"></i><b>1.1.2</b> Missing Data Pattern</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#multiple-imputed-datasets"><i class="fa fa-check"></i><b>1.2</b> Multiple Imputed Datasets</a><ul>
<li class="chapter" data-level="1.2.1" data-path="index.html"><a href="index.html#methods-for-imputation"><i class="fa fa-check"></i><b>1.2.1</b> Methods for Imputation</a></li>
<li class="chapter" data-level="1.2.2" data-path="index.html"><a href="index.html#pooling-results-from-multiple-imputed-datasets"><i class="fa fa-check"></i><b>1.2.2</b> Pooling Results from Multiple Imputed Datasets</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#the-bayesian-framework"><i class="fa fa-check"></i><b>1.3</b> The Bayesian Framework</a><ul>
<li class="chapter" data-level="1.3.1" data-path="index.html"><a href="index.html#bayes-theorem"><i class="fa fa-check"></i><b>1.3.1</b> Bayes Theorem</a></li>
<li class="chapter" data-level="1.3.2" data-path="index.html"><a href="index.html#monte-carlo-methods"><i class="fa fa-check"></i><b>1.3.2</b> Monte Carlo Methods</a></li>
<li class="chapter" data-level="1.3.3" data-path="index.html"><a href="index.html#markov-chain-monte-carlo"><i class="fa fa-check"></i><b>1.3.3</b> Markov Chain Monte Carlo</a></li>
<li class="chapter" data-level="1.3.4" data-path="index.html"><a href="index.html#gibbs-sampler"><i class="fa fa-check"></i><b>1.3.4</b> Gibbs Sampler</a></li>
<li class="chapter" data-level="1.3.5" data-path="index.html"><a href="index.html#convergence-mixing-and-thinning"><i class="fa fa-check"></i><b>1.3.5</b> Convergence, Mixing and Thinning</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#motivating-datasets"><i class="fa fa-check"></i><b>1.4</b> Motivating Datasets</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#outline-of-this-thesis"><i class="fa fa-check"></i><b>1.5</b> Outline of this Thesis</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="ch-SIM.html"><a href="ch-SIM.html"><i class="fa fa-check"></i><b>2</b> Dealing with Missing Covariates in Epidemiologic Studies</a><ul>
<li class="chapter" data-level="" data-path="ch-SIM.html"><a href="ch-SIM.html#abstract"><i class="fa fa-check"></i>Abstract</a></li>
<li class="chapter" data-level="2.1" data-path="ch-SIM.html"><a href="ch-SIM.html#sec:introSIM"><i class="fa fa-check"></i><b>2.1</b> Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="ch-SIM.html"><a href="ch-SIM.html#sec:SIMData"><i class="fa fa-check"></i><b>2.2</b> Generation R Data</a></li>
<li class="chapter" data-level="2.3" data-path="ch-SIM.html"><a href="ch-SIM.html#sec:MissingData"><i class="fa fa-check"></i><b>2.3</b> Dealing with Missing Data</a><ul>
<li class="chapter" data-level="2.3.1" data-path="ch-SIM.html"><a href="ch-SIM.html#multiple-imputation-using-chained-equations-1"><i class="fa fa-check"></i><b>2.3.1</b> Multiple Imputation using Chained Equations</a></li>
<li class="chapter" data-level="2.3.2" data-path="ch-SIM.html"><a href="ch-SIM.html#fully-bayesian-imputation"><i class="fa fa-check"></i><b>2.3.2</b> Fully Bayesian Imputation</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="ch-SIM.html"><a href="ch-SIM.html#sec:DataAnalysis"><i class="fa fa-check"></i><b>2.4</b> Data Analysis</a><ul>
<li class="chapter" data-level="2.4.1" data-path="ch-SIM.html"><a href="ch-SIM.html#design"><i class="fa fa-check"></i><b>2.4.1</b> Design</a></li>
<li class="chapter" data-level="2.4.2" data-path="ch-SIM.html"><a href="ch-SIM.html#results"><i class="fa fa-check"></i><b>2.4.2</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="ch-SIM.html"><a href="ch-SIM.html#sec:SimulationSIM"><i class="fa fa-check"></i><b>2.5</b> Simulation Study</a><ul>
<li class="chapter" data-level="2.5.1" data-path="ch-SIM.html"><a href="ch-SIM.html#design-1"><i class="fa fa-check"></i><b>2.5.1</b> Design</a></li>
<li class="chapter" data-level="2.5.2" data-path="ch-SIM.html"><a href="ch-SIM.html#results-1"><i class="fa fa-check"></i><b>2.5.2</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="ch-SIM.html"><a href="ch-SIM.html#sec:DiscussionSIM"><i class="fa fa-check"></i><b>2.6</b> Discussion</a></li>
<li class="chapter" data-level="" data-path="ch-SIM.html"><a href="ch-SIM.html#appendix"><i class="fa fa-check"></i>Appendix</a><ul>
<li class="chapter" data-level="" data-path="ch-SIM.html"><a href="ch-SIM.html#a-variable-description"><i class="fa fa-check"></i>2.A Variable Description</a></li>
<li class="chapter" data-level="" data-path="ch-SIM.html"><a href="ch-SIM.html#b-results-from-the-generation-r-data"><i class="fa fa-check"></i>2.B Results from the Generation R Data</a></li>
<li class="chapter" data-level="" data-path="ch-SIM.html"><a href="ch-SIM.html#c-simulation-settings"><i class="fa fa-check"></i>2.C Simulation Settings</a></li>
<li class="chapter" data-level="" data-path="ch-SIM.html"><a href="ch-SIM.html#d-simulation-results"><i class="fa fa-check"></i>2.D Simulation Results</a></li>
<li class="chapter" data-level="" data-path="ch-SIM.html"><a href="ch-SIM.html#e-jags-syntax-for-simulation-scenario-2"><i class="fa fa-check"></i>2.E JAGS Syntax for Simulation Scenario 2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="ch-Myrte.html"><a href="ch-Myrte.html"><i class="fa fa-check"></i><b>3</b> Dietary Patterns and Gestational Weight Gain</a><ul>
<li class="chapter" data-level="" data-path="ch-Myrte.html"><a href="ch-Myrte.html#abstract-1"><i class="fa fa-check"></i>Abstract</a></li>
<li class="chapter" data-level="3.1" data-path="ch-Myrte.html"><a href="ch-Myrte.html#introduction"><i class="fa fa-check"></i><b>3.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2" data-path="ch-Myrte.html"><a href="ch-Myrte.html#experimental-section"><i class="fa fa-check"></i><b>3.2</b> Experimental Section</a><ul>
<li class="chapter" data-level="3.2.1" data-path="ch-Myrte.html"><a href="ch-Myrte.html#study-design"><i class="fa fa-check"></i><b>3.2.1</b> Study Design</a></li>
<li class="chapter" data-level="3.2.2" data-path="ch-Myrte.html"><a href="ch-Myrte.html#population-of-analysis"><i class="fa fa-check"></i><b>3.2.2</b> Population of Analysis</a></li>
<li class="chapter" data-level="3.2.3" data-path="ch-Myrte.html"><a href="ch-Myrte.html#dietary-assessment"><i class="fa fa-check"></i><b>3.2.3</b> Dietary Assessment</a></li>
<li class="chapter" data-level="3.2.4" data-path="ch-Myrte.html"><a href="ch-Myrte.html#maternal-weight-gain"><i class="fa fa-check"></i><b>3.2.4</b> Maternal Weight Gain</a></li>
<li class="chapter" data-level="3.2.5" data-path="ch-Myrte.html"><a href="ch-Myrte.html#covariates"><i class="fa fa-check"></i><b>3.2.5</b> Covariates</a></li>
<li class="chapter" data-level="3.2.6" data-path="ch-Myrte.html"><a href="ch-Myrte.html#statistical-analyses"><i class="fa fa-check"></i><b>3.2.6</b> Statistical Analyses</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="ch-Myrte.html"><a href="ch-Myrte.html#results-2"><i class="fa fa-check"></i><b>3.3</b> Results</a><ul>
<li class="chapter" data-level="3.3.1" data-path="ch-Myrte.html"><a href="ch-Myrte.html#study-population"><i class="fa fa-check"></i><b>3.3.1</b> Study Population</a></li>
<li class="chapter" data-level="3.3.2" data-path="ch-Myrte.html"><a href="ch-Myrte.html#dietary-patterns-and-trajectories-of-gestational-weight"><i class="fa fa-check"></i><b>3.3.2</b> Dietary Patterns and Trajectories of Gestational Weight</a></li>
<li class="chapter" data-level="3.3.3" data-path="ch-Myrte.html"><a href="ch-Myrte.html#dietary-patterns-and-gestational-weight-gain-in-different-phases-in-pregnancy"><i class="fa fa-check"></i><b>3.3.3</b> Dietary Patterns and Gestational Weight Gain in Different Phases in Pregnancy</a></li>
<li class="chapter" data-level="3.3.4" data-path="ch-Myrte.html"><a href="ch-Myrte.html#sensitivity-analyses-1"><i class="fa fa-check"></i><b>3.3.4</b> Sensitivity Analyses</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="ch-Myrte.html"><a href="ch-Myrte.html#discussion"><i class="fa fa-check"></i><b>3.4</b> Discussion</a><ul>
<li class="chapter" data-level="3.4.1" data-path="ch-Myrte.html"><a href="ch-Myrte.html#summary-of-the-main-findings"><i class="fa fa-check"></i><b>3.4.1</b> Summary of the Main Findings</a></li>
<li class="chapter" data-level="3.4.2" data-path="ch-Myrte.html"><a href="ch-Myrte.html#interpretation-and-comparison-with-other-studies"><i class="fa fa-check"></i><b>3.4.2</b> Interpretation and Comparison with other Studies</a></li>
<li class="chapter" data-level="3.4.3" data-path="ch-Myrte.html"><a href="ch-Myrte.html#strengths-and-limitations"><i class="fa fa-check"></i><b>3.4.3</b> Strengths and Limitations</a></li>
<li class="chapter" data-level="3.4.4" data-path="ch-Myrte.html"><a href="ch-Myrte.html#conclusions-and-implications"><i class="fa fa-check"></i><b>3.4.4</b> Conclusions and Implications</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch-Myrte.html"><a href="ch-Myrte.html#appendix-1"><i class="fa fa-check"></i>Appendix</a><ul>
<li class="chapter" data-level="" data-path="ch-Myrte.html"><a href="ch-Myrte.html#a-supplementary-materials"><i class="fa fa-check"></i>3.A Supplementary Materials</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="ch-Vincent.html"><a href="ch-Vincent.html"><i class="fa fa-check"></i><b>4</b> Mothers’ SCB Intake and Body Composition of their Children</a><ul>
<li class="chapter" data-level="" data-path="ch-Vincent.html"><a href="ch-Vincent.html#abstract-2"><i class="fa fa-check"></i>Abstract</a></li>
<li class="chapter" data-level="4.1" data-path="ch-Vincent.html"><a href="ch-Vincent.html#introduction-1"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="ch-Vincent.html"><a href="ch-Vincent.html#methods"><i class="fa fa-check"></i><b>4.2</b> Methods</a><ul>
<li class="chapter" data-level="4.2.1" data-path="ch-Vincent.html"><a href="ch-Vincent.html#study-design-1"><i class="fa fa-check"></i><b>4.2.1</b> Study Design</a></li>
<li class="chapter" data-level="4.2.2" data-path="ch-Vincent.html"><a href="ch-Vincent.html#study-population-1"><i class="fa fa-check"></i><b>4.2.2</b> Study Population</a></li>
<li class="chapter" data-level="4.2.3" data-path="ch-Vincent.html"><a href="ch-Vincent.html#dietary-assessment-of-the-mother"><i class="fa fa-check"></i><b>4.2.3</b> Dietary Assessment of the Mother</a></li>
<li class="chapter" data-level="4.2.4" data-path="ch-Vincent.html"><a href="ch-Vincent.html#child-anthropometric-measures-and-body-composition"><i class="fa fa-check"></i><b>4.2.4</b> Child Anthropometric Measures and Body Composition</a></li>
<li class="chapter" data-level="4.2.5" data-path="ch-Vincent.html"><a href="ch-Vincent.html#covariates-1"><i class="fa fa-check"></i><b>4.2.5</b> Covariates</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="ch-Vincent.html"><a href="ch-Vincent.html#statistical-analyses-1"><i class="fa fa-check"></i><b>4.3</b> Statistical Analyses</a></li>
<li class="chapter" data-level="4.4" data-path="ch-Vincent.html"><a href="ch-Vincent.html#results-3"><i class="fa fa-check"></i><b>4.4</b> Results</a><ul>
<li class="chapter" data-level="4.4.1" data-path="ch-Vincent.html"><a href="ch-Vincent.html#subject-characteristics"><i class="fa fa-check"></i><b>4.4.1</b> Subject Characteristics</a></li>
<li class="chapter" data-level="4.4.2" data-path="ch-Vincent.html"><a href="ch-Vincent.html#maternal-scb-intake-and-child-bmi-trajectory"><i class="fa fa-check"></i><b>4.4.2</b> Maternal SCB Intake and Child BMI Trajectory</a></li>
<li class="chapter" data-level="4.4.3" data-path="ch-Vincent.html"><a href="ch-Vincent.html#maternal-scb-intake-and-child-body-composition"><i class="fa fa-check"></i><b>4.4.3</b> Maternal SCB Intake and Child Body Composition</a></li>
<li class="chapter" data-level="4.4.4" data-path="ch-Vincent.html"><a href="ch-Vincent.html#additional-analyses"><i class="fa fa-check"></i><b>4.4.4</b> Additional Analyses</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="ch-Vincent.html"><a href="ch-Vincent.html#discussion-1"><i class="fa fa-check"></i><b>4.5</b> Discussion</a><ul>
<li class="chapter" data-level="4.5.1" data-path="ch-Vincent.html"><a href="ch-Vincent.html#interpretation-and-comparison-with-previous-studies"><i class="fa fa-check"></i><b>4.5.1</b> Interpretation and Comparison with Previous Studies</a></li>
<li class="chapter" data-level="4.5.2" data-path="ch-Vincent.html"><a href="ch-Vincent.html#potential-mechanisms"><i class="fa fa-check"></i><b>4.5.2</b> Potential Mechanisms</a></li>
<li class="chapter" data-level="4.5.3" data-path="ch-Vincent.html"><a href="ch-Vincent.html#strengths-and-limitations-1"><i class="fa fa-check"></i><b>4.5.3</b> Strengths and Limitations</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch-Vincent.html"><a href="ch-Vincent.html#appendix-2"><i class="fa fa-check"></i>Appendix</a><ul>
<li class="chapter" data-level="" data-path="ch-Vincent.html"><a href="ch-Vincent.html#a-additional-results"><i class="fa fa-check"></i>4.A Additional Results</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="ch-SMMR.html"><a href="ch-SMMR.html"><i class="fa fa-check"></i><b>5</b> Bayesian Imputation of Time-varying Covariates in Mixed Models</a><ul>
<li class="chapter" data-level="" data-path="ch-SMMR.html"><a href="ch-SMMR.html#abstract-3"><i class="fa fa-check"></i>Abstract</a></li>
<li class="chapter" data-level="5.1" data-path="ch-SMMR.html"><a href="ch-SMMR.html#sec:introSMMR"><i class="fa fa-check"></i><b>5.1</b> Introduction</a></li>
<li class="chapter" data-level="5.2" data-path="ch-SMMR.html"><a href="ch-SMMR.html#sec:DataSMMR"><i class="fa fa-check"></i><b>5.2</b> Generation R Data</a></li>
<li class="chapter" data-level="5.3" data-path="ch-SMMR.html"><a href="ch-SMMR.html#sec:ModelSMMR"><i class="fa fa-check"></i><b>5.3</b> Modelling Longitudinal Data with Time-varying Covariates</a><ul>
<li class="chapter" data-level="5.3.1" data-path="ch-SMMR.html"><a href="ch-SMMR.html#framework"><i class="fa fa-check"></i><b>5.3.1</b> Framework</a></li>
<li class="chapter" data-level="5.3.2" data-path="ch-SMMR.html"><a href="ch-SMMR.html#sec:funcformSMMR"><i class="fa fa-check"></i><b>5.3.2</b> Functional Forms for Time-varying Covariates</a></li>
<li class="chapter" data-level="5.3.3" data-path="ch-SMMR.html"><a href="ch-SMMR.html#sec:endoexoSMMR"><i class="fa fa-check"></i><b>5.3.3</b> Endo- and Exogeneity</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="ch-SMMR.html"><a href="ch-SMMR.html#sec:modelsSMMR"><i class="fa fa-check"></i><b>5.4</b> Bayesian Analysis with Incomplete Covariates</a><ul>
<li class="chapter" data-level="5.4.1" data-path="ch-SMMR.html"><a href="ch-SMMR.html#sec:seq-approachSMMR"><i class="fa fa-check"></i><b>5.4.1</b> Sequential Approach</a></li>
<li class="chapter" data-level="5.4.2" data-path="ch-SMMR.html"><a href="ch-SMMR.html#sec:mvn-approachSMMR"><i class="fa fa-check"></i><b>5.4.2</b> Multivariate Normal Approach</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="ch-SMMR.html"><a href="ch-SMMR.html#sec:DataAnalysisSMMR"><i class="fa fa-check"></i><b>5.5</b> Analysis of the Generation R Data</a><ul>
<li class="chapter" data-level="5.5.1" data-path="ch-SMMR.html"><a href="ch-SMMR.html#sec:DataAnalysisEx1"><i class="fa fa-check"></i><b>5.5.1</b> Association between Blood Pressure and Gestational Weight</a></li>
<li class="chapter" data-level="5.5.2" data-path="ch-SMMR.html"><a href="ch-SMMR.html#association-between-gestational-weight-gain-and-child-bmi"><i class="fa fa-check"></i><b>5.5.2</b> Association between Gestational Weight Gain and Child BMI</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="ch-SMMR.html"><a href="ch-SMMR.html#sec:simulationSMMR"><i class="fa fa-check"></i><b>5.6</b> Simulation Study</a><ul>
<li class="chapter" data-level="5.6.1" data-path="ch-SMMR.html"><a href="ch-SMMR.html#design-2"><i class="fa fa-check"></i><b>5.6.1</b> Design</a></li>
<li class="chapter" data-level="5.6.2" data-path="ch-SMMR.html"><a href="ch-SMMR.html#analysis-models"><i class="fa fa-check"></i><b>5.6.2</b> Analysis Models</a></li>
<li class="chapter" data-level="5.6.3" data-path="ch-SMMR.html"><a href="ch-SMMR.html#results-4"><i class="fa fa-check"></i><b>5.6.3</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="ch-SMMR.html"><a href="ch-SMMR.html#sec:DiscussionSMMR"><i class="fa fa-check"></i><b>5.7</b> Discussion</a></li>
<li class="chapter" data-level="" data-path="ch-SMMR.html"><a href="ch-SMMR.html#appendix-3"><i class="fa fa-check"></i>Appendix</a><ul>
<li class="chapter" data-level="" data-path="ch-SMMR.html"><a href="ch-SMMR.html#a-details-on-the-implied-exo--or-endogeneity"><i class="fa fa-check"></i>5.A Details on the Implied Exo- or Endogeneity</a></li>
<li class="chapter" data-level="" data-path="ch-SMMR.html"><a href="ch-SMMR.html#b-analysis-of-the-generation-r-data"><i class="fa fa-check"></i>5.B Analysis of the Generation R Data</a></li>
<li class="chapter" data-level="" data-path="ch-SMMR.html"><a href="ch-SMMR.html#c-simulation-study"><i class="fa fa-check"></i>5.C Simulation Study</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="ch-JSS.html"><a href="ch-JSS.html"><i class="fa fa-check"></i><b>6</b> JointAI: Joint Analysis and Imputation of Incomplete Data in R</a><ul>
<li class="chapter" data-level="" data-path="ch-JSS.html"><a href="ch-JSS.html#abstract-4"><i class="fa fa-check"></i>Abstract</a></li>
<li class="chapter" data-level="6.1" data-path="ch-JSS.html"><a href="ch-JSS.html#introduction-2"><i class="fa fa-check"></i><b>6.1</b> Introduction</a></li>
<li class="chapter" data-level="6.2" data-path="ch-JSS.html"><a href="ch-JSS.html#sec:TheoryJSS"><i class="fa fa-check"></i><b>6.2</b> Theoretical Background</a><ul>
<li class="chapter" data-level="6.2.1" data-path="ch-JSS.html"><a href="ch-JSS.html#sec:AnalysisModel"><i class="fa fa-check"></i><b>6.2.1</b> Analysis Model</a></li>
<li class="chapter" data-level="6.2.2" data-path="ch-JSS.html"><a href="ch-JSS.html#imputation-part"><i class="fa fa-check"></i><b>6.2.2</b> Imputation Part</a></li>
<li class="chapter" data-level="6.2.3" data-path="ch-JSS.html"><a href="ch-JSS.html#sec:priors"><i class="fa fa-check"></i><b>6.2.3</b> Prior Distributions</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="ch-JSS.html"><a href="ch-JSS.html#sec:package"><i class="fa fa-check"></i><b>6.3</b> Package Structure</a></li>
<li class="chapter" data-level="6.4" data-path="ch-JSS.html"><a href="ch-JSS.html#sec:ExampleDataJSS"><i class="fa fa-check"></i><b>6.4</b> Example Data</a><ul>
<li class="chapter" data-level="6.4.1" data-path="ch-JSS.html"><a href="ch-JSS.html#the-nhanes-data"><i class="fa fa-check"></i><b>6.4.1</b> The NHANES Data</a></li>
<li class="chapter" data-level="6.4.2" data-path="ch-JSS.html"><a href="ch-JSS.html#the-simlong-data"><i class="fa fa-check"></i><b>6.4.2</b> The simLong Data</a></li>
<li class="chapter" data-level="6.4.3" data-path="ch-JSS.html"><a href="ch-JSS.html#the-lung-data"><i class="fa fa-check"></i><b>6.4.3</b> The lung Data</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="ch-JSS.html"><a href="ch-JSS.html#sec:ModelSpecification"><i class="fa fa-check"></i><b>6.5</b> Model Specification</a><ul>
<li class="chapter" data-level="6.5.1" data-path="ch-JSS.html"><a href="ch-JSS.html#interactions"><i class="fa fa-check"></i><b>6.5.1</b> Interactions</a></li>
<li class="chapter" data-level="6.5.2" data-path="ch-JSS.html"><a href="ch-JSS.html#non-linear-functional-forms"><i class="fa fa-check"></i><b>6.5.2</b> Non-linear Functional Forms</a></li>
<li class="chapter" data-level="6.5.3" data-path="ch-JSS.html"><a href="ch-JSS.html#sec:multilevel"><i class="fa fa-check"></i><b>6.5.3</b> Multi-level Structure and Longitudinal Covariates</a></li>
<li class="chapter" data-level="6.5.4" data-path="ch-JSS.html"><a href="ch-JSS.html#sec:survmod"><i class="fa fa-check"></i><b>6.5.4</b> Survival Models</a></li>
<li class="chapter" data-level="6.5.5" data-path="ch-JSS.html"><a href="ch-JSS.html#sec:methJSS"><i class="fa fa-check"></i><b>6.5.5</b> Imputation / Covariate Model Types</a></li>
<li class="chapter" data-level="6.5.6" data-path="ch-JSS.html"><a href="ch-JSS.html#sec:auxvars"><i class="fa fa-check"></i><b>6.5.6</b> Auxiliary Variables</a></li>
<li class="chapter" data-level="6.5.7" data-path="ch-JSS.html"><a href="ch-JSS.html#reference-values-for-categorical-covariates"><i class="fa fa-check"></i><b>6.5.7</b> Reference Values for Categorical Covariates</a></li>
<li class="chapter" data-level="6.5.8" data-path="ch-JSS.html"><a href="ch-JSS.html#sec:hyperpars"><i class="fa fa-check"></i><b>6.5.8</b> Hyperparameters</a></li>
<li class="chapter" data-level="6.5.9" data-path="ch-JSS.html"><a href="ch-JSS.html#scaling"><i class="fa fa-check"></i><b>6.5.9</b> Scaling</a></li>
<li class="chapter" data-level="6.5.10" data-path="ch-JSS.html"><a href="ch-JSS.html#ridge-regression"><i class="fa fa-check"></i><b>6.5.10</b> Ridge Regression</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="ch-JSS.html"><a href="ch-JSS.html#sec:MCMCSettings"><i class="fa fa-check"></i><b>6.6</b> MCMC Settings</a><ul>
<li class="chapter" data-level="6.6.1" data-path="ch-JSS.html"><a href="ch-JSS.html#number-of-chains-iterations-and-samples"><i class="fa fa-check"></i><b>6.6.1</b> Number of Chains, Iterations and Samples</a></li>
<li class="chapter" data-level="6.6.2" data-path="ch-JSS.html"><a href="ch-JSS.html#parameters-to-follow"><i class="fa fa-check"></i><b>6.6.2</b> Parameters to Follow</a></li>
<li class="chapter" data-level="6.6.3" data-path="ch-JSS.html"><a href="ch-JSS.html#sec:inits"><i class="fa fa-check"></i><b>6.6.3</b> Initial Values</a></li>
<li class="chapter" data-level="6.6.4" data-path="ch-JSS.html"><a href="ch-JSS.html#parallel-sampling"><i class="fa fa-check"></i><b>6.6.4</b> Parallel Sampling</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="ch-JSS.html"><a href="ch-JSS.html#sec:ResultsJSS"><i class="fa fa-check"></i><b>6.7</b> After Fitting</a><ul>
<li class="chapter" data-level="6.7.1" data-path="ch-JSS.html"><a href="ch-JSS.html#visualizing-the-posterior-sample"><i class="fa fa-check"></i><b>6.7.1</b> Visualizing the Posterior Sample</a></li>
<li class="chapter" data-level="6.7.2" data-path="ch-JSS.html"><a href="ch-JSS.html#model-summary"><i class="fa fa-check"></i><b>6.7.2</b> Model Summary</a></li>
<li class="chapter" data-level="6.7.3" data-path="ch-JSS.html"><a href="ch-JSS.html#evaluation-criteria"><i class="fa fa-check"></i><b>6.7.3</b> Evaluation Criteria</a></li>
<li class="chapter" data-level="6.7.4" data-path="ch-JSS.html"><a href="ch-JSS.html#sec:subset"><i class="fa fa-check"></i><b>6.7.4</b> Subset of Output</a></li>
<li class="chapter" data-level="6.7.5" data-path="ch-JSS.html"><a href="ch-JSS.html#predicted-values"><i class="fa fa-check"></i><b>6.7.5</b> Predicted Values</a></li>
<li class="chapter" data-level="6.7.6" data-path="ch-JSS.html"><a href="ch-JSS.html#sec:getMIdat"><i class="fa fa-check"></i><b>6.7.6</b> Export of Imputed Values</a></li>
</ul></li>
<li class="chapter" data-level="6.8" data-path="ch-JSS.html"><a href="ch-JSS.html#assumptions-and-extensions"><i class="fa fa-check"></i><b>6.8</b> Assumptions and Extensions</a></li>
<li class="chapter" data-level="" data-path="ch-JSS.html"><a href="ch-JSS.html#appendix-4"><i class="fa fa-check"></i>Appendix</a><ul>
<li class="chapter" data-level="" data-path="ch-JSS.html"><a href="ch-JSS.html#a-default-hyperparameters"><i class="fa fa-check"></i>6.A Default Hyperparameters</a></li>
<li class="chapter" data-level="" data-path="ch-JSS.html"><a href="ch-JSS.html#b-density-plot-using-ggplot2"><i class="fa fa-check"></i>6.B Density Plot using ggplot2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="ch-discussion.html"><a href="ch-discussion.html"><i class="fa fa-check"></i><b>7</b> General Discussion</a><ul>
<li class="chapter" data-level="7.1" data-path="ch-discussion.html"><a href="ch-discussion.html#summary-of-advantages"><i class="fa fa-check"></i><b>7.1</b> Summary of Advantages</a></li>
<li class="chapter" data-level="7.2" data-path="ch-discussion.html"><a href="ch-discussion.html#assumptions"><i class="fa fa-check"></i><b>7.2</b> Assumptions</a><ul>
<li class="chapter" data-level="7.2.1" data-path="ch-discussion.html"><a href="ch-discussion.html#model-specification"><i class="fa fa-check"></i><b>7.2.1</b> Model Specification</a></li>
<li class="chapter" data-level="7.2.2" data-path="ch-discussion.html"><a href="ch-discussion.html#ignorable-missingness"><i class="fa fa-check"></i><b>7.2.2</b> Ignorable Missingness</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="ch-discussion.html"><a href="ch-discussion.html#directions-for-future-work"><i class="fa fa-check"></i><b>7.3</b> Directions for Future Work</a><ul>
<li class="chapter" data-level="7.3.1" data-path="ch-discussion.html"><a href="ch-discussion.html#implementation-of-flexible-models"><i class="fa fa-check"></i><b>7.3.1</b> Implementation of Flexible Models</a></li>
<li class="chapter" data-level="7.3.2" data-path="ch-discussion.html"><a href="ch-discussion.html#evaluation-of-model-fit"><i class="fa fa-check"></i><b>7.3.2</b> Evaluation of Model Fit</a></li>
<li class="chapter" data-level="7.3.3" data-path="ch-discussion.html"><a href="ch-discussion.html#non-ignorable-missingness"><i class="fa fa-check"></i><b>7.3.3</b> Non-ignorable Missingness</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="ch-discussion.html"><a href="ch-discussion.html#conclusion"><i class="fa fa-check"></i><b>7.4</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="summary-samenvatting-zusammenfassung.html"><a href="summary-samenvatting-zusammenfassung.html"><i class="fa fa-check"></i><b>8</b> Summary / Samenvatting / Zusammenfassung</a><ul>
<li class="chapter" data-level="" data-path="summary-samenvatting-zusammenfassung.html"><a href="summary-samenvatting-zusammenfassung.html#summary"><i class="fa fa-check"></i>Summary</a></li>
<li class="chapter" data-level="" data-path="summary-samenvatting-zusammenfassung.html"><a href="summary-samenvatting-zusammenfassung.html#samenvatting"><i class="fa fa-check"></i>Samenvatting</a></li>
<li class="chapter" data-level="" data-path="summary-samenvatting-zusammenfassung.html"><a href="summary-samenvatting-zusammenfassung.html#zusammenfassung"><i class="fa fa-check"></i>Zusammenfassung</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix-phd-portfolio-curriculum-vitae.html"><a href="appendix-phd-portfolio-curriculum-vitae.html"><i class="fa fa-check"></i>Appendix: PhD Portfolio &amp; Curriculum Vitae</a><ul>
<li class="chapter" data-level="" data-path="appendix-phd-portfolio-curriculum-vitae.html"><a href="appendix-phd-portfolio-curriculum-vitae.html#phd-portfolio"><i class="fa fa-check"></i>PhD Portfolio</a><ul>
<li class="chapter" data-level="" data-path="appendix-phd-portfolio-curriculum-vitae.html"><a href="appendix-phd-portfolio-curriculum-vitae.html#presentations"><i class="fa fa-check"></i>Presentations</a></li>
<li class="chapter" data-level="" data-path="appendix-phd-portfolio-curriculum-vitae.html"><a href="appendix-phd-portfolio-curriculum-vitae.html#teaching"><i class="fa fa-check"></i>Teaching</a></li>
<li class="chapter" data-level="" data-path="appendix-phd-portfolio-curriculum-vitae.html"><a href="appendix-phd-portfolio-curriculum-vitae.html#courses"><i class="fa fa-check"></i>Courses</a></li>
<li class="chapter" data-level="" data-path="appendix-phd-portfolio-curriculum-vitae.html"><a href="appendix-phd-portfolio-curriculum-vitae.html#seminars-and-workshops"><i class="fa fa-check"></i>Seminars and Workshops</a></li>
<li class="chapter" data-level="" data-path="appendix-phd-portfolio-curriculum-vitae.html"><a href="appendix-phd-portfolio-curriculum-vitae.html#consulting"><i class="fa fa-check"></i>Consulting</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix-phd-portfolio-curriculum-vitae.html"><a href="appendix-phd-portfolio-curriculum-vitae.html#curriculum-vitae"><i class="fa fa-check"></i>Curriculum Vitae</a><ul>
<li class="chapter" data-level="" data-path="appendix-phd-portfolio-curriculum-vitae.html"><a href="appendix-phd-portfolio-curriculum-vitae.html#education"><i class="fa fa-check"></i>Education</a></li>
<li class="chapter" data-level="" data-path="appendix-phd-portfolio-curriculum-vitae.html"><a href="appendix-phd-portfolio-curriculum-vitae.html#work-experience"><i class="fa fa-check"></i>Work Experience</a></li>
<li class="chapter" data-level="" data-path="appendix-phd-portfolio-curriculum-vitae.html"><a href="appendix-phd-portfolio-curriculum-vitae.html#awards"><i class="fa fa-check"></i>Awards</a></li>
<li class="chapter" data-level="" data-path="appendix-phd-portfolio-curriculum-vitae.html"><a href="appendix-phd-portfolio-curriculum-vitae.html#collaborations-and-consulting"><i class="fa fa-check"></i>Collaborations and Consulting</a></li>
<li class="chapter" data-level="" data-path="appendix-phd-portfolio-curriculum-vitae.html"><a href="appendix-phd-portfolio-curriculum-vitae.html#publications"><i class="fa fa-check"></i>Publications</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="bibliography.html"><a href="bibliography.html"><i class="fa fa-check"></i>Bibliography</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Bayesian Imputation of Missing Covariates</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ch:SMMR" class="section level1">
<h1><span class="header-section-number">Chapter 5</span> Bayesian Imputation of Time-varying Covariates in Mixed Models</h1>

<hr />
<p>This chapter is based on</p>
<blockquote>
<p>Nicole S. Erler, Dimitris Rizopoulos, Vincent W. V. Jaddoe,
Oscar H. Franco and Emmanuel M. E. H. Lesaffre.
Bayesian imputation of time-varying covariates in linear mixed models.
<em>Statistical Methods in Medical Research</em>, 2019; <strong>28</strong>(2), 555 – 568.
<a href="https://doi.org/10.1177/0962280217730851">doi:10.1177/0962280217730851</a></p>
</blockquote>



<div id="abstract-3" class="section level3 unnumbered">
<h3>Abstract</h3>
<p>Studies involving large observational datasets commonly face the challenge of
dealing with multiple missing values.
The most popular approach to overcome this challenge, multiple imputation
using chained equations, however, has been shown to be sub-optimal in complex
settings, specifically in settings with longitudinal outcomes, which cannot be
easily and adequately included in the imputation models.
Bayesian methods avoid this difficulty by specification of a joint distribution
and thus offer an alternative.
A popular choice for that joint distribution is the multivariate normal distribution.
In more complicated settings, as in our two
motivating examples that involve time-varying covariates, additional issues
require consideration: the endo- or exogeneity of the covariate
and its functional relation with the outcome. In such situations, the implied
assumptions of standard methods may be violated, resulting in bias.
In this work, we extend and study a more flexible, Bayesian, alternative
to the multivariate normal approach, to better handle complex incomplete
longitudinal data.
We discuss and compare assumptions of the two Bayesian approaches about the
endo- or exogeneity of the covariates and the functional form of the association
with the outcome, and illustrate and evaluate consequences of violations of
those assumptions using simulation studies and two real data examples.</p>

</div>
<div id="sec:introSMMR" class="section level2">
<h2><span class="header-section-number">5.1</span> Introduction</h2>
<p>Missing values are a common challenge in the analysis of observational data,
especially in longitudinal studies.</p>
<p>This work is motivated by two research questions from the Generation R
Study <span class="citation">(Kooijman et al. <a href="#ref-GenR2017" role="doc-biblioref">2016</a>)</span>, a large longitudinal cohort study from fetal life onward.
Specifically, the questions are:
1) “How is gestational weight associated with maternal blood pressure during
pregnancy?”, and
2) “How is gestational weight associated with body mass index of the
offspring during the first years of life?”.
Due to the observational nature of the study, there is a considerable amount of
incomplete data, with the particular challenge that missing values do not only
occur in the outcome but also in baseline and time-varying covariates.</p>
<p>There are several well-established approaches to deal with incomplete data,
the most popular being multiple imputation using chained equations (MICE) <span class="citation">(Van Buuren <a href="#ref-Buuren2012" role="doc-biblioref">2012</a>)</span>,
which are readily available in standard statistical software.
MICE has been shown to work well in many standard settings but may not be optimal
in more complex applications, especially with longitudinal or other
multivariate outcomes, which cannot be easily included in the imputation models
for incomplete covariates in an appropriate manner <span class="citation">(Erler et al. <a href="#ref-Erler2016" role="doc-biblioref">2016</a>)</span>.
Fully Bayesian approaches provide a useful alternative in such complex settings,
due to their ability to jointly model multivariate outcomes and incomplete
covariates. The most popular omnibus approach in the Bayesian framework
postulates a full multivariate normal distribution <span class="citation">(Carpenter and Kenward <a href="#ref-Carpenter2013" role="doc-biblioref">2013</a>)</span>.
Although this approach, as well as other approaches, is targeted towards a broad range of
applications, in complex settings such as our two motivating
research questions, the nature of the data requires careful consideration of the
appropriateness of such standard methods and a more dedicated approach
may be necessary.
Especially with time-varying covariates, imputation and analysis
become more demanding and, in order to obtain valid results, require additional
considerations about the association between the time-varying covariates and the
outcome. Specifically, endogenous covariates, i.e., covariates that are influenced
by the outcome, and covariates that have
non-standard functional relations with the outcome, can pose challenges
that may or may not be adequately handled by standard methods, which usually assume
linear associations and implicitly assume exogeneity of the covariates.</p>
<p>In the present paper, we focus on two approaches in the Bayesian framework
to deal with covariates that are missing at random.
The first approach is described by <span class="citation">Carpenter and Kenward (<a href="#ref-Carpenter2013" role="doc-biblioref">2013</a>)</span>.
The basic idea is to assume a (latent) normal distribution for each incomplete variable and to
connect them in such a way that the joint distribution is multivariate normal,
which allows straightforward sampling to impute missing values.
This approach is a common strategy to implement multiple imputation in
longitudinal settings, where it can be used as the data generating step.
The resulting data are then analysed in a second step
with a complete data method, not necessarily Bayesian.
While the multivariate normality assumption creates a convenient
standardized framework, it thereby also implies linear relations
between the variables involved, which may not be the case.</p>
<p>The second approach factorizes the joint distribution of the data into a
sequence of conditional distributions, where the first conditional distribution
can conveniently be chosen to be the analysis model of interest, allowing
simultaneous imputation and analysis within the same procedure.
This approach has been described previously for time-constant covariates
<span class="citation">(Erler et al. <a href="#ref-Erler2016" role="doc-biblioref">2016</a>)</span> and we will extend it in the present paper to handle exogenous
as well as endogenous time-varying covariates. The specification of
separate models for each incomplete covariate requires somewhat more consideration
than the specification of a multivariate normal distribution but makes this
approach more flexible as well as capable of handling non-linear relationships.
We will elucidate the capabilities and limitations
of the two approaches with regards to different functional
forms for, as well as endo- or exogeneity of, time-varying covariates
and demonstrate how the use of an ‘off the shelf’
approach may be problematic in settings that require a more tailored approach.</p>
<p>The remainder of this chapter is structured as follows.
We start with introducing the motivating dataset and describe in more detail
the two research questions from the Generation R Study.
In Section <a href="ch-SMMR.html#sec:ModelSMMR">5.3</a> we specify the linear mixed model for
time-varying covariates and
explore different functional forms as well as the issue of endo- and exogeneity.
The two methods of interest are introduced in Section <a href="ch-SMMR.html#sec:modelsSMMR">5.4</a>,
where we will also discuss their implied assumptions about endo- or exogeneity
of the covariates and their ability to handle different functional forms.
We return to the Generation R data in Section <a href="ch-SMMR.html#sec:DataAnalysisSMMR">5.5</a>, where we demonstrate how the
two methods under investigation can be applied. A more formal evaluation of the
methods follows in Section <a href="ch-SMMR.html#sec:simulationSMMR">5.6</a> where we perform a simulation study.
Section <a href="ch-SMMR.html#sec:DiscussionSMMR">5.7</a> concludes this paper with a discussion.</p>
</div>
<div id="sec:DataSMMR" class="section level2">
<h2><span class="header-section-number">5.2</span> Generation R Data</h2>
<p>The Generation R Study is a population-based prospective cohort study from
early fetal life onward, conducted in Rotterdam, the Netherlands <span class="citation">(Kooijman et al. <a href="#ref-GenR2017" role="doc-biblioref">2016</a>)</span>.
An important field of research within the Generation R Study is the exploration
of how the mother’s condition during pregnancy may affect her own health and
that of her child.
Especially weight gain during gestation is of interest as it is closely related
to the development of the fetus, as well as to pregnancy comorbidities, such as
gestational hypertension, that may adversely affect both mother and child
(e.g., <span class="citation">Tielemans et al. (<a href="#ref-Tielemans2015" role="doc-biblioref">2015</a>)</span>).
Children’s growth and body composition, as for instance measured by BMI, is an
important determinant of health throughout childhood and later life.
Therefore, current research is concerned with the two questions
stated in Section <a href="ch-SMMR.html#sec:introSMMR">5.1</a>, i.e., the associations between maternal
weight (gain) during pregnancy with maternal blood pressure during pregnancy as
well as with child BMI after birth.</p>
<p>To investigate these two research questions, a subset of variables was
extracted from the Generation R Study. The dataset contains information on
7643 mothers who had singleton, live births no earlier than
37 weeks of gestation, and their children. Each woman was asked for her
pre-pregnancy weight (baseline) and to visit the research centre once in each
trimester, during which the weight (<code>gw</code>) was measured and the blood pressure
taken.
Since women were eligible to enter the study at any gestational age, prenatal
measurements for the first and second trimester are missing for women
who enrolled later in pregnancy. Furthermore, there is some intermittent missingness
in the gestational and blood pressure data.
There were 3515 women for whom all four weight measurements were
recorded, 3094 for whom three weight measurements were observed,
859 women had two measurements, and 175 women had
only one measurement of weight.
The gestational age at each measurement (<code>gage</code>) was recorded and the time point
of the baseline measurement was set to be zero for all women.
Systolic blood pressure (<code>bp</code>) was measured three times in 4755
women, 2403 women had only two measurements of blood pressure and
477 women just one measurement. For 8 women no
blood pressures were recorded.
Child BMI was measured up to 12 times
between the ages of
2 weeks and
5 years, with a median of
7 observations per child;
1848 children had no BMI measurements.
The child’s age in months (<code>age</code>) was recorded at each BMI measurement and age
and sex adjusted standard deviation scores were calculated (<code>bmi</code>).
A graphical summary of the missingness pattern of the gestational weight and
systolic blood pressure measurements, and the available child BMI measurements
is given in Figures <a href="ch-SMMR.html#fig:MDpatGW">5.4</a> – <a href="ch-SMMR.html#fig:MDpatBMI">5.6</a> in
<a href="ch-SMMR.html#b-analysis-of-the-generation-r-data">Appendix 5.B</a>.</p>
<div class="figure" style="text-align: center"><span id="fig:trajectoriesSMMR"></span>
<img src="Dissertation_files/figure-html/trajectoriesSMMR-1.png" alt="Trajectories of maternal weight, maternal systolic blood pressure
           and child BMI for a random sample of mothers and children from the
           Generation R data." width="100%"  />
<p class="caption">
Figure 5.1: Trajectories of maternal weight, maternal systolic blood pressure
and child BMI for a random sample of mothers and children from the
Generation R data.
</p>
</div>
<p>The trajectories of <code>gw</code>, <code>bp</code> and <code>bmi</code> of a random subset of individuals are
visualized in Figure <a href="ch-SMMR.html#fig:trajectoriesSMMR">5.1</a>.
Furthermore, we considered a number of potential confounders:
maternal age at intake (<code>agem</code>, continuous, complete),
maternal height (<code>height</code>, continuous,
0.38% missing values),
parity (<code>parity</code>, binary: nulliparous vs multiparous,
1.27% missing values),
maternal ethnicity (<code>ethn</code>, binary: European vs other,
5.59% missing values),
maternal education (<code>educ</code>, three ordered categories,
9.29% missing values)
and
maternal smoking habit during pregnancy (<code>smoke</code>, three ordered categories,
12.17% missing values).
Maternal BMI (<code>bmim</code>) was calculated as gestational weight (kg),
measured at time zero, divided by squared height (in m).</p>
<p>Logistic regression of the complete cases showed that
missingness in the baseline covariates (except for parity) was
associated with some or all of the other baseline covariates.
This indicates that missing values are not completely at random.
However, since this study was conducted in the general population subjects are
relatively healthy and the practical settings are such that it is reasonable
to believe that missing values in the clinical measurements, as for instance
<code>gw</code> or <code>bmi</code>, are at random, given the other variables.
It could be argued that missing values in the lifestyle variables,
especially in <code>smoke</code>, are not missing at random because mothers who are smoking
might be more inclined not to report it. If this was the case, the
mechanism that led to the missing values had to be included in the imputation
procedure since otherwise results would be biased. However, the assumption of
randomly missing data is untestable, and the missing data mechanism is usually
unknown, necessitating extensive sensitivity analysis.
As this exceeds the purpose of this study, we will
focus here on randomly missing data.
To make the assumption of randomly missing data more plausible, a number
of covariates will be considered in the analysis model, since omission of
relevant predictor variables may be another reason of not randomly missing data.</p>
</div>
<div id="sec:ModelSMMR" class="section level2">
<h2><span class="header-section-number">5.3</span> Modelling Longitudinal Data with Time-varying Covariates</h2>
<div id="framework" class="section level3">
<h3><span class="header-section-number">5.3.1</span> Framework</h3>
<p>A standard modelling framework for studying the relation between a longitudinal
outcome and predictor variables is mixed effects modelling.
As in our motivating case studies, often some of these predictors are
time-varying.
To facilitate exposition and also for notational simplicity in the following we
only consider a single time-varying covariate. In particular, for a continuous
longitudinal outcome we postulate the following mixed model
<span class="math display">\[
y_i(t) = \mathbf x_i(t)^\top\boldsymbol\beta + f(H^s_i(t), t)^\top \boldsymbol\gamma
         + \mathbf z_i(t)^\top\mathbf b_i
         + \varepsilon_i(t),
\]</span>
where <span class="math inline">\(y_i(t)\)</span> is the observation of individual <span class="math inline">\(i\)</span> measured at time <span class="math inline">\(t\)</span>,
<span class="math inline">\(\boldsymbol\beta\)</span> denotes the vector of regression coefficients of the design
matrix of the fixed effects <span class="math inline">\(\mathbf X_i\)</span>, with <span class="math inline">\(\mathbf x_{i}(t)\)</span> being a column
vector containing a row of that matrix,
<span class="math inline">\(\mathbf z_i(t)\)</span>, a column vector expressing a row of the design matrix
<span class="math inline">\(\mathbf Z_i\)</span> of the random effects <span class="math inline">\(\mathbf b_i\sim N(\mathbf 0, \mathbf D)\)</span>,
<span class="math inline">\(\boldsymbol\gamma\)</span> is a vector
of regression coefficients related to the time-varying covariate <span class="math inline">\(\mathbf s_i\)</span>,
and <span class="math inline">\(\varepsilon_i(t)\sim N(0, \sigma_y^2)\)</span> is an error term.
Except for time itself, <span class="math inline">\(\mathbf X\)</span> does not contain any time-varying covariates.
To include <span class="math inline">\(\mathbf s\)</span> in the linear predictor of <span class="math inline">\(\mathbf y\)</span> assumptions about
the relation between the two variables have to be made. These assumptions can
be expressed by specifying a function <span class="math inline">\(f(H_i^s(t), t)\)</span> which links
the history of the time-varying predictor up to time <span class="math inline">\(t\)</span>,
<span class="math inline">\(H_i^s(t) = \left\{s_i(t_{ij}): 0\leq t_{ij}\leq t, \; j=1,\ldots,n_i^s\right\}\)</span>,
to the outcome, where <span class="math inline">\(t_{ij}\)</span> is the time of the <span class="math inline">\(j\)</span>-th measurement of
individual <span class="math inline">\(i\)</span> and <span class="math inline">\(n_i^s\)</span> is the number of measurements of <span class="math inline">\(\mathbf s\)</span> for
that individual.</p>
</div>
<div id="sec:funcformSMMR" class="section level3">
<h3><span class="header-section-number">5.3.2</span> Functional Forms for Time-varying Covariates</h3>
<p>The choice of an appropriate functional form implies that the following two
questions need to be addressed. Namely, how are <span class="math inline">\(\mathbf s_i\)</span> and <span class="math inline">\(\mathbf y_i\)</span>
related with regards to their time scales, and which features of <span class="math inline">\(\mathbf s_i\)</span>
are of interest in the relation with <span class="math inline">\(\mathbf y_i\)</span>?
The first question asks whether <span class="math inline">\(\mathbf y_i\)</span> and <span class="math inline">\(\mathbf s_i\)</span> have been measured
in the same time intervals and whether their time scales have the same origin
and unit. To allow for settings where <span class="math inline">\(\mathbf y_i\)</span> and <span class="math inline">\(\mathbf s_i\)</span> have been
measured on different time scales, for instance maternal weight during
pregnancy and child BMI after birth, we use <span class="math inline">\(t\)</span> to denote the time scale of
<span class="math inline">\(\mathbf y_i\)</span> and <span class="math inline">\(\tilde t\)</span> to denote the time scale of <span class="math inline">\(\mathbf s_i\)</span>.
The second question relates to the specific application and is reflected in the
choice of <span class="math inline">\(f(\cdot)\)</span>.
Choices, that represent relevant features of gestational weight in our two
motivating research questions are
<span class="math display" id="eq:ffdiff" id="eq:ffvalue">\[\begin{eqnarray}
f(H_i^s(t), t) &amp;=&amp; s_i(t), \tag{5.1}\\
f(H_i^s(t), t) &amp;=&amp; \left\{\Delta_1(\mathbf s_i),
                                     \Delta_2(\mathbf s_i),
                                     \Delta_3(\mathbf s_i)\right\}^\top, \tag{5.2}
\end{eqnarray}\]</span></p>
<p>with
<span class="math display">\[\begin{eqnarray*}
\Delta_1(\mathbf s_i) &amp;=&amp; s_i(\tilde t_1) - s_i(\tilde t_0),\\
\Delta_2(\mathbf s_i) &amp;=&amp; s_i(\tilde t_2) - s_i(\tilde t_1),\\
\Delta_3(\mathbf s_i) &amp;=&amp; s_i(\tilde t_3) - s_i(\tilde t_2),
\end{eqnarray*}\]</span>
where <a href="ch-SMMR.html#eq:ffvalue">(5.1)</a> represents the commonly chosen linear relation
between the value of <span class="math inline">\(\mathbf s_i\)</span>, e.g., maternal weight, and <span class="math inline">\(\mathbf y_i\)</span>,
e.g., blood pressure, measured at the same time points (i.e., <span class="math inline">\(t = \tilde t\)</span>).
Function <a href="ch-SMMR.html#eq:ffdiff">(5.2)</a> represents trimester specific weight gain, i.e.,
the difference of maternal weight over three given time intervals.
In a more general notation, <a href="ch-SMMR.html#eq:ffvalue">(5.1)</a> could be written as
<span class="math inline">\(f(H_i^s(t), t) = s_i(g(t))\)</span> and refer to the value of
<span class="math inline">\(\mathbf s_i\)</span> at a time point that is specified by a function <span class="math inline">\(g(t)\)</span>,
and <a href="ch-SMMR.html#eq:ffdiff">(5.2)</a> could be written as
<span class="math inline">\(f(H_i^s(t), t) = s_i(g_2(t)) - s_i(g_1(t))\)</span>,
where the time intervals are specified by the functions <span class="math inline">\(g_1(t)\)</span> and
<span class="math inline">\(g_2(t)\)</span> and may not be the same for all <span class="math inline">\(t\)</span>.</p>
<p>In other applications, it is likely that different functional forms will be more
appropriate. Such functions may, for instance, represent cumulative effects or
use estimates of random effects associated with the individual profiles of the
time-varying covariate.
In cases where there is not a specific functional form of interest or there is
uncertainty about which functional form is most appropriate, multiple functional
forms can be included and shrinkage priors used to reduce correlations between
parameters or to select the best suited functional form <span class="citation">(Andrinopoulou and Rizopoulos <a href="#ref-Andrinopoulou2016" role="doc-biblioref">2016</a>)</span>.</p>
</div>
<div id="sec:endoexoSMMR" class="section level3">
<h3><span class="header-section-number">5.3.3</span> Endo- and Exogeneity</h3>
<p>Another characteristic of the relation between a time-varying covariate and
the outcome that needs to be considered is whether the time-varying covariate
is exogenous or endogenous.
Formally, exogeneity is defined by the following two conditions
<span class="citation">(Engle, Hendry, and Richard <a href="#ref-Engle1983" role="doc-biblioref">1983</a>; Diggle et al. <a href="#ref-Diggle2002" role="doc-biblioref">2002</a>)</span>
<span class="math display">\[
\left\{\begin{array}{l}
\begin{align*}
p(y_i(t), f(H^s_i(t), t) \mid H^y_i(t^-), H^s_i(t^-), \boldsymbol\theta) 
= &amp; p(y_i(t) \mid f(H^s_i(t), t), H^y_i(t^-), H^s_i(t^-), \boldsymbol\theta_1) \times\\
         &amp; p(s_i(t) \mid H^y_i(t^-), H^s_i(t^-), \boldsymbol\theta_2)\\[2ex]
p(s_i(t) \mid H^s_i(t^-), H^y_i(t^-), \mathbf x_i, \boldsymbol\theta)
         =  &amp; p(s_i(t) \mid H^s_i(t^-), \mathbf x_i, \boldsymbol\theta)
\end{align*}
\end{array}
\right.
\]</span>
where <span class="math inline">\(\boldsymbol\theta\)</span> is a vector of parameters and other unknown quantities,
with <span class="math inline">\(\boldsymbol \theta^\top = (\boldsymbol\theta_1^\top, \boldsymbol \theta_2^\top)\)</span>
and <span class="math inline">\(\boldsymbol\theta_1 \perp\!\!\!\perp \boldsymbol\theta_2\)</span>,
and where <span class="math inline">\(H^y_i(t^-)\)</span> and <span class="math inline">\(H^s_i(t^-)\)</span> denote the history of <span class="math inline">\(\mathbf y\)</span> and
<span class="math inline">\(\mathbf s\)</span>, respectively, up to, but excluding measurements at time <span class="math inline">\(t\)</span>.
By specifying the functional relation between <span class="math inline">\(\mathbf y_i\)</span> and <span class="math inline">\(\mathbf s_i\)</span>
to be a function of the history of <span class="math inline">\(\mathbf s\)</span>, we avoid dependence of <span class="math inline">\(y_i(t)\)</span>
on future values of <span class="math inline">\(\mathbf s_i\)</span>, which is an additional requirement for
exogeneity, see <span class="citation">Diggle et al. (<a href="#ref-Diggle2002" role="doc-biblioref">2002</a>)</span>.
Variables, for which these conditions are not satisfied are called
<em>endogenous</em>.
This may be the case for maternal weight as a predictor variable for blood
pressure. Since both variables are measured in the same individual they may be
subject to the same unmeasured influences or causal pathways may be reversed,
which often entails endogeneity. In the setting where maternal weight is
considered as a predictor of child BMI, however, the assumption of exogeneity
may be more likely, since the covariate is measured earlier than the
outcome and in different subjects.</p>
<p>Most common methods for inference, like generalized linear (mixed) regression
models, assume covariates to be exogenous. If that assumption is wrong and the
covariate is, in fact, endogenous, estimates may be biased <span class="citation">(Diggle et al. <a href="#ref-Diggle2002" role="doc-biblioref">2002</a>; Daniels and Hogan <a href="#ref-Daniels2008" role="doc-biblioref">2008</a>)</span>.</p>
</div>
</div>
<div id="sec:modelsSMMR" class="section level2">
<h2><span class="header-section-number">5.4</span> Bayesian Analysis with Incomplete Covariates</h2>
<p>As introduced in Section <a href="ch-SMMR.html#sec:DataSMMR">5.2</a>, the motivating questions from the
Generation R Study involve outcomes and covariates that are incomplete.
This holds for both the baseline and time-varying covariates. Hence, to
appropriately investigate the associations of interest we need to account for
missingness.
In the Bayesian framework, missing values, whether they are in the outcome or
in covariates, can be imputed in a natural and elegant manner.
A common assumption, which we make here for the outcome as well as
the covariates, is that the missing data mechanism is Missing At Random (MAR),
i.e., the probability of a value being
unobserved may depend on other observed values but not on values that have not
been observed. In addition, the parameters of the analysis model are assumed to
be independent of the missingness process. Under these assumptions, the
missingness process is ignorable and does not need to be modelled <span class="citation">(Little and Rubin <a href="#ref-Little2002" role="doc-biblioref">2002</a>)</span>.
Furthermore, this assumption entails that explicit imputation of the outcome is
not necessary to obtain valid results, and we will, therefore, focus on settings
with incomplete covariates.
In this section, we adapt and implement two popular Bayesian approaches for analysing data
with incomplete covariates, namely, the sequential approach <span class="citation">(Ibrahim, Chen, and Lipsitz <a href="#ref-Ibrahim2002" role="doc-biblioref">2002</a>; Erler et al. <a href="#ref-Erler2016" role="doc-biblioref">2016</a>)</span>,
and the multivariate normal approach <span class="citation">(Carpenter and Kenward <a href="#ref-Carpenter2013" role="doc-biblioref">2013</a>)</span>.
In particular, we extend the first approach
to settings with time-varying covariates that may be exogenous or endogenous.
Both approaches model the joint
distribution of the complete data and draw imputations from the posterior full
conditional distributions that result from it but differ in the way the
joint complete data distribution is specified.
These differences influence how the two approaches can handle different
functional forms as well as exo- versus endogenous covariates.</p>
<p>We start with some additional notation. As in the motivating data, the
time-varying covariate <span class="math inline">\(\mathbf s\)</span> is assumed to be incomplete. Missing values in
<span class="math inline">\(\mathbf s\)</span> occur not only due to missed measurements or drop-out but can also
be caused when the functional form <span class="math inline">\(f(H_i^s(t), t)\)</span> depends on values
of <span class="math inline">\(\mathbf s\)</span> that have not been (scheduled to be) measured. We use
<span class="math inline">\(\mathbf s_i = (\mathbf s_{i, obs}^\top, \mathbf s_{i, mis}^\top)^\top\)</span> to distinguish between
the observed and missing values of <span class="math inline">\(\mathbf s\)</span> for individual <span class="math inline">\(i\)</span>.
Analogously, we assume two parts for the baseline covariates <span class="math inline">\(\mathbf X\)</span> on the
individual level: <span class="math inline">\(\mathbf x_{i,obs}\)</span> and <span class="math inline">\(\mathbf x_{i, mis}\)</span>, which contain the
observed and missing values of <span class="math inline">\(\mathbf x_i\)</span>, respectively.
Furthermore, we use the partition
<span class="math inline">\(\mathbf X = (\mathbf X_c, \mathbf x_1, \ldots, \mathbf x_p)\)</span>, where <span class="math inline">\(\mathbf X_c\)</span>
denotes the subset of covariates that are completely observed for all individuals,
and <span class="math inline">\(\mathbf x_1, \ldots, \mathbf x_p\)</span> are <span class="math inline">\(n\times 1\)</span> vectors of those
covariates that contain missing values.</p>
<div id="sec:seq-approachSMMR" class="section level3">
<h3><span class="header-section-number">5.4.1</span> Sequential Approach</h3>
<p>The sequential approach to impute missing baseline covariates in models with
longitudinal outcomes was previously presented by <span class="citation">Erler et al. (<a href="#ref-Erler2016" role="doc-biblioref">2016</a>)</span> and will be
extended here to incomplete time-varying covariates.</p>
<p>In our setting, the posterior distribution of interest (and associated joint
distribution) is
<span class="math display">\[\begin{eqnarray*}
p(\mathbf s_{mis}, \mathbf X_{mis}, \mathbf b, \boldsymbol\theta
  \mid \mathbf y, \mathbf s_{obs}, \mathbf X_{obs})
&amp;\propto&amp; p(\mathbf y, \mathbf s_{obs}, \mathbf X_{obs}
            \mid \mathbf s_{mis}, \mathbf X_{mis}, \mathbf b, \boldsymbol\theta)\\
&amp;&amp;          p(\mathbf s_{mis}, \mathbf X_{mis}, \mathbf b, \boldsymbol\theta)\\
&amp; = &amp;     p(\mathbf y, \mathbf s_{obs}, \mathbf s_{mis}, \mathbf X_{obs},
            \mathbf X_{mis}, \mathbf b, \boldsymbol\theta),
\end{eqnarray*}\]</span>
where <span class="math inline">\(\boldsymbol\theta\)</span> is a vector of unknown parameters, and can be factorized as
<span class="math display" id="eq:compdistr">\[\begin{equation}
p(\mathbf y \mid \mathbf s, \mathbf X, \mathbf b, \boldsymbol\theta)\;
p(\mathbf s \mid \mathbf X, \mathbf b, \boldsymbol\theta)\;
p(\mathbf X \mid \boldsymbol\theta)\;
p(\mathbf b \mid \boldsymbol\theta)\;
p(\boldsymbol\theta), \tag{5.3}
\end{equation}\]</span>
for which all terms can be specified based on known distributions.</p>
<p>The first term in <a href="ch-SMMR.html#eq:compdistr">(5.3)</a>, i.e.,
<span class="math inline">\(p(\mathbf y \mid \mathbf s, \mathbf X, \mathbf b, \boldsymbol\theta)\)</span>,
is conveniently chosen to be the analysis model of interest,
<span class="math display" id="eq:lmeoutcome">\[\begin{equation}
y_i(t) = \mathbf x_i(t)^\top \boldsymbol\beta_{y\mid s,x}
         + f(H_i^s(t), t)^\top \boldsymbol\gamma
         + \mathbf z_i^y(t)^\top\mathbf b_i^y + \varepsilon_i^y(t), \tag{5.4}
\end{equation}\]</span>
with random effects <span class="math inline">\(\mathbf b_i^y\sim N(0,\mathbf D_y)\)</span> and
<span class="math inline">\(\boldsymbol\varepsilon_i^y(t) \sim N(0, \sigma_y^2)\)</span>,
and the second factor, representing the imputation model for the time-varying
covariate, can be specified analogously as a linear mixed model
<span class="math display" id="eq:imptimevar">\[\begin{equation}
s_i(\tilde t) = \mathbf x_i(\tilde t)^\top \boldsymbol\beta_{s\mid x}
                + \mathbf z_i^s(\tilde t)^\top\mathbf b_i^s + \varepsilon_i^s(\tilde t),
                \tag{5.5}
\end{equation}\]</span>
with <span class="math inline">\(\mathbf b_i^s\sim N(0,\mathbf D_s)\)</span> and
<span class="math inline">\(\boldsymbol\varepsilon_i^s(\tilde t) \sim N(0, \sigma_s^2)\)</span>.
All variance matrices <span class="math inline">\(\mathbf D\)</span> and parameters <span class="math inline">\(\sigma^2\)</span> are assumed
to follow vague inverse-Wishart and inverse-gamma distributions, respectively.
Inclusion of <span class="math inline">\(f(H_i^s(t), t)\)</span> in the linear predictor for
<span class="math inline">\(\mathbf y_i\)</span> allows for a large variety of possibly non-linear relations
between <span class="math inline">\(\mathbf y_i\)</span> and <span class="math inline">\(\mathbf s_i\)</span>, also when they are measured on different
time scales.
The joint distribution of the baseline covariates <span class="math inline">\(\mathbf X\)</span> is often
a multivariate distribution of mixed type variables for which usually no
closed form solution is known. It can, however, be specified as a sequence of
univariate conditional distributions <span class="citation">(Ibrahim, Chen, and Lipsitz <a href="#ref-Ibrahim2002" role="doc-biblioref">2002</a>; Erler et al. <a href="#ref-Erler2016" role="doc-biblioref">2016</a>)</span>,
<span class="math display" id="eq:factorizati\tag{5.6}on}(#eq:factorizationSMMR)
p(\mathbf x_1, \ldots, \mathbf x_p \mid \mathbf X_c, \boldsymbol\theta_x) =
p(\mathbf x_1 \mid \mathbf X_c, \boldsymbol\theta_{x_1})
\prod_{\ell=2}^p p(\mathbf x_\ell \mid \mathbf X_c, \mathbf x_1, \ldots,
                   \mathbf x_{\ell-1}, \boldsymbol\theta_{x_\ell}),
\end{equation}\]</span>
with <span class="math inline">\(\boldsymbol\theta_x^\top = (\boldsymbol\theta_{x_1}^\top, \ldots, \boldsymbol\theta_{x_p}^\top)\)</span>,
where <span class="math inline">\(\mathbf x_\ell\)</span> denotes the <span class="math inline">\(\ell\)</span>-th incomplete covariate.
The univariate conditional distributions are assumed to be members of the exponential family,
extended with distributions for ordinal categorical variables, with linear
predictors
<span class="math display">\[\begin{eqnarray*}
g_\ell\left\{E\left(\mathbf x_\ell \mid \mathbf X_c, \mathbf x_1,
    \ldots, \mathbf x_{\ell-1}, \boldsymbol\theta_{x_\ell}\right)\right\}
&amp;=&amp; \mathbf X_c \boldsymbol\alpha_{\ell}
    + \sum_{q = 1}^{\ell - 1} \mathbf x_q \xi_{\ell_q},
\end{eqnarray*}\]</span>
which allows an easy and flexible specification in settings with many covariates
of mixed type, since each link function <span class="math inline">\(g_\ell\)</span> can be chosen separately and
appropriately for <span class="math inline">\(\mathbf x_\ell\)</span>.
Factorizing the joint distribution of the data as in <a href="ch-SMMR.html#eq:compdistr">(5.3)</a> has
the advantage that the parameters of interest, <span class="math inline">\(\boldsymbol\beta_{y\mid s,x}\)</span>, are
estimated within each iteration of the imputation procedure, conditional on the
current value of the imputed covariates. The simultaneity of
imputation and analysis leads to a posterior distribution of the parameters,
which automatically takes into account
the uncertainty due to the missing values and no subsequent analysis and
pooling, as in the case of multiple imputation approaches, is necessary.
Furthermore, the sequential approach differs from MICE in the
specification of the imputation models. MICE requires the specification of
full conditional distributions, i.e., to include all other covariates as well
as the outcome in the linear predictor of the imputation models, which is not
straightforward when the outcome is longitudinal, and may lead to
imputation models that are not compatible with the analysis
model <span class="citation">(Carpenter and Kenward <a href="#ref-Carpenter2013" role="doc-biblioref">2013</a>; Bartlett et al. <a href="#ref-Bartlett2015" role="doc-biblioref">2015</a>)</span>.</p>
<p>In the specification described above, the sequential approach implies
exogeneity of <span class="math inline">\(\mathbf s_i\)</span> with regards to the conditions given in
Section <a href="ch-SMMR.html#sec:endoexoSMMR">5.3.3</a>, which is demonstrated in
<a href="ch-SMMR.html#a.1-exogeneity-of-the-sequential-approach-with-independent-random-effects">Appendix 5.A.1</a>.
It can be extended to endogenous time-varying covariates by jointly modelling
the random effects from models <a href="ch-SMMR.html#eq:lmeoutcome">(5.4)</a> and <a href="ch-SMMR.html#eq:imptimevar">(5.5)</a>
as
<span class="math display">\[
\left[\begin{array}{c}
      \mathbf b_i^y\\ \mathbf b_i^s
\end{array}\right]
\sim N\left(\mathbf 0,
            \left[\begin{array}{cc} \mathbf D_y &amp; \mathbf D_{ys}\\
                  \mathbf D_{ys} &amp; \mathbf D_s
            \end{array}\right]
      \right),\qquad
\mathbf D_{ys}\neq\mathbf0.
\]</span>
When <span class="math inline">\(\mathbf b_i^y\)</span> and <span class="math inline">\(\mathbf b_i^s\)</span> are correlated, the joint distribution
of the random effects <span class="math inline">\(p(\mathbf b_i^y, \mathbf b_i^s)\)</span> is not equal to the
product of the marginal distributions <span class="math inline">\(p(\mathbf b_i^y)\)</span> and <span class="math inline">\(p(\mathbf b_i^s)\)</span>
any more and the exogeneity conditions are no longer satisfied (for details see
<a href="#a.2-endogeneity-of-the-sequential-approach-with-correlated-random-effects%7D">Appendix 5.A.2</a>).
The sequential approach can be further extended to endogenous baseline covariates
by relaxing the assumption of independence between the residuals of the covariate
and the analysis model, e.g., by assuming a joint distribution of the residuals
and the random effects <span class="math inline">\(\mathbf b_i^y\)</span>.</p>
</div>
<div id="sec:mvn-approachSMMR" class="section level3">
<h3><span class="header-section-number">5.4.2</span> Multivariate Normal Approach</h3>
<p>A popular alternative to handle missing covariates is the multivariate normal approach
described in detail by <span class="citation">Carpenter and Kenward (<a href="#ref-Carpenter2013" role="doc-biblioref">2013</a>)</span>. The idea behind this approach is
to assume (latent) normal distributions for all incomplete variables and the
outcome, and to connect them in such a way that the resulting joint distribution
is multivariate normal, which eases the sampling of imputed values.
Specification of the joint distribution of the data is, hence, not based on a
sequence but on a chosen multivariate distribution of known type. In our setting, the
posterior distribution of interest can be written and factorized as
<span class="math display" id="eq:mvn-posteri\tag{5.7}ay}(#eq:mvn-posterior)
p(\mathbf s_{mis}, \mathbf X_{mis}, \mathbf{\tilde b}, \boldsymbol{\tilde\theta}
  \mid \mathbf y, \mathbf s_{obs}, \mathbf X_{obs})
&amp;\propto&amp; p(\mathbf y, \mathbf s, \mathbf X_{mis}, \mathbf X_{obs},
            \mathbf{\tilde b}, \boldsymbol{\tilde\theta})\nonumber\\
&amp; = &amp; p(\mathbf y, \mathbf s, \mathbf X_c, \mathbf x_1, \ldots, \mathbf x_p,
            \mathbf{\tilde b}, \boldsymbol{\tilde\theta})\nonumber\\
&amp; = &amp;     p(\mathbf y, \mathbf s, \mathbf x_1, \ldots, \mathbf x_p
            \mid \mathbf X_c, \mathbf{\tilde b}, \boldsymbol{\tilde\theta})\nonumber\\
&amp;&amp;          p(\mathbf{\tilde b} \mid \boldsymbol{\tilde\theta}) \;
          p(\boldsymbol{\tilde\theta}),
\end{eqnarray}\]</span>
where the first factor on the right side of <a href="#eq:mvn-posterior">(5.7)</a> is assumed
to be a multivariate normal distribution, <span class="math inline">\(\mathbf{\tilde b}\)</span> are random effects
that are associated with <span class="math inline">\(\mathbf y\)</span> and <span class="math inline">\(\mathbf s\)</span>, and <span class="math inline">\(\boldsymbol{\tilde\theta}\)</span>
is a vector of parameters.
The multivariate normal distribution can be constructed by specifying linear
(mixed) models for the outcome and incomplete covariates, i.e., the
time-varying and incomplete baseline covariates,
<span class="math display">\[\begin{eqnarray*}
y_i(t)  &amp;=&amp; \mathbf x_{i, c}^y(t)^\top \boldsymbol{\tilde \beta}_y
            + \mathbf{\tilde z}_{i}^y(t) \mathbf{\tilde b}_i^{y}
            + \tilde\varepsilon_{i}^{y}(t)\\
s_i(t)  &amp;=&amp; \mathbf x_{i, c}^s(t)^\top \boldsymbol{\tilde \beta}_s
            + \mathbf{\tilde z}_{i}^{s}(t)\mathbf{\tilde b}_i^{s}
            + \tilde\varepsilon_{i}^{s}(t)\\
\hat x_{i,\ell} &amp;=&amp; {\mathbf x_{i,c}^x}^\top \boldsymbol{\tilde\beta}_{x,\ell}
                    + \tilde\varepsilon_{i,\ell}^x,\qquad \ell = 1,\ldots,p,
\end{eqnarray*}\]</span>
where <span class="math inline">\(\mathbf x_{i, c}^y(t)\)</span>, <span class="math inline">\(\mathbf x_{i,c}^s(t)\)</span> and
<span class="math inline">\(\mathbf x_{i, c}^x\)</span> are rows of the matrices <span class="math inline">\(\mathbf X_c^y\)</span>,
<span class="math inline">\(\mathbf X_c^s\)</span> and <span class="math inline">\(\mathbf X_c^x\)</span> which are (possibly different)
subsets of <span class="math inline">\(\mathbf X_c\)</span>, <span class="math inline">\(\hat x_{i,\ell}\)</span> denotes the value from a
(latent) normal distribution that corresponds to the missing value of the
<span class="math inline">\(\ell\)</span>-th incomplete covariate, for individual <span class="math inline">\(i\)</span>,
<span class="math inline">\(\boldsymbol{\tilde\beta}_y\)</span>, <span class="math inline">\(\boldsymbol{\tilde\beta}_s\)</span> and
<span class="math inline">\(\boldsymbol{\tilde\beta}_x = (\boldsymbol{\tilde\beta}_{x_1}^\top, \ldots,  \boldsymbol{\tilde\beta}_{x_{p}}^\top)^\top\)</span>
are regression coefficients,
<span class="math inline">\(\mathbf{\tilde z}_{i}^y(t)\)</span> and <span class="math inline">\(\mathbf{\tilde z}_{i}^s(t)\)</span> are rows of the
design matrices <span class="math inline">\(\mathbf{\widetilde Z}_i^y\)</span> and <span class="math inline">\(\mathbf{\widetilde Z}_i^s\)</span> of the random
effects <span class="math inline">\(\mathbf{\tilde b}_i^y\)</span> and <span class="math inline">\(\mathbf{\tilde b}_i^s\)</span>.
Note that the models specified here are different from the ones in the
sequential approach, since here the predictors only contain the completely observed
covariates <span class="math inline">\(\mathbf X_c\)</span>. The parameters <span class="math inline">\(\boldsymbol{\tilde \beta}\)</span> are not the same
as the parameters <span class="math inline">\(\boldsymbol\beta_{y\mid s,x}\)</span>, used in the sequential approach.
To obtain estimates of <span class="math inline">\(\boldsymbol\beta_{y\mid s, x}\)</span> that take into account the
uncertainty due to the missing values, multiple imputation may be performed.
This involves repeating the imputation a number of times to create multiple
imputed datasets, which can then be analysed with appropriate Bayesian or non-Bayesian methods.
Pooled estimates from frequentist analyses can be calculated using Rubin’s Rules <span class="citation">(Rubin <a href="#ref-Rubin1987" role="doc-biblioref">1987</a>)</span>.
Although imputation with the multivariate normal approach is
valid for endogenous covariates, this may not be the case for many standard analysis
methods that imply exogeneity of the covariates, which may pose an additional challenge.</p>
<p>To produce the multivariate normal distribution, the models specified above are
then connected through their random effects and error terms which are assumed
to have a joint multivariate normal distribution
<span class="math display" id="eq:connecttoMVN">\[\begin{equation}
\left[\begin{array}{c}
\mathbf{\tilde b}_i^{y}\\
\mathbf{\tilde b}_i^{s}\\
\boldsymbol{\tilde\varepsilon}_i^x
\end{array}\right]
 \sim  N\left(\mathbf 0,
              \left[\begin{array}{lll}
                      \mathbf{\widetilde D}_{y}
                    &amp; \mathbf{\widetilde D}_{y,s}
                    &amp; \text{cov}(\mathbf{\tilde b}_i^y, \boldsymbol{\tilde\varepsilon}_i^x)\\
                      \mathbf{\widetilde D}_{y,s}
                    &amp; \mathbf{\widetilde D}_{s}
                    &amp; \text{cov}(\mathbf{\tilde b}_i^s, \boldsymbol{\tilde \varepsilon}_i^x)\\
                      \text{cov}(\mathbf{\tilde b}_i^y, \boldsymbol{\tilde\varepsilon}_i^x)
                    &amp; \text{cov}(\mathbf{\tilde b}_i^s, \boldsymbol{\tilde\varepsilon}_i^x)
                    &amp; \boldsymbol{\widetilde\Sigma}^x
                \end{array}\right]
\right), \tag{5.8}
\end{equation}\]</span>
where <span class="math inline">\(\mathbf{\widetilde D}_y\)</span> and <span class="math inline">\(\mathbf{\widetilde D}_s\)</span> denote the covariance
matrices of the random effects <span class="math inline">\(\mathbf{\tilde b}_i^y\)</span> and <span class="math inline">\(\mathbf{\tilde b}_i^s\)</span>,
respectively, <span class="math inline">\(\mathbf{\widetilde D}_{y,s}\)</span> is a matrix containing parameters that
describe the covariance between the two sets of random effects,
and <span class="math inline">\(\boldsymbol{\widetilde\Sigma}^x\)</span> is the, usually diagonal, covariance matrix of
the error terms
<span class="math inline">\(\boldsymbol{\tilde\varepsilon}_i^x = (\tilde\varepsilon_{i,1}^x, \ldots,  \tilde\varepsilon_{i,p}^x)^\top\)</span>.</p>
<p>The error terms of the two longitudinal variables are assumed to be normally
distributed as well, and may be modelled jointly as
<span class="math display">\[\begin{equation*}
\left[\begin{array}{c}
\boldsymbol{\tilde\varepsilon}_{i}^{y}\\
\boldsymbol{\tilde\varepsilon}_{i}^{s}
\end{array}\right]
\sim N\left(\mathbf 0,
            \left[\begin{array}{ll} \boldsymbol{\widetilde\Sigma}^y &amp;
                                    \boldsymbol{\widetilde\Sigma}^{y,s}\\
                                    \boldsymbol{\widetilde\Sigma}^{y,s} &amp;
                                    \boldsymbol{\widetilde\Sigma}^{s}
                  \end{array}
            \right]
      \right),
\end{equation*}\]</span>
where
<span class="math inline">\(\boldsymbol{\widetilde\Sigma}^y\)</span> and <span class="math inline">\(\boldsymbol{\widetilde\Sigma}^s\)</span> denote the covariance
matrices of <span class="math inline">\(\boldsymbol{\tilde\varepsilon}_i^y\)</span> and <span class="math inline">\(\boldsymbol{\tilde\varepsilon}_i^s\)</span>,
respectively, and <span class="math inline">\(\boldsymbol{\widetilde\Sigma}^{y,s}\)</span> is a matrix describing the
covariance between the error terms of <span class="math inline">\(\mathbf y_i\)</span> and the error terms of
<span class="math inline">\(\mathbf s_i\)</span>.
Allowing the error terms of the longitudinal variables to be correlated allows
for more flexibility. Which covariance
structure is appropriate, however, depends on the unknown functional
relation between <span class="math inline">\(\mathbf y\)</span> and <span class="math inline">\(\mathbf s\)</span>.</p>
<p>The latent normal model for a binary or ordinal covariate <span class="math inline">\(\mathbf x_{mis_\ell}\)</span>
with <span class="math inline">\(K\)</span> categories can be written as
<span class="math display">\[\begin{align*}
\hat x_{i, mis_\ell} &amp; \leq \kappa_1 &amp; \text{if }  &amp; x_{i, mis_\ell} = 1,\\
\hat x_{i, mis_\ell} &amp; \in (\kappa_{k-1},\kappa_k] &amp; \text{if }
                     &amp; x_{i, mis_\ell} = k,\; k\in(2,\ldots, K-1),\\
\hat x_{i, mis_\ell} &amp; &gt; \kappa_{K-1} &amp;\text{if }  &amp; x_{i, mis_\ell} = k.
\end{align*}\]</span>
To keep the model identified the variance of <span class="math inline">\(\hat x_{i, mis_\ell}\)</span> has to be
fixed, e.g., to one, which complicates sampling of <span class="math inline">\(\boldsymbol{\widetilde\Sigma}^x\)</span>.
For continuous covariates <span class="math inline">\(\hat x_{i, mis_\ell}=x_{i, mis_\ell}\)</span> and no
restriction of the variance is necessary.</p>
<p>As in the sequential approach, the use of variable specific random effects
design matrices <span class="math inline">\(\mathbf{\widetilde Z_i^y}\)</span> and <span class="math inline">\(\mathbf{\widetilde Z}_i^s\)</span> enables this
approach to handle time-varying covariates that are measured on a different time
scale than the outcome. The connection of the imputation models by joint random
effects and/or error terms, however, implies a linear relation between the
variables. When the relation between <span class="math inline">\(\mathbf y_i\)</span> and <span class="math inline">\(\mathbf s_i\)</span> is
non-linear, the true joint distribution is not multivariate normal and does not
generally have a closed form <span class="citation">(Carpenter and Kenward <a href="#ref-Carpenter2013" role="doc-biblioref">2013</a>)</span>. The multivariate normal
approach may, hence, be less suitable for applications with non-linear
relations.</p>
<p>Since <span class="math inline">\(\mathbf b_i^y\)</span> and <span class="math inline">\(\mathbf b_i^s\)</span> are modelled jointly and assumed
to be correlated the conditions for exogeneity are violated, which can be shown
using similar arguments as provided in
<a href="#a.2-endogeneity-of-the-sequential-approach-with-correlated-random-effects%7D">Appendix 5.A.2</a>
for the sequential approach with correlated random effects.
The multivariate normal approach thus implies endogeneity of <span class="math inline">\(\mathbf s_i\)</span>.</p>
</div>
</div>
<div id="sec:DataAnalysisSMMR" class="section level2">
<h2><span class="header-section-number">5.5</span> Analysis of the Generation R Data</h2>
<p>We now return to the Generation R data introduced in Section <a href="ch-SMMR.html#sec:DataSMMR">5.2</a> and
demonstrate how to use the two methods discussed above
to investigate the two motivating research questions.
As indicated earlier, the first question enables the investigation of the impact of
misspecifying the exo-/endogeneity assumption, while the second question
requires the use of a non-standard functional form.</p>
<div id="sec:DataAnalysisEx1" class="section level3">
<h3><span class="header-section-number">5.5.1</span> Association between Blood Pressure and Gestational Weight</h3>
<p>Gestational hypertension is a known risk factor for various health outcomes in
mothers as well as their children. One potentially influential factor for
this condition is gestational weight, which will be investigated here.
Whilst there are several papers exploring the relationship of gestational
weight gain and the development of hypertensive conditions during pregnancy,
the exact nature and functional form of the relation between these variables, has yet to be explored in detail.
Given the information available and the characteristics of the dataset at hand,
a reasonable choice of functional form is to assume a linear relation between
gestational weight (<code>gw</code>) and systolic blood pressure (<code>bp</code>) at the same time
points, i.e., <span class="math inline">\(f(H^\texttt{gw}_i(t), t) = \texttt{gw}_i(t)\)</span>.
Furthermore, the relation between these two variables is likely
influenced by many unmeasured factors, which makes the standard
assumption of exogeneity for gestational weight questionable. To
investigate how much the estimates may be influenced by the assumption of exo-
or endogeneity in practice, we performed the analysis twice, once under the
assumption that gestational weight was endogenous, and once under the common
default assumption of exogeneity, and compared
the results.</p>
<p>Since both longitudinal variables in this application
have non-linear evolutions over time, we modelled their
trajectories using natural cubic splines with two degrees of freedom (df)
for the effect of gestational age, in the formulas below represented by
<span class="math inline">\(\texttt{ns}_i^{(1)}(t)\)</span>, <span class="math inline">\(\texttt{ns}_i^{(2)}(t)\)</span>, and <span class="math inline">\(\widetilde{\texttt{ns}}_i^{(1)}(\tilde t)\)</span>,
<span class="math inline">\(\widetilde{\texttt{ns}}_i^{(2)}(\tilde t)\)</span>, respectively.
Taking into account a number of potential confounding covariates (see
Section <a href="ch-SMMR.html#sec:DataSMMR">5.2</a>), the model of interest in this application can be written as
<span class="math display">\[\begin{eqnarray*}
\texttt{bp}_i(t) &amp; = &amp; (\beta_0 + b_{i0}^\texttt{bp}) + \beta_1\texttt{agem}_i + \beta_2 \texttt{height}_i
               + \beta_3\texttt{parity}_i\\
         &amp;   &amp; + \beta_4\texttt{ethn}_i + \beta_5\texttt{educ}_i^{(2)} + \beta_6 \texttt{educ}_i^{(3)}
               + \beta_7\texttt{smoke}_i^{(2)}\\
         &amp;   &amp; + \beta_8\texttt{smoke}_i^{(3)}
               + (\beta_9 + b_{i1}^\texttt{bp}) \texttt{ns}_i^{(1)}(t)
               + (\beta_{10} + b_{i2}^\texttt{bp})\texttt{ns}_i^{(2)}(t)\\
         &amp;   &amp; + \gamma\texttt{gw}_i(t) + \varepsilon_i^{\texttt{bp}}(t).
\end{eqnarray*}\]</span></p>
<p>In the sequential approach, we used a linear mixed model to impute missing
values of <code>gw</code>, specifically,
<span class="math display">\[\begin{eqnarray*}
\texttt{gw}_i(\tilde t) &amp; = &amp; (\alpha_0 + b_{i0}^\texttt{gw}) + \alpha_1\texttt{agem}_i
                      + \alpha_2 \texttt{height}_i + \alpha_3 \texttt{parity}_i\\
                &amp;   &amp; + \alpha_4\texttt{ethn}_i + \alpha_5\texttt{educ}_i^{(2)}
                      + \alpha_6 \texttt{educ}_i^{(3)} + \alpha_7\texttt{smoke}_i^{(2)}\\
                &amp;   &amp; + \alpha_8\texttt{smoke}_i^{(3)} + (\alpha_9 + b_{i1}^\texttt{gw}) \widetilde{\texttt{ns}}_i^{(1)}(\tilde t)
                      + (\alpha_{10} + b_{i2}^\texttt{gw})\widetilde{\texttt{ns}}_i^{(2)}(\tilde t)\\
                &amp;   &amp; + \varepsilon_i^{\texttt{gw}}(\tilde t),
\end{eqnarray*}\]</span>
and specified the conditional distributions for the missing covariates from
Equation <a href="#eq:factorizationSMMR">(5.6)</a> as linear, logistic and cumulative logistic
regression models.
The random effects of the models for <code>gw</code> and <code>bp</code> were modelled jointly as
<span class="math inline">\((b_{i0}^\texttt{bp}, b_{i1}^\texttt{bp}, b_{i2}^\texttt{bp},b_{i0}^\texttt{gw}, b_{i1}^\texttt{gw}, b_{i2}^\texttt{gw})^\top  \sim N(\mathbf0, \mathbf D)\)</span> in the endogenous setting
and independently as
<span class="math inline">\((b_{i0}^\texttt{bp}, b_{i1}^\texttt{bp}, b_{i2}^\texttt{bp},)^\top \sim N(\mathbf0, \mathbf D_\texttt{bp})\)</span> and
<span class="math inline">\((b_{i0}^\texttt{gw}, b_{i1}^\texttt{gw}, b_{i2}^\texttt{gw})^\top \sim N(\mathbf0, \mathbf D_\texttt{gw})\)</span>
in the exogenous setting.
Vague priors were used for all parameters.
Following the advice of <span class="citation">Garrett and Zeger (<a href="#ref-Garrett2000" role="doc-biblioref">2000</a>)</span>, we assumed independent normal
distributions with mean zero and variance <span class="math inline">\(9/4\)</span> for regression coefficients in
categorical models (logistic and cumulative logistic) since that choice leads
to a prior distribution for the outcome probabilities that is relatively flat
between zero and one.
All continuous covariates were scaled to have mean zero and standard deviation
one, for computational reasons, and the posterior estimates were transformed back to
be interpretable on the original scale of the variables.
The endogenous as well as the exogenous setting was implemented using
R <span class="citation">(R Core Team <a href="#ref-R2016" role="doc-biblioref">2016</a>)</span> and JAGS <span class="citation">(Plummer <a href="#ref-JAGS" role="doc-biblioref">2003</a>)</span>. Convergence of the
posterior chains was checked using the Gelman-Rubin criterion <span class="citation">(Gelman, Meng, and Stern <a href="#ref-Gelman1996" role="doc-biblioref">1996</a>)</span>
The posterior estimates were considered precise enough if
the Monte Carlo error was less than five per cent of the parameter’s standard
deviation <span class="citation">(Lesaffre and Lawson <a href="#ref-Lesaffre2012" role="doc-biblioref">2012</a>)</span>. In the endogenous setting, only 5000 iterations
(in each of three posterior chains) were necessary, while in the exogenous
setting 20000 iterations were required to satisfy this criterion.
Posterior predictive checks were used to evaluate if the assumed model
fitted the data appropriately.</p>
<p>In the multivariate normal approach, the imputation models can be specified as
<span class="math display">\[\begin{eqnarray*}
\texttt{bp}_i(t)  &amp; = &amp; (\tilde\beta_0^\texttt{bp}+ \tilde b_{i0}^\texttt{bp}) + \tilde\beta_1^\texttt{bp}\texttt{agem}_i
                + (\tilde\beta_2^\texttt{bp}+ \tilde b_{i1}^\texttt{bp})\texttt{ns}_i^{(1)}(t)\\
          &amp;   &amp; + (\tilde\beta_3^\texttt{bp}+ \tilde b_{i2}^\texttt{bp})\texttt{ns}_i^{(2)}(t)
                + \tilde\varepsilon_i^\texttt{bp}(t),\\
\texttt{gw}_i(\tilde t)  &amp; = &amp; (\tilde\beta_0^\texttt{gw}+ \tilde b_{i0}^\texttt{gw}) + \tilde\beta_1^\texttt{gw}\texttt{agem}_i
                + (\tilde\beta_2^\texttt{gw}+ \tilde b_{i1}^\texttt{gw})\widetilde{\texttt{ns}}_i^{(1)}(\tilde t)\\
          &amp;   &amp; + (\tilde\beta_3^\texttt{gw}+ \tilde b_{i2}^\texttt{gw})\widetilde{\texttt{ns}}_i^{(2)}(\tilde t)
                + \tilde\varepsilon_i^\texttt{gw}(t),\\
\texttt{height}_i &amp; = &amp; \tilde\beta_0^\texttt{height}+ \tilde\beta_1^\texttt{height}\texttt{agem}_i
                + \tilde\varepsilon_{ij}^\texttt{height},\\
\widehat{\texttt{parity}}_i &amp; = &amp; \tilde\beta_0^\texttt{parity}+ \tilde\beta_1^\texttt{parity}\texttt{agem}_i
                          + \tilde\varepsilon_i^\texttt{parity},\\
\widehat{\texttt{ethn}}_i   &amp; = &amp; \tilde\beta_0^\texttt{ethn}+ \tilde\beta_1^\texttt{ethn}\texttt{agem}_i
                          + \tilde\varepsilon_i^\texttt{ethn},\\
\widehat{\texttt{educ}}_i     &amp; = &amp; \tilde\beta_0^\texttt{educ}+ \tilde\beta_1^\texttt{educ}\texttt{agem}_i
                          + \tilde\varepsilon_i^\texttt{educ},\\
\widehat{\texttt{smoke}}_i  &amp; = &amp; \tilde\beta_0^\texttt{smoke}+ \tilde\beta_1^\texttt{smoke}\texttt{agem}_i
                          + \tilde\varepsilon_i^\texttt{smoke},
\end{eqnarray*}\]</span>
and their random effects and error terms modelled jointly as
<span class="math display">\[
(\tilde b_{i0}^\texttt{bp}, \tilde b_{i1}^\texttt{bp}, \tilde b_{i2}^\texttt{bp},
 \tilde b_{i0}^\texttt{gw}, \tilde b_{i1}^\texttt{gw}, \tilde b_{i2}^\texttt{gw},
 \tilde\varepsilon_i^\texttt{height}, \tilde\varepsilon_i^\texttt{parity},
 \tilde\varepsilon_i^\texttt{ethn}, \tilde\varepsilon_i^\texttt{educ},
 \tilde\varepsilon_i^\texttt{smoke})^\top \sim N(\mathbf0, \mathbf{\widetilde D}),
\]</span>
where the diagonal elements that correspond to <code>parity</code>, <code>ethn</code>, <code>educ</code> and
<code>smoke</code> are fixed to 1, and
<span class="math inline">\(\left\{\tilde{\varepsilon}_i^{\texttt{bp}}(t), \tilde{\varepsilon}_i^{\texttt{gw}}(t)\right\}^\top \sim N(0, \boldsymbol{\widetilde\Sigma}(t)).\)</span></p>
<p>Using current versions of the software packages JAGS or
WinBUGS <span class="citation">(Lunn et al. <a href="#ref-WinBUGS" role="doc-biblioref">2000</a>)</span>
it is not possible to sample from such a restricted covariance matrix and we
will, therefore, only present results from the sequential approach for the
Generation R applications.
These results are presented in Figure <a href="ch-SMMR.html#fig:postEx1">5.2</a>. The solid line
represents the posterior distribution of the regression coefficients obtained
by the sequential approach under the assumption that <code>gw</code> was endogenous, while
the dashed line depicts the corresponding posterior distributions when <code>gw</code> was
assumed to be exogenous. The shaded areas in the tails of the distributions
mark values outside the 95% credible interval (CI).
It can easily be seen that the assumption of exo- or endogeneity had
great impact on the posterior distribution. Especially the posterior
distribution of the effect of the time-varying covariate, <code>gw</code>, differs
substantially between the two models. While in the endogenous model the
posterior mean of this effect was
0.03
with a 95% CI that includes zero
[-0.01, 0.07],
this estimate was
0.30
(95% CI [0.29, 0.32]),
when <code>gw</code> was assumed to be exogenous. Also in other parameters, such as the
regression coefficients for <code>height</code>, <code>educ</code> and the non-linear effect of <code>gage</code>,
the posterior distributions differed considerably.</p>
<div class="figure" style="text-align: center"><span id="fig:postEx1"></span>
<img src="Dissertation_files/figure-html/postEx1-1.png" alt="Posterior distributions of the main regression coefficients in
         the first application, derived by the sequential approach. The solid (dashed) line
         represents the endogenous (exogenous) model.
         The shaded areas mark values outside the 95\% credible interval." width="100%"  />
<p class="caption">
Figure 5.2: Posterior distributions of the main regression coefficients in
the first application, derived by the sequential approach. The solid (dashed) line
represents the endogenous (exogenous) model.
The shaded areas mark values outside the 95% credible interval.
</p>
</div>
<p>A possible explanation for these differences is that in the exogenous model the
correlation between <code>gw</code> and <code>bp</code> is only captured in the parameter <span class="math inline">\(\gamma\)</span>
whereas in the endogenous model it is split between <span class="math inline">\(\gamma\)</span> and the covariance
between the random effects of the model for <code>bp</code> and <code>gw</code>, i.e., the elements in
the upper right quadrant of <span class="math inline">\(\mathbf D\)</span>.
Figure <a href="ch-SMMR.html#fig:BPpostchainDplot">5.7</a> in <a href="ch-SMMR.html#b.3-additional-graphics">Appendix 5.B.3</a> shows the posterior
density of these elements of the matrix <span class="math inline">\(\mathbf D\)</span>. Most of the parameters
describing the covariance between <span class="math inline">\(\mathbf b^\texttt{gw}\)</span> and <span class="math inline">\(\mathbf b^\texttt{bp}\)</span> estimate the
respective covariance to be different from zero. The exogenous model implies
that these parameters are zero and does not estimate them. Interpreting the
results from the endogenous model we may conclude that <code>gw</code> and <code>bp</code> are
correlated, but that there is no evidence that changes in <code>gw</code> cause changes
in <code>bp</code>.</p>
</div>
<div id="association-between-gestational-weight-gain-and-child-bmi" class="section level3">
<h3><span class="header-section-number">5.5.2</span> Association between Gestational Weight Gain and Child BMI</h3>
<p>Fetal development follows a well-researched course which is influenced by
maternal health throughout pregnancy. Specifically, the effect of gestational
weight gain may vary between different periods of pregnancy, i.e., different
periods of fetal development. Hence, the effect of trimester-specific weight
gain is often a predictor of interest.
How much weight gain is considered healthy varies with maternal BMI before pregnancy (<code>bmim</code>)
which, therefore, needs to be considered as predictor variable in this research question.
Since <code>gw</code> is observed entirely prior to the outcome (<code>bmi</code>), it might not
be considered to be a time-varying covariate in the narrow sense, i.e., it
does not change throughout the time range of the outcome measurements. Nevertheless,
it does change over time and an appropriate characterization of this change is
essential to obtaining results that allow meaningful conclusions with
regards to the research question at hand.</p>
<p>We calculated trimester specific weight gain as the differences between weight
before pregnancy, 14 weeks of gestation, 27 weeks of gestation and at
(or rather right before) birth (<code>gestbir</code>), and scaled these differences to reflect weight gain
per week. The functional relation between <code>gw</code> and <code>bmi</code> can thus be
represented as
<span class="math display">\[
f(H_i^\texttt{gw}(t), t) = \left\{\Delta_1(\texttt{gw}_i), \Delta_2(\texttt{gw}_i),
                                    \Delta_3(\texttt{gw}_i)\right\}^\top,
\]</span>
with
<span class="math display">\[\begin{eqnarray*}
\Delta_1(\texttt{gw}_i) &amp;=&amp; \frac{\texttt{gw}_i(\texttt{gage}= 14) - \texttt{gw}_i(\texttt{gage}= 0)}{14},\\
\Delta_2(\texttt{gw}_i) &amp;=&amp; \frac{\texttt{gw}_i(\texttt{gage}= 27) - \texttt{gw}_i(\texttt{gage}= 14)}{27-14},\\
\Delta_3(\texttt{gw}_i) &amp;=&amp; \frac{\texttt{gw}_i(\texttt{gage}= \texttt{gestbir}_i) - \texttt{gw}_i(\texttt{gage}= 27)}
                         {\texttt{gestbir}_i - 27}.
\end{eqnarray*}\]</span></p>
<p>As in the first application, we assumed a non-linear evolution of <code>gw</code> over time,
which was modelled using a natural cubic spline for <code>gage</code> with 2 df.
Also, the trajectories of child BMI, for which age and gender-specific standard
deviation scores (SDS) were used, were non-linear and therefore modelled using a
natural cubic spline with 3 df for <code>age</code>, in the formula below represented by
<span class="math inline">\(\texttt{ns}_i^{(1)}(t)\)</span>, <span class="math inline">\(\texttt{ns}_i^{(2)}(t)\)</span> and <span class="math inline">\(\texttt{ns}_i^{(3)}(t)\)</span>.
Since <code>gw</code> was measured before birth and <code>bmi</code> only after birth, we assumed
that <code>gw</code> was exogenous in this application.</p>
<p>The analysis model for this research question can be written as
<span class="math display">\[\begin{eqnarray*}
\texttt{bmi}_i(t) &amp; = &amp; (\beta_0 + b_{i0}^\texttt{bmi}) + \beta_1 \texttt{agem}_i + \beta_2 \texttt{parity}_i
                + \beta_3\texttt{ethn}_i\\
          &amp;   &amp; + \beta_4\texttt{educ}_i^{(2)} + \beta_5\texttt{educ}_i^{(3)} + \beta_6\texttt{smoke}_i^{(2)}\\
          &amp;   &amp; + \beta_7\texttt{smoke}_i^{(3)} + \beta_8\texttt{bmim}_i
                + (\beta_{9} + b_{i1}^\texttt{bmi}) \texttt{ns}_i^{(1)}(t)\\
          &amp;   &amp; + (\beta_{10} + b_{i2}^\texttt{bmi})\texttt{ns}_i^{(2)}(t)
                + (\beta_{11} + b_{i3}^\texttt{bmi})\texttt{ns}_i^{(3)}(t)\\
          &amp;   &amp; + \gamma_1\Delta_1(\texttt{gw}_i) + \gamma_2\Delta_2(\texttt{gw}_i)
                + \gamma_3\Delta_3(\texttt{gw}_i) + \varepsilon_i^\texttt{bmi}(t),
\end{eqnarray*}\]</span>
The analysis was again performed using the sequential approach, where
imputation models for <code>gw</code> and the baseline covariates were specified
analogous to the first application.
To reduce correlation between the elements of <span class="math inline">\(\boldsymbol \gamma\)</span>, an elastic net
shrinkage hyperprior for the variance parameters of <span class="math inline">\(\boldsymbol \gamma\)</span> was used
<span class="citation">(Mallick and Yi <a href="#ref-Mallick2013" role="doc-biblioref">2013</a>)</span>.</p>
<p>Results from the analysis of this second research question are presented in Figure <a href="ch-SMMR.html#fig:resEx2">5.3</a>.
Only the posterior distributions of the parameters relating to <code>bmim</code>
and <code>gw</code> are shown as these are the parameters of interest here.
It can be seen that children of mothers with higher baseline BMI had
higher BMIs as well – an increase of one kg/m<sup>2</sup> resulted on average in a
0.03
SDS higher child BMI (95% CI [0.03, 0.04]).
Higher gestational weight gain during the first trimester
was associated with higher child BMI (0.23
SDS increase per kg weekly weight gain; 95% CI
).
Even though the posterior mean of the effect of weekly gestational weight gain
during the second trimester was slightly higher
(0.26),
due to the increased uncertainty of this estimate
(95% CI [-0.08, 0.65])
there was no evidence of an association with the trajectories of child BMI.
There was also no evidence that weight gain during the last trimester was a
relevant predictor of child BMI
(0.12;
95% CI [-0.09, 0.33]).</p>
<div class="figure" style="text-align: center"><span id="fig:resEx2"></span>
<img src="Dissertation_files/figure-html/resEx2-1.png" alt="Posterior distributions of a selection of regression coefficients from
         the second application, derived by the sequential approach.
         The shaded areas mark values outside the 95\% credible interval." width="100%"  />
<p class="caption">
Figure 5.3: Posterior distributions of a selection of regression coefficients from
the second application, derived by the sequential approach.
The shaded areas mark values outside the 95% credible interval.
</p>
</div>
</div>
</div>
<div id="sec:simulationSMMR" class="section level2">
<h2><span class="header-section-number">5.6</span> Simulation Study</h2>
To evaluate the performance of the two imputation approaches described in
Section <a href="ch-SMMR.html#sec:modelsSMMR">5.4</a> with regards to misspecification of the endo- or
exogeneity of a time-varying covariate and the bias introduced by
misspecification of the functional form in a more controlled setting, we
performed a simulation study in which we compared results from correctly
specified models with those that are misspecified, for data generated in a
range of different scenarios and different missing mechanisms.
Specifically, the key objectives were

<div id="design-2" class="section level3">
<h3><span class="header-section-number">5.6.1</span> Design</h3>
<p>We simulated 200 datasets in each of six scenarios that differed in the
endo-/exogeneity of the covariate, the functional form and the model
(sequential or multivariate normal) that was used.
Common to all scenarios was that 10 repeated measurements of a normally
distributed time-varying covariate and a conditionally normal outcome
variable, with measurements at the same, unbalanced time points, were created.
Under the sequential approach data was generated with a linear or a quadratic
relation between covariate and outcome, where the covariate was either
exogenous or endogenous. For the multivariate normal model (which always
generates data with a linear relation between the outcome and an endogenous
covariate) we considered two scenarios with regards to the correlation of the
error terms, where in one scenario the error terms of outcome and covariate
were independent and in the other correlated.</p>
<p>Missing values were created in the time-varying covariate according to two MAR
mechanisms, in which the probability of the time-varying covariate being missing
either only depended on the outcome at the same time point or on the outcome
at the same time point as well as the covariate at the previous time point.</p>
<p>Details on the exact setup of the simulation study are given in
<a href="ch-SMMR.html#c.1-design">Appendix 5.C.1</a>.</p>
</div>
<div id="analysis-models" class="section level3">
<h3><span class="header-section-number">5.6.2</span> Analysis Models</h3>
<p>Each of the datasets was analysed using both approaches with different
assumptions regarding the endo- or exogeneity of the covariate and the
functional form, before values were deleted, and for both missing mechanisms.</p>
<p>The complete dataset was analysed using function <code>lmer()</code> from the
R-package <strong>lme4</strong> <span class="citation">(R Core Team <a href="#ref-R2016" role="doc-biblioref">2016</a>; Bates et al. <a href="#ref-lme4" role="doc-biblioref">2015</a>)</span> as well as with the sequential
approach.
Missing data was imputed and analysed with the sequential approach, where the
random effects were modelled according to the current assumption of exo- or
endogeneity, and the imputation was repeated twice with the multivariate normal
approach (once using the model with independent error terms and once assuming
correlated error terms). Each time, ten imputed datasets were created by drawing
values from the posterior chains of the incomplete covariate and analysed
analogously to the analysis of the complete data.
When the covariate was assumed exogenous, <code>lmer()</code> was used and the
coefficients from the ten corresponding analyses pooled using Rubin’s Rules <span class="citation">(Rubin <a href="#ref-Rubin1987" role="doc-biblioref">1987</a>)</span>.
When the covariate was assumed to be endogenous, the sequential approach with
correlated random effects was used and the ten sets of posterior MCMC chains
combined to calculate posterior summary measures.</p>
<p>An overview of the assumptions and models used can be found in
Table <a href="ch-SMMR.html#tab:simanalyis">5.2</a> in <a href="ch-SMMR.html#c.2-analysis-models">Appendix 5.C.2</a>.
The specific parameter values that were used are given in
Tables <a href="ch-SMMR.html#tab:paramvalues">5.3</a> and <a href="ch-SMMR.html#tab:mispars">5.4</a> in <a href="ch-SMMR.html#c.3-parameters-values">Appendix 5.C.3</a>.</p>
</div>
<div id="results-4" class="section level3">
<h3><span class="header-section-number">5.6.3</span> Results</h3>
<p>Firstly, we found that the sequential approach provided unbiased estimates when
comparing the results from the analysis of the complete data to the true parameters that
were used to generate the data. Secondly, in all scenarios, results were very similar
for both MAR mechanisms and we will, hence, not distinguish them during the further
description of the results.</p>
<p>Regarding to our first objective, the comparison of the sequential and the
multivariate normal approach when exo- or endogeneity and functional form were specified
correctly, we found that both approaches were unbiased and their 95% credible/confidence intervals
had the desired coverage. However, misspecification
of the error terms in the multivariate normal approach as independent had
the overall largest impact on the results (estimates were on average half the value of
the estimate from the analysis of the complete data and CIs had 0% coverage).
Based on this finding, we excluded the multivariate normal approach with independent error
terms from further comparisons.
Moreover, we saw that misspecification of an endogenous covariate as exogenous resulted
in bias while misspecification of an exogenous covariate as endogenous did not.
This was the case for both approaches, and linear as well as quadratic (only for
the sequential approach) functional form.
With respect to our third objective, the simulation study showed that
imputation with the multivariate normal approach (with correlated error terms)
in a setting where the functional form was correctly assumed to be quadratic during
the subsequent analysis had the second largest impact, with a relative bias of
approximately 0.8, and resulted in CIs with coverage of close to 0%.
The bias that was added due to misspecification of the functional form as
linear during imputation as well as analysis,
as compared to the results from the analysis of the complete data under the same
misspecification, was small and overall comparable between the multivariate normal and
the sequential approach.
These findings were the same irrespective of the exo- or endogeneity of the covariate.
Plots of the results from the simulation study as well as a detailed discussion
of these results can be found in <a href="ch-SMMR.html#c.4-detailed-discussion-of-the-results">Appendix 5.C.4</a>.</p>
<p>In summary, the results of this simulation study
demonstrate the impact that imprudent acceptance of default
assumptions, like exogeneity, linear relations between variables, or (conditioned
on random effects) uncorrelated error terms may have.</p>

</div>
</div>
<div id="sec:DiscussionSMMR" class="section level2">
<h2><span class="header-section-number">5.7</span> Discussion</h2>
<p>Motivated by two research questions from the Generation R study, we investigated two Bayesian approaches
to handle missing covariate data in models with longitudinal outcomes and
time-varying covariates.
Specifically, we compared the multivariate normal approach,
a widely known omnibus approach, to the more custom-designed
sequential approach, which we extended to handle endogenous time-varying covariates.
The focus of this comparison was on the
ability to take into account different functional relations between such
covariates and the outcome, and the suitability
for exogenous as well as endogenous covariates.</p>
<p>The analysis of our real data applications illustrated the necessity for
methods that allow for complex functional relations and endogenous covariates.
Simulation studies confirmed that in our setting, methods that make the
common assumption of exogeneity of a time-varying covariate provide biased estimates.
The assumption of endogeneity during imputation and analysis, however, did
not introduce any bias, which suggests choosing the endogenous specification,
e.g., to model the random effects of the outcome and the time-varying covariate
correlated, as a default.
The simulation study also demonstrated that imputation with the multivariate normal
approach in settings where the implied assumption of linear associations
between variables is violated can be biased.
Furthermore, great care should be taken when assumptions about the
correlation structure of the error terms are made in the multivariate normal
approach, as misspecification may result in large bias. Results indicated that
the sequential approach is more robust with regards to this type of
misspecification, however, future research is required to evaluate this
further. Overall, the sequential approach performed well and proved to be a
suitable method to impute and analyse longitudinal data with possibly
endogenous time-varying covariates.</p>
<p>The ability of the sequential approach to handle various functional forms, and
to provide estimates in settings with endogenous time-varying covariates, can
be seen as its biggest advantages. Moreover, it can handle non-linear
associations of baseline covariates and interaction terms involving incomplete
covariates without the need of approximations like the “just another variable”
approach or passive imputation via transformation <span class="citation">(Bartlett et al. <a href="#ref-Bartlett2015" role="doc-biblioref">2015</a>; Seaman, Bartlett, and White <a href="#ref-Seaman2012" role="doc-biblioref">2012</a>; White, Royston, and Wood <a href="#ref-White2011" role="doc-biblioref">2011</a>)</span>.
Even in settings where there is no single functional form of interest, but
several candidate functions, it may be applied in combination with shrinkage
techniques which may help the decision which functional form is most appropriate.</p>
<p>In the present paper, we focused on a single time-varying covariate and
ignorable missing data mechanisms, however, extensions of the sequential approach
to accommodate more complex settings are possible.
Multiple time-varying covariates can be added to the linear predictor of the
analysis model. Imputation models for the time-varying covariates could either
be specified assuming conditional independence between different time-varying covariates,
i.e., excluding them from each other’s linear predictor, assuming joint multivariate
distributions for their random effects and/or error terms, or by specifying a functional
form of one time-varying covariate to be included in the linear predictor of
another covariate, analogous to the specification of the analysis model described
in Section <a href="ch-SMMR.html#sec:ModelSMMR">5.3</a>. The second option may be a convenient choice
if a linear relation between the time-varying covariates is a reasonable assumption.
When the missing data mechanism is non-ignorable, this can be taken into account
by extending the specification of the joint distribution with terms that either
describe the selection mechanism (i.e., the missingness pattern given the data)
or specify how the distribution of the data depends on the missingness pattern
<span class="citation">(Carpenter and Kenward <a href="#ref-Carpenter2013" role="doc-biblioref">2013</a>; Van Buuren <a href="#ref-Buuren2012" role="doc-biblioref">2012</a>; Daniels and Hogan <a href="#ref-Daniels2008" role="doc-biblioref">2008</a>)</span>.</p>
<p>A reason why the multivariate normal approach may be preferred in
practice, is its availability in software packages, as, for instance, the
R-package <strong>jomo</strong> <span class="citation">(Quartagno and Carpenter <a href="#ref-jomo2016" role="doc-biblioref">2016</a>)</span> or REALCOM-impute
<span class="citation">(Carpenter, Goldstein, and Kenward <a href="#ref-Realcom" role="doc-biblioref">2011</a>)</span>. Those implementations also provide samplers that can handle
restricted covariance matrices.
More tailored approaches, like the sequential approach, usually
need to be implemented by hand, which, however, can be
done in existing Bayesian software packages such as JAGS or
WinBUGS in a straightforward way.
In <a href="ch-SMMR.html#c.5-jags-syntax">Appendix 5.C.5</a> we give example syntax for both
approaches.
This syntax can easily be extended to include complete or incomplete
baseline covariates (see also the Appendix of <span class="citation">Erler et al. (<a href="#ref-Erler2016" role="doc-biblioref">2016</a>)</span>).
Additional example syntax can be provided upon request.</p>
<p>When imputing and analysing complex datasets, researchers need to deliberate
if standard methods that are easy to apply meet the requirements of the
application at hand, specifically if the assumptions of those methods are met.
It is our opinion that too often this is not the case and
standard approaches are applied even when they are not adequate.
Therefore, we plead for the use of methods that are flexible enough to be adapted
to the specific characteristics of a problem. In the context of imputation and
analysis of longitudinal data with possibly endogenous time-varying covariates,
the sequential approach presented here is such an approach.</p>


</div>
<div id="appendix-3" class="section level2 unnumbered">
<h2>Appendix</h2>
<div id="a-details-on-the-implied-exo--or-endogeneity" class="section level3 unnumbered">
<h3>5.A Details on the Implied Exo- or Endogeneity</h3>
<p>In this section, we provide details on the implications that the approaches
introduced in Section <a href="ch-SMMR.html#sec:modelsSMMR">5.4</a> have for the
exo- or endogeneity of the time-varying covariate <span class="math inline">\(\mathbf s\)</span>.
For <span class="math inline">\(\mathbf s\)</span> to be exogenous, the conditions from
Section <a href="ch-SMMR.html#sec:endoexoSMMR">5.3.3</a> need to be fulfilled, i.e.,</p>
<p><span class="math display">\[
\left\{\begin{array}{l}
\begin{align*}
p(y_i(t), f(H^s_i(t), t) \mid H^y_i(t^-), H^s_i(t^-), \boldsymbol\theta) 
= &amp; p(y_i(t) \mid f(H^s_i(t), t), H^y_i(t^-), H^s_i(t^-), \boldsymbol\theta_1) \times\\
         &amp; p(s_i(t) \mid H^y_i(t^-), H^s_i(t^-), \boldsymbol\theta_2)\\[2ex]
p(s_i(t) \mid H^s_i(t^-), H^y_i(t^-), \mathbf x_i, \boldsymbol\theta)
         =  &amp; p(s_i(t) \mid H^s_i(t^-), \mathbf x_i, \boldsymbol\theta)
\end{align*}
\end{array}
\right.
\]</span></p>
<p>with <span class="math inline">\(\boldsymbol\theta^\top = (\boldsymbol\theta_1^\top, \boldsymbol\theta_2^\top)\)</span>
and <span class="math inline">\(\boldsymbol\theta_1 \perp\!\!\!\perp \boldsymbol\theta_2\)</span>,
where <span class="math inline">\(H^y_i(t^-)\)</span> and <span class="math inline">\(H^s_i(t^-)\)</span> denote the history of <span class="math inline">\(\mathbf y\)</span> and
<span class="math inline">\(\mathbf s\)</span>, respectively, up to, but excluding measurements at time <span class="math inline">\(t\)</span>.
To abbreviate the notation, we will drop the index <span class="math inline">\(i\)</span> in the following sections.</p>
<div id="a.1-exogeneity-of-the-sequential-approach-with-independent-random-effects" class="section level4 unnumbered">
<h4>5.A.1 Exogeneity of the Sequential Approach with Independent Random Effects</h4>
<p>As can easily be seen, the first condition is fulfilled in the sequential
approach with independent random effects, since the joint distribution of
<span class="math inline">\(\mathbf y\)</span> and <span class="math inline">\(\mathbf s\)</span> is specified as the product of the conditional and
the marginal distribution and the parameters of these distributions are usually
specified to be a priori independent.</p>
<p>To show that the second condition is fulfilled as well, several steps are
necessary. Under the assumption that <span class="math inline">\(s(t)\)</span> is independent from
<span class="math inline">\(H^s(t^-)\)</span> and <span class="math inline">\(H^y(t)\)</span> given the random effects we can write</p>
<p><span class="math display" id="eq:ExoCond3-1">\[\begin{eqnarray}
p(s(t)\mid H^s(t^-), H^y(t),\mathbf x, \boldsymbol\theta)
&amp;=&amp; \int p(s(t),\mathbf b\mid H^s(t^-), H^y(t),\mathbf x, \boldsymbol\theta) \;
    d\mathbf b\nonumber\\
&amp;=&amp;\int p(s(t) \mid \mathbf b, H^s(t^-), H^y(t),\mathbf x, \boldsymbol\theta)\\
&amp; &amp;\phantom{\int} p(\mathbf b \mid H^s(t^-), H^y(t),\mathbf x, \boldsymbol\theta)\;
    d\mathbf b\nonumber\\
&amp;=&amp; \iint p(s(t) \mid \mathbf b^s,\mathbf x, \boldsymbol\theta)\; \nonumber\\
&amp; &amp; \phantom{\iint} p(\mathbf b^s,\mathbf b^y
                         \mid H^s(t^-), H^y(t),\mathbf x, \boldsymbol\theta)\,
                       d\mathbf b^s \, d\mathbf b^y. \tag{5.9}
\end{eqnarray}\]</span></p>
<p>Using Bayes theorem, the conditional distribution of the random effects can be
rewritten as</p>
<p><span class="math display" id="eq:cond-indep-Bayes">\[\begin{eqnarray}
p(\mathbf b^s, \mathbf b^y \mid H^s(t^-), H^y(t), \mathbf x, \boldsymbol\theta)\nonumber\\
 = \frac{p(\mathbf b^s, \mathbf b^y, H^s(t^-), H^y(t)
              \mid \mathbf x, \boldsymbol\theta)}
           {p(H^s(t^-), H^y(t) \mid \mathbf x, \boldsymbol\theta)}\\
 = \frac{p(H^s(t^-), H^y(t)
              \mid \mathbf b^s, \mathbf b^y, \mathbf x, \boldsymbol\theta)\;
            p(\mathbf b^s, \mathbf b^y \mid \boldsymbol\theta)}
           {p(H^s(t^-), H^y(t) \mid \mathbf x, \boldsymbol\theta)}.\tag{5.10}
\end{eqnarray}\]</span></p>
<p>With prior independence of <span class="math inline">\(\mathbf b^y\)</span> and <span class="math inline">\(\mathbf b^s\)</span>, i.e.,
<span class="math inline">\(p(\mathbf b^s,\mathbf b^y\mid \boldsymbol\theta) = p(\mathbf b^s\mid \boldsymbol\theta)\;  p(\mathbf b^y\mid \boldsymbol\theta)\)</span>,
and assuming conditional independence of
<span class="math inline">\(H^s(t^-)\)</span> and <span class="math inline">\(H^y(t)\)</span> given the random effects, the denominator of
<a href="ch-SMMR.html#eq:cond-indep-Bayes">(5.10)</a> can be split in two factors,
<span class="math display" id="eq:cond-indep-assumption">\[\begin{eqnarray}
      p(H^s(t^-), H^y(t) \mid \mathbf x, \boldsymbol\theta)\!\!\!
&amp;=&amp;\!\!\!\iint\! p(H^s(t^-), H^y(t)
                 \mid \mathbf b^y, \mathbf b^s, \mathbf x, \boldsymbol\theta)\,
               p(\mathbf b^y, \mathbf b^s\mid\boldsymbol\theta) \,
      d\mathbf b^y d\mathbf b^s\nonumber\\
&amp;=&amp;\!\!\! \int p(H^s(t^-) \mid \mathbf b^s, \mathbf x, \boldsymbol\theta)\,
           p(\mathbf b^s\mid\boldsymbol\theta)\, d\mathbf b^s\nonumber\\
&amp;&amp;\!\!\! \int p(H^y(t) \mid \mathbf b^y, \mathbf x, \boldsymbol\theta)\,
           p(\mathbf b^y\mid\boldsymbol\theta) \, d\mathbf b^y\nonumber\\
&amp;=&amp;\!\!\! p(H^s(t^-) \mid \mathbf x, \boldsymbol\theta) \,
      p(H^y(t) \mid \mathbf x, \boldsymbol\theta). \tag{5.11}
\end{eqnarray}\]</span>
Substituting <a href="ch-SMMR.html#eq:cond-indep-Bayes">(5.10)</a> and <a href="ch-SMMR.html#eq:cond-indep-assumption">(5.11)</a>
into <a href="ch-SMMR.html#eq:ExoCond3-1">(5.9)</a>, and recognizing that
<span class="math display">\[
p(s(t) \mid \mathbf b^s,\mathbf x, \boldsymbol\theta)\;
p(H^s(t^-)\mid \mathbf b^s, \mathbf x, \boldsymbol\theta) =
p(H^s(t)\mid \mathbf b^s, \mathbf x, \boldsymbol\theta),
\]</span>
allows us to factorize the integrand from <a href="ch-SMMR.html#eq:ExoCond3-1">(5.9)</a> so that each
factor only depends on either <span class="math inline">\(\mathbf b^y\)</span> or <span class="math inline">\(\mathbf b^s\)</span>.
The two integrals can then be solved separately and
<a href="ch-SMMR.html#eq:ExoCond3-1">(5.9)</a> can be simplified as
<span class="math display">\[\begin{eqnarray*}
      p(s(t)\mid H^s(t^-), H^y(t),\mathbf x, \boldsymbol\theta)
&amp; = &amp; \frac{\int p(H^s(t)\mid \mathbf b^s, \mathbf x, \boldsymbol\theta) \;
                 p(\mathbf b^s \mid \boldsymbol\theta) \; d\mathbf b^s}
           {p(H^s(t^-) \mid \mathbf x, \boldsymbol\theta)}\\
&amp;   &amp;
\frac{\int p(H^y(t) \mid \mathbf b^y, \mathbf x, \boldsymbol\theta) \;
                 p(\mathbf b^y\mid \boldsymbol\theta) \; d\mathbf b^y}
           {p(H^y(t) \mid \mathbf x, \boldsymbol\theta)}\\
&amp; = &amp; \frac{p(H^s(t) \mid \mathbf x, \boldsymbol\theta)}{p(H^s(t^-) \mid \mathbf x, \boldsymbol\theta)}\;
      \frac{p(H^y(t) \mid \mathbf x, \boldsymbol\theta)}{p(H^y(t) \mid \mathbf x, \boldsymbol\theta)}\\
&amp; = &amp; p(s(t)\mid H^s(t^-),\mathbf x, \boldsymbol\theta)\;\frac{p(H^s(t^-) \mid \mathbf x, \boldsymbol\theta)}
                                                        {p(H^s(t^-) \mid \mathbf x, \boldsymbol\theta)}\\
&amp; = &amp; p(s(t)\mid H^s(t^-),\mathbf x, \boldsymbol\theta),
\end{eqnarray*}\]</span>
which shows that for the sequential approach with independent random effects
also the second condition for exogeneity is fulfilled.</p>
</div>
<div id="a.2-endogeneity-of-the-sequential-approach-with-correlated-random-effects" class="section level4 unnumbered">
<h4>5.A.2 Endogeneity of the Sequential Approach with Correlated Random Effects</h4>
<p>Prior independence of the random effects of the models for <span class="math inline">\(\mathbf y\)</span> and
<span class="math inline">\(\mathbf s\)</span> is a crucial assumption for exogeneity.
When <span class="math inline">\(p(\mathbf b^s, \mathbf b^y\mid \boldsymbol\theta) \neq  p(\mathbf b^s \mid \boldsymbol\theta) \; p(\mathbf b^y \mid \boldsymbol\theta)\)</span>,
neither the numerator nor the denominator in <a href="ch-SMMR.html#eq:cond-indep-Bayes">(5.10)</a> can
be factorized into independent factors and <a href="ch-SMMR.html#eq:ExoCond3-1">(5.9)</a> cannot
be simplified as in the case with independent random effects.
Either of the two possible factorizations,
<span class="math display">\[
  p(\mathbf b^s,\mathbf b^y \mid \boldsymbol\theta)
= p(\mathbf b^s \mid \mathbf b^y, \boldsymbol\theta) \; p(\mathbf b^y\mid \boldsymbol\theta)
\quad \text{or} \quad
  p(\mathbf b^s,\mathbf b^y \mid \boldsymbol\theta)
= p(\mathbf b^y \mid \mathbf b^s, \boldsymbol\theta) \; p(\mathbf b^s\mid \boldsymbol\theta),
\]</span>
violate the requirements of exogeneity.</p>
<p>Using the former factorization, <a href="ch-SMMR.html#eq:ExoCond3-1">(5.9)</a> leads to
<span class="math display">\[\begin{eqnarray*}
      p(s(t)\mid H^s(t^-), H^y(t),\mathbf x, \boldsymbol\theta)
&amp; = &amp; \ldots\\
&amp; = &amp; \frac{1}{p(H^s(t^-), H^y(t) \mid \mathbf x, \boldsymbol\theta)}\\
&amp;   &amp; \int \int p(H^s(t) \mid \mathbf b^s, \mathbf x, \boldsymbol\theta) \;
                         p(\mathbf b^s \mid \mathbf b^y, \boldsymbol\theta)\; d\mathbf b^s\\
&amp;   &amp; \phantom{\int} p(H^y(t) \mid \mathbf b^y, \mathbf x, \boldsymbol\theta)\;
                         p(\mathbf b^y \mid \boldsymbol\theta)\; d\mathbf b^y,
\end{eqnarray*}\]</span>
where <span class="math inline">\(\mathbf s\)</span> is conditioned on <span class="math inline">\(\mathbf b^y\)</span> which, since the random effects
depend on all observations of <span class="math inline">\(\mathbf y\)</span>, implies that <span class="math inline">\(\mathbf s\)</span> is not
independent of the history of <span class="math inline">\(\mathbf y\)</span>, thus violating the second condition.</p>
<p>Using the latter factorization leads to
<span class="math display">\[\begin{eqnarray*}
      p(s(t) \mid H^s(t^-), H^y(t), \mathbf x, \boldsymbol\theta)
&amp; = &amp; \ldots\\
&amp; = &amp; \frac{1}{p(H^s(t^-), H^y(t) \mid \mathbf x, \boldsymbol\theta)}\\
&amp;   &amp; \int \int p(H^y(t) \mid \mathbf b^y, \mathbf x, \boldsymbol\theta)\;
                          p(\mathbf b^y\mid \mathbf b^s, \boldsymbol\theta) \;
                          d\mathbf b^y\\
&amp;   &amp; \phantom{\int}  p(H^s(t) \mid \mathbf b^s, \mathbf x, \boldsymbol\theta)\;
           p(\mathbf b^s \mid \boldsymbol\theta)\; d\mathbf b^s,
\end{eqnarray*}\]</span>
where <span class="math inline">\(\mathbf y\)</span> depends on all observed values of <span class="math inline">\(\mathbf s\)</span> via <span class="math inline">\(\mathbf b^s\)</span>,
i.e., also on future values of <span class="math inline">\(\mathbf s\)</span>, which also is at conflict with the
exogeneity assumption. The sequential model with correlated random effects
hence implies that <span class="math inline">\(\mathbf s\)</span> is endogenous.</p>



</div>
</div>
<div id="b-analysis-of-the-generation-r-data" class="section level3 unnumbered">
<h3>5.B Analysis of the Generation R Data</h3>
<div id="b.1-missing-data-patterns" class="section level4 unnumbered">
<h4>5.B.1 Missing Data Patterns</h4>
<div class="figure" style="text-align: center"><span id="fig:MDpatGW"></span>
<img src="Dissertation_files/figure-html/MDpatGW-1.png" alt="Missing data pattern for gestational weight.
Dark color depicts observed values, light color missing values.
The frequency of each missing data pattern is given on the right." width="100%"  />
<p class="caption">
Figure 5.4: Missing data pattern for gestational weight.
Dark color depicts observed values, light color missing values.
The frequency of each missing data pattern is given on the right.
</p>
</div>
<div class="figure" style="text-align: center"><span id="fig:MDpatSBP"></span>
<img src="Dissertation_files/figure-html/MDpatSBP-1.png" alt="Missing data pattern for systolic blood pressure. 
Dark color depicts observed values, light color missing values.
The frequency of each missing data pattern is given on the right." width="100%"  />
<p class="caption">
Figure 5.5: Missing data pattern for systolic blood pressure.
Dark color depicts observed values, light color missing values.
The frequency of each missing data pattern is given on the right.
</p>
</div>
<div class="figure" style="text-align: center"><span id="fig:MDpatBMI"></span>
<img src="Dissertation_files/figure-html/MDpatBMI-1.png" alt="Distribution of the number of repeated BMI measurements per child (top) and number of
observed values of child BMI per age category (bottom)." width="100%"  />
<p class="caption">
Figure 5.6: Distribution of the number of repeated BMI measurements per child (top) and number of
observed values of child BMI per age category (bottom).
</p>
</div>

</div>
<div id="b.2-prior-distributions" class="section level4 unnumbered">
<h4>5.B.2 Prior Distributions</h4>
<p><span class="math display">\[\begin{eqnarray*}
\beta_k, \gamma &amp;\overset{iid}{\sim}&amp; N(0, 1000),\qquad k = 0,\ldots, 10\\
\sigma_\texttt{bp}^2, \sigma_\texttt{gw}^2 &amp;\overset{iid}{\sim} &amp; \text{inv-Gamma}(0.01, 0.01)\\
\alpha_k &amp;\sim&amp; N(0, 1000), \qquad k = 0,\ldots, 10\\
\mathbf D_\texttt{bp}&amp;\sim&amp; \text{inv-Wishart}(R_\texttt{bp}, 3)\\
\mathbf D_\texttt{gw}&amp;\sim&amp; \text{inv-Wishart}(R_\texttt{gw}, 3)\\
(\text{diag}(R_\texttt{bp})^\top, \text{diag}(R_\texttt{gw})^\top) &amp; \overset{iid}{\sim}&amp; \text{Gamma}(1, 0.001)
\end{eqnarray*}\]</span></p>
</div>
<div id="b.3-additional-graphics" class="section level4 unnumbered">
<h4>5.B.3 Additional Graphics</h4>
<div class="figure" style="text-align: center"><span id="fig:BPpostchainDplot"></span>
<img src="Dissertation_files/figure-html/BPpostchainDplot-1.png" alt="Posterior distributions of the covariance between the random effects $b^\bp$ and $b^\gw$ from the
endogenous setting in the first motivating question from the Generation R data presented in Section \ref{sec:DataAnalysisEx1}. The dashed vertical line marks zero, i.e., the implied covariance in the exogenous setting,
the shaded areas mark values outside the 95\% credible interval." width="75%"  />
<p class="caption">
Figure 5.7: Posterior distributions of the covariance between the random effects <span class="math inline">\(b^\texttt{bp}\)</span> and <span class="math inline">\(b^\texttt{gw}\)</span> from the
endogenous setting in the first motivating question from the Generation R data presented in Section . The dashed vertical line marks zero, i.e., the implied covariance in the exogenous setting,
the shaded areas mark values outside the 95% credible interval.
</p>
</div>
</div>
</div>
<div id="c-simulation-study" class="section level3 unnumbered">
<h3>5.C Simulation Study</h3>
<p>To evaluate the performance of the two imputation approaches described in
Section <a href="ch-SMMR.html#sec:modelsSMMR">5.4</a> with regards to
misspecification of the endo- or exogeneity of a time-varying covariate and the
bias introduced by misspecification of the functional form in a more controlled
setting, we performed a simulation study in which we compared results from
correctly specified models with those that are misspecified, for data generated
in a range of different scenarios and different missing mechanisms.</p>
<p>The simulation study was set up to
</p>
<ol style="list-style-type: decimal">
<li>confirm that both approaches provide unbiased estimates when the models
are correctly specified during imputation and analysis,</li>
<li>investigate how misspecification of the endo- or exogeneity influences
the results, and</li>
<li>to explore bias due to misspecification of the functional form,
specifically
<ul>
<li>the bias introduced during imputation due to the implied linearity
assumption of the multivariate normal approach when the true
functional form is non-linear, and</li>
<li>the bias introduced when the imputation model, as well as the
analysis model, are misspecified as linear.</li>
</ul></li>
</ol>
<div id="c.1-design" class="section level4 unnumbered">
<h4>5.C.1 Design</h4>
<p>We simulated 200 datasets in each of six scenarios that differed in the
endo-/exogeneity of the covariate, the functional form and the model
(sequential or multivariate normal) that was used.
Common in all scenarios was that ten repeated measurements of a normally
distributed time-varying covariate and a (conditionally) normal outcome
variable, with measurements at the same, unbalanced time points, were created.
Table <a href="ch-SMMR.html#tab:simscenarios">5.1</a> gives an overview of the different simulation
scenarios. Under the sequential approach data was generated with a linear or a
quadratic relation between covariate and outcome, where the covariate was
either exogenous or endogenous. The multivariate normal model always generates
data with a linear relation between the outcome and an endogenous covariate,
however, there we considered two scenarios with regards to the correlation of
the error terms, where in one scenario the error terms of outcome and covariate
were independent and in the other correlated.</p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:simscenarios">Table 5.1: </span>Overview of data generating models, with their abbreviation written in italic font.
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
linear relation
</th>
<th style="text-align:left;">
quadratic relation
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;background-color: white !important;">
<strong>exogenous</strong>
</td>
<td style="text-align:left;background-color: white !important;">
<strong>sequential approach</strong><br>
<i>seq. (exo., lin.)</i>
</td>
<td style="text-align:left;background-color: white !important;">
<strong>sequential approach</strong><br><i>seq. (exo., qdr.)</i>
</td>
</tr>
<tr>
<td style="text-align:left;vertical-align: top !important;background-color: white !important;" rowspan="2">
<strong>endogenous</strong>
</td>
<td style="text-align:left;background-color: white !important;">
<strong>sequential approach</strong> <br>
<i>seq. (endo., lin.)</i>
</td>
<td style="text-align:left;background-color: white !important;">
<strong>sequential approach</strong> <br><i>seq. (endo., qdr.)</i>
</td>
</tr>
<tr>
<td style="text-align:left;background-color: white !important;">
<strong>multivariate normal approach</strong>
<ul>
<li>
independent error terms <br>
<i> mvn. (indep. err.)</i>
</li>
<li>
correlated error terms <br>
<i> mvn. (corr. err.)</i>
</li>
</ul>
</td>
<td style="text-align:left;background-color: white !important;">
</td>
</tr>
</tbody>
</table>
<!-- \begin{table}[!ht] -->
<!-- \caption{Overview of data generating models used in the simulation study, -->
<!--         with their abbreviation written in italic font.} -->
<!-- \label{tab:simscenarios} -->
<!-- \centering -->
<!-- { -->
<!-- \begin{tabular}{lll}\toprule -->
<!-- & \multicolumn{1}{l}{\textbf{linear relation}} -->
<!-- & \multicolumn{1}{l}{\textbf{quadratic relation}}\\ -->
<!-- \midrule -->
<!--   \textbf{exogenous} -->
<!-- & \hspace*{-3ex}\parbox[t]{0.45\linewidth}{ -->
<!--                     \begin{itemize}\vspace*{-3.5ex}\itemsep-0mm -->
<!--                     \item sequential approach\\ -->
<!--                           \textit{seq. (exo., lin.)} -->
<!--                     \end{itemize}} -->
<!-- & \hspace*{-3ex}\parbox[t]{0.32\linewidth}{ -->
<!--                     \begin{itemize}\vspace*{-3.5ex}\itemsep-0mm -->
<!--                     \item sequential approach\\ -->
<!--                           \textit{seq. (exo., qdr.)} -->
<!--                     \end{itemize}}\\[4ex] -->
<!-- \textbf{endogenous} -->
<!-- & \hspace*{-3ex}\parbox[t]{0.45\linewidth}{ -->
<!--                     \begin{itemize}\vspace*{-3.5ex}\itemsep-0mm -->
<!--                     \item sequential approach\\ -->
<!--                           \textit{seq. (endo., lin.)} -->
<!--                     \item multivariate normal approach -->
<!--                           \begin{itemize}\vspace*{-1ex}\itemsep-0mm -->
<!--                           \item independent error terms\\ -->
<!--                                 \textit{mvn. (indep. err.)} -->
<!--                           \item correlated error terms\\ -->
<!--                                 \textit{mvn. (corr. err.)} -->
<!--                           \end{itemize} -->
<!--                     \end{itemize}} -->
<!-- & \hspace*{-3ex}\parbox[t]{0.32\linewidth}{ -->
<!--                     \begin{itemize}\vspace*{-3.5ex}\itemsep-0mm -->
<!--                     \item sequential approach\\ -->
<!--                           \textit{seq. (endo., lin.)} -->
<!--                     \end{itemize}}\\ -->
<!-- \bottomrule -->
<!-- \end{tabular} -->
<!-- } -->
<!-- \end{table} -->
<p>The general model used for simulation from the sequential approach was
<span class="math display" id="eq:simseq">\[\begin{eqnarray}
y_{ij} &amp;=&amp; (\beta_{y0} + b_{i0}^y) + (\beta_{y1} + b_{i1}^y) t_{ij} + \boldsymbol\gamma f(s_{ij}) + \varepsilon_{ij}^y \tag{5.12}\\
s_{ij} &amp;=&amp; (\beta_{s0} + b_{i0}^s) + (\beta_{s1} + b_{i1}^s) t_{ij} + \varepsilon_{ij}^s \nonumber
\end{eqnarray}\]</span>
with
<span class="math display">\[\begin{eqnarray*}
\varepsilon_{ij}^y &amp;\sim&amp; N(0, \sigma_y^2)\\
\varepsilon_{ij}^s &amp;\sim&amp; N(0, \sigma_s^2)
\end{eqnarray*}\]</span>
and
<span class="math display">\[\begin{equation*}
\left[
\begin{array}{cc}
(b_{i0}^y, b_{i1}^y)^\top\\
(b_{i0}^s, b_{i1}^s)^\top
\end{array}\right] \sim N\left(\mathbf 0,
                               \left[\begin{array}{cc}
                               \mathbf D_y &amp; \mathbf D_{y,s}\\
                               \mathbf D_{y,s} &amp; \mathbf D_s
                               \end{array}\right]\right),
\end{equation*}\]</span>
where <span class="math inline">\(t_{ij}\)</span> is from a uniform distribution on the interval <span class="math inline">\([0, 5]\)</span>.
The specific values of all parameters can be found in Table <a href="ch-SMMR.html#tab:paramvalues">5.3</a> in
<a href="#c.3-parameter-values">Appendix 5.C.3</a>.
The general model to simulate from a multivariate normal distribution was
<span class="math display" id="eq:simmvn">\[\begin{eqnarray}
y_{ij} &amp;=&amp; (\tilde \beta_{y0} + \tilde b_{i0}^y) + (\tilde\beta_{y1} + \tilde b_{i1}^y) t_{ij} + \tilde\varepsilon_{ij}^y \tag{5.13}\\
s_{ij} &amp;=&amp; (\tilde \beta_{s0} + \tilde b_{i0}^s) + (\tilde\beta_{s1} + \tilde b_{i1}^s) t_{ij} + \tilde\varepsilon_{ij}^s\nonumber
\end{eqnarray}\]</span>
with
<span class="math display">\[\begin{equation*}
\left[
\begin{array}{cc}
\tilde\varepsilon_{ij}^y\\
\tilde\varepsilon_{ij}^s
\end{array}\right] \sim N \left(\mathbf 0,
                                \left[\begin{array}{cc}
                                \tilde\sigma_y^2 &amp; \tilde\sigma_{y,s}\\
                                \tilde\sigma_{y,s} &amp; \tilde\sigma_s^2
                                \end{array}\right]\right)
\end{equation*}\]</span></p>
<p>and
<span class="math display">\[\begin{equation*}
\left[
\begin{array}{c}
(\tilde b_{i0}^y, \tilde b_{i1}^y)^\top\\
(\tilde b_{i0}^s, \tilde b_{i1}^s)^\top
\end{array}\right] \sim N\left(\mathbf 0,
                               \left[\begin{array}{cc}
                               \mathbf{\widetilde D}_y &amp; \mathbf{\widetilde D}_{y,s}\\
                               \mathbf{\widetilde D}_{y,s} &amp; \mathbf{\widetilde D}_s
                               \end{array}\right]\right).
\end{equation*}\]</span></p>
<p>With these models, the six different data scenarios were specified as</p>
<ul>
<li><em>seq (exo., lin.)</em>:
simulation from model <a href="ch-SMMR.html#eq:simseq">(5.12)</a>,<br>
with <span class="math inline">\(\boldsymbol\gamma f(s_{ij}) = \gamma_1 s_{ij}\)</span> and <span class="math inline">\(\mathbf D_{y,s} = \mathbf 0\)</span>,</li>
<li><em>seq. (exo., qdr.)</em>:
simulation from model <a href="ch-SMMR.html#eq:simseq">(5.12)</a>,<br>
with <span class="math inline">\(\boldsymbol\gamma f(s_{ij}) = \gamma_1 s_{ij} + \gamma_2 s_{ij}^2\)</span>
and <span class="math inline">\(\mathbf D_{y,s} = \mathbf 0\)</span>,</li>
<li><em>seq (endo., lin.)</em>:
simulation from model <a href="ch-SMMR.html#eq:simseq">(5.12)</a>, with <span class="math inline">\(\boldsymbol\gamma f(s_{ij}) = \gamma_1 s_{ij}\)</span>
and <span class="math inline">\(\mathbf D_{y,s} \neq 0\)</span>,</li>
<li><em>seq (endo., qdr.)</em>:
simulation from model <a href="ch-SMMR.html#eq:simseq">(5.12)</a>, with <span class="math inline">\(\boldsymbol\gamma f(s_{ij}) = \gamma_1 s_{ij} + \gamma_2 s_{ij}^2\)</span>
and <span class="math inline">\(\mathbf D_{y,s} \neq 0\)</span>,</li>
<li><em>mvn (indep. err.)</em>:
simulation from model <a href="ch-SMMR.html#eq:simmvn">(5.13)</a>, with <span class="math inline">\(\mathbf{\widetilde D}_{y,s} \neq \mathbf 0\)</span> and <span class="math inline">\(\tilde \sigma_{y,s}^2 = 0\)</span>,</li>
<li><em>mvn (corr. err.)</em>:
simulation from model <a href="ch-SMMR.html#eq:simmvn">(5.13)</a>, with <span class="math inline">\(\mathbf{\widetilde D}_{y,s} \neq \mathbf 0\)</span> and <span class="math inline">\(\tilde \sigma_{y,s}^2 \neq 0\)</span>.</li>
</ul>
<p>Missing values were created in <span class="math inline">\(\mathbf s\)</span> according to two MAR mechanisms.
In missingness scenario <em>MAR.1</em>, the probability of <span class="math inline">\(s_{ij}\)</span> being missing depended on <span class="math inline">\(y_{ij}\)</span> only,
while in missingness scenario <em>MAR.2</em> this probability
depended on <span class="math inline">\(y_{ij}\)</span> as well as <span class="math inline">\(s_{ij-1}\)</span>, specifically
<span class="math display">\[\begin{align*}
\textit{MAR.1:} \qquad \Pr(s_{ij} = \text{NA}) &amp; = \text{expit}(y_{ij} + \zeta_1), \\
\textit{MAR.2:} \qquad \Pr(s_{ij} = \text{NA}) &amp; = \text{expit}(y_{ij} + \zeta_1 + \zeta_2 \unicode{x1D7D9}\;\,(s_{ij-1}&lt;\zeta_3)),
\end{align*}\]</span></p>
<p>where <span class="math inline">\(\text{expit}(x) = \exp(x)/(1+\exp(x))\)</span> and
<span class="math inline">\(\unicode{x1D7D9}\;\)</span>
is the indicator function
which is one if the statement is true and zero otherwise.
The values for the parameters <span class="math inline">\(\zeta\)</span> were chosen so that approximately 40% of
<span class="math inline">\(\mathbf s\)</span> were missing and can be found in Table <a href="ch-SMMR.html#tab:mispars">5.4</a> in
<a href="c-parameter-values">Appendix 5.C.3</a>.</p>
</div>
<div id="c.2-analysis-models" class="section level4 unnumbered">
<h4>5.C.2 Analysis Models</h4>
<p>Each of the datasets was analysed using both approaches with different
assumptions regarding the endo- or exogeneity of the covariate and the
functional form, before values were deleted, and for both missing mechanisms.
An overview of the analysis methods used under the assumptions of either exo-
or endogeneity is given in Table <a href="ch-SMMR.html#tab:simanalyis">5.2</a>.
The complete data was analysed using function <code>lmer()</code> from the
R-package <strong>lme4</strong> <span class="citation">(R Core Team <a href="#ref-R2016" role="doc-biblioref">2016</a>; Bates et al. <a href="#ref-lme4" role="doc-biblioref">2015</a>)</span> as well as with the sequential
approach with independent random effects, <span class="math inline">\(\mathbf D_{y,s} = \mathbf0\)</span>,
when the covariate was assumed to be exogenous, and with the sequential
approach with correlated random effects, i.e., <span class="math inline">\(\mathbf D_{y,s} \neq \mathbf0\)</span>,
when it was assumed to be endogenous. The functional form was specified to be
either linear or quadratic, depending on the current assumption.
Incomplete data from both missing mechanisms was imputed and analysed with the
sequential approach, again with either independent or correlated random effects.
The imputation was repeated with the multivariate normal approach, using the
model with independent error terms as well as the model with correlated error
terms, and imputed datasets were created by drawing two values that were at
least 50 iterations apart from each of the posterior chains of the incomplete
covariate. The resulting ten imputed datasets were analysed analogously to the
analysis of the complete data.
When <code>lmer()</code> was used, the coefficients from the ten corresponding
analyses were pooled using Rubin’s Rules <span class="citation">(Rubin <a href="#ref-Rubin1987" role="doc-biblioref">1987</a>)</span> and when the
sequential approach was used, the ten sets of posterior Markov chains were
combined to calculate posterior summary measures.</p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:simanalyis">Table 5.2: </span>Overview of imputation and analysis methods used under the assumption
of exo- or endogeneity, for the complete as well as incomplete data.
</caption>
<thead>
<tr>
<th style="text-align:left;">
assumption
</th>
<th style="text-align:left;">
compl. data
</th>
<th style="text-align:left;">
MAR.1 &amp; MAR.2
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;vertical-align: top !important;background-color: white !important;" rowspan="3">
<strong>exogenous</strong>
</td>
<td style="text-align:left;background-color: white !important;">
sequential
</td>
<td style="text-align:left;background-color: white !important;">
sequential
</td>
</tr>
<tr>
<td style="text-align:left;vertical-align: top !important;background-color: white !important;" rowspan="2">
<code>lmer()</code>
</td>
<td style="text-align:left;background-color: white !important;">
multivariate normal (indep. err.) + <code>lmer()</code>
</td>
</tr>
<tr>
<td style="text-align:left;background-color: white !important;">
multivariate normal (corr. err.) + <code>lmer()</code>
</td>
</tr>
<tr>
<td style="text-align:left;vertical-align: top !important;background-color: white !important;" rowspan="3">
<strong>endogenous</strong>
</td>
<td style="text-align:left;vertical-align: top !important;background-color: white !important;" rowspan="3">
sequential
</td>
<td style="text-align:left;background-color: white !important;">
sequential
</td>
</tr>
<tr>
<td style="text-align:left;background-color: white !important;">
multivariate normal (indep. err.) + sequential
</td>
</tr>
<tr>
<td style="text-align:left;background-color: white !important;">
multivariate normal (corr. err.) + sequential
</td>
</tr>
</tbody>
</table>
<!-- \begin{table}[!ht] -->
<!-- \caption{Overview of imputation and analysis methods used under the assumption -->
<!--          of exo- or endogeneity, for the complete as well as incomplete data.} -->
<!-- \label{tab:simanalyis} -->
<!-- \centering\small -->
<!-- \begin{tabular}{lll}\toprule -->
<!-- \textbf{assumption} & \textbf{compl. data} & \textbf{MAR.1 \& MAR.2}\\\midrule -->
<!-- \textbf{exogenous}  & \tabitem sequential & \tabitem sequential\\ -->
<!-- & \tabitem  \texttt{lmer()} & \tabitem multivariate normal (indep. err.) + \texttt{lmer()}\\ -->
<!-- &                           & \tabitem multivariate normal (corr. err.) + \texttt{lmer()}\\[4ex] -->
<!-- \textbf{endogenous} & \tabitem sequential & \tabitem sequential\\ -->
<!--                     &                     & \tabitem multivariate normal (indep. err.) + sequential\\ -->
<!--                     &                     & \tabitem multivariate normal (corr. err.) + sequential -->
<!-- \\\bottomrule -->
<!-- \end{tabular} -->
<!-- \end{table} -->
<p>All Bayesian analyses used five parallel MCMC chains and were implemented in
JAGS <span class="citation">(Plummer <a href="#ref-JAGS" role="doc-biblioref">2003</a>)</span>, using the R-package <strong>rjags</strong> <span class="citation">(Plummer <a href="#ref-rjags2016" role="doc-biblioref">2016</a>)</span>.
Chains were assumed to have converged when the Gelman-Rubin criterion
<span class="citation">(Gelman, Meng, and Stern <a href="#ref-Gelman1996" role="doc-biblioref">1996</a>)</span> was not more than 1.1 for the parameters of interest,
<span class="math inline">\((\beta_{y0}, \beta_{y1}, \boldsymbol\gamma^\top)\)</span>, and not more than 1.25 for other
parameters.
The number of iterations in the posterior sample necessary to obtain sufficient
precision of the posterior estimate was determined based on the sampling error
of the chains for <span class="math inline">\((\beta_{y0}, \beta_{y1}, \boldsymbol\gamma^\top)\)</span>, which was
required to be less than 5% of the corresponding standard error.</p>


</div>
<div id="c.3-parameters-values" class="section level4 unnumbered">
<h4>5.C.3 Parameters Values</h4>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:paramvalues">Table 5.3: </span>Parameter values that were used in the data generating models.
</caption>
<thead>
<tr>
<th style="text-align:right;">
sequential model
</th>
<th style="text-align:right;">
multivariate normal model
</th>
</tr>
</thead>
<tbody>
<tr grouplength="4">
<td colspan="2" style="background-color: #666; color: #fff;">
<strong>coefficients in the model for <span class="math inline">\(\mathbf y\)</span></strong>
</td>
</tr>
<tr>
<td style="text-align:right; padding-left: 2em;background-color: white !important;" indentlevel="1">
<span class="math inline">\(\beta_{y0} = -1.00\)</span>
</td>
<td style="text-align:right;background-color: white !important;">
<span class="math inline">\(\tilde\beta_{y0} = -1.00\)</span>
</td>
</tr>
<tr>
<td style="text-align:right; padding-left: 2em;background-color: white !important;" indentlevel="1">
<span class="math inline">\(\beta_{y1} =  0.80\)</span>
</td>
<td style="text-align:right;background-color: white !important;">
<span class="math inline">\(\tilde\beta_{y1} =  0.80\)</span>
</td>
</tr>
<tr>
<td style="text-align:right; padding-left: 2em;background-color: white !important;" indentlevel="1">
<span class="math inline">\(\gamma_1 =  1.20\)</span>
</td>
<td style="text-align:right;background-color: white !important;">
</td>
</tr>
<tr>
<td style="text-align:right; padding-left: 2em;background-color: white !important;" indentlevel="1">
<span class="math inline">\(\gamma_2 = -0.35\)</span>
</td>
<td style="text-align:right;background-color: white !important;">
</td>
</tr>
<tr grouplength="2">
<td colspan="2" style="background-color: #666; color: #fff;">
<strong>coefficients in the model for <span class="math inline">\(\mathbf s\)</span></strong>
</td>
</tr>
<tr>
<td style="text-align:right; padding-left: 2em;background-color: white !important;" indentlevel="1">
<span class="math inline">\(\beta_{s0} =  2.00\)</span>
</td>
<td style="text-align:right;background-color: white !important;">
<span class="math inline">\(\tilde\beta_{s0} =  2.00\)</span>
</td>
</tr>
<tr>
<td style="text-align:right; padding-left: 2em;background-color: white !important;" indentlevel="1">
<span class="math inline">\(\beta_{s1} = -0.30\)</span>
</td>
<td style="text-align:right;background-color: white !important;">
<span class="math inline">\(\tilde\beta_{s1} = -0.30\)</span>
</td>
</tr>
<tr grouplength="3">
<td colspan="2" style="background-color: #666; color: #fff;">
<strong>(co)variances of the error terms</strong>
</td>
</tr>
<tr>
<td style="text-align:right; padding-left: 2em;background-color: white !important;" indentlevel="1">
<span class="math inline">\(\sigma_y^2 =  0.40\)</span>
</td>
<td style="text-align:right;background-color: white !important;">
<span class="math inline">\(\tilde\sigma_y^2 =  0.40\)</span>
</td>
</tr>
<tr>
<td style="text-align:right; padding-left: 2em;background-color: white !important;" indentlevel="1">
<span class="math inline">\(\sigma_s^2 =  0.30\)</span>
</td>
<td style="text-align:right;background-color: white !important;">
<span class="math inline">\(\tilde\sigma_s^2 =  0.30\)</span>
</td>
</tr>
<tr>
<td style="text-align:right; padding-left: 2em;background-color: white !important;" indentlevel="1">
</td>
<td style="text-align:right;background-color: white !important;">
<span class="math inline">\(\tilde\sigma_{y,s} =  0.20\)</span>
</td>
</tr>
<tr grouplength="3">
<td colspan="2" style="background-color: #666; color: #fff;">
<strong>(co)variances of the random effects</strong>
</td>
</tr>
<tr>
<td style="text-align:right; padding-left: 2em;background-color: white !important;" indentlevel="1">
<span class="math inline">\(\mathbf{D}_{y} = \left[\begin{array}{rr}   1.413 &amp;  0.166\\  0.166 &amp; 0.106  \end{array}\right]\)</span>
</td>
<td style="text-align:right;background-color: white !important;">
<span class="math inline">\(\widetilde{\mathbf{D}}_{y} = \left[\begin{array}{rr}   1.413 &amp;  0.166\\  0.166 &amp; 0.106  \end{array}\right]\)</span>
</td>
</tr>
<tr>
<td style="text-align:right; padding-left: 2em;background-color: white !important;" indentlevel="1">
<span class="math inline">\(\mathbf{D}_{s} = \left[\begin{array}{rr}  1.500 &amp; -0.202\\  -0.202 &amp; 0.165  \end{array}\right]\)</span>
</td>
<td style="text-align:right;background-color: white !important;">
<span class="math inline">\(\widetilde{\mathbf{D}}_{s} = \left[\begin{array}{rr}  1.500 &amp; -0.202\\  -0.202 &amp; 0.165  \end{array}\right]\)</span>
</td>
</tr>
<tr>
<td style="text-align:right; padding-left: 2em;background-color: white !important;" indentlevel="1">
<span class="math inline">\(\mathbf{D}_{y,s} = \left[\begin{array}{rr}%  0.022 &amp; -0.015\\%  -0.015 &amp; -0.083%  \end{array}\right]\)</span>
</td>
<td style="text-align:right;background-color: white !important;">
<span class="math inline">\(\widetilde{\mathbf{D}}_{y,s} = \left[\begin{array}{rr}%  0.022 &amp; -0.015\\%  -0.015 &amp; -0.083%  \end{array}\right]\)</span>
</td>
</tr>
</tbody>
</table>
<table class="table table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:mispars">Table 5.4: </span>Values for <span class="math inline">\(\boldsymbol\zeta\)</span> that were used to create missing values in each of the six data scenarios.
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
<span class="math inline">\(\zeta_1\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\(\zeta_2\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\(\zeta_3\)</span>
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;background-color: white !important;">
<i>seq. (exo., lin.)</i>
</td>
<td style="text-align:right;background-color: white !important;">
-3.20
</td>
<td style="text-align:right;background-color: white !important;">
-0.5
</td>
<td style="text-align:right;background-color: white !important;">
0.0
</td>
</tr>
<tr>
<td style="text-align:left;background-color: white !important;">
<i>seq. (endo., lin.)</i>
</td>
<td style="text-align:right;background-color: white !important;">
-3.20
</td>
<td style="text-align:right;background-color: white !important;">
-0.5
</td>
<td style="text-align:right;background-color: white !important;">
0.0
</td>
</tr>
<tr>
<td style="text-align:left;background-color: white !important;">
<i>seq. (exo., qdr.)</i>
</td>
<td style="text-align:right;background-color: white !important;">
-1.85
</td>
<td style="text-align:right;background-color: white !important;">
-0.7
</td>
<td style="text-align:right;background-color: white !important;">
-0.3
</td>
</tr>
<tr>
<td style="text-align:left;background-color: white !important;">
<i>seq. (endo., qdr.)</i>
</td>
<td style="text-align:right;background-color: white !important;">
-1.85
</td>
<td style="text-align:right;background-color: white !important;">
-0.7
</td>
<td style="text-align:right;background-color: white !important;">
-0.3
</td>
</tr>
<tr>
<td style="text-align:left;background-color: white !important;">
<i>mvn. (indep. err.)</i>
</td>
<td style="text-align:right;background-color: white !important;">
-1.60
</td>
<td style="text-align:right;background-color: white !important;">
-0.5
</td>
<td style="text-align:right;background-color: white !important;">
-0.3
</td>
</tr>
<tr>
<td style="text-align:left;background-color: white !important;">
<i>mvn. (corr. err.)</i>
</td>
<td style="text-align:right;background-color: white !important;">
-1.60
</td>
<td style="text-align:right;background-color: white !important;">
-0.5
</td>
<td style="text-align:right;background-color: white !important;">
-0.3
</td>
</tr>
</tbody>
</table>

</div>
<div id="c.4-detailed-discussion-of-the-results" class="section level4 unnumbered">
<h4>5.C.4 Detailed Discussion of the Results</h4>
<p>In this section, we present and discuss the results from the simulation study
in detail. We adhere to the list of aims of the simulation study stated
above and start with the comparison of the sequential and the multivariate
normal approach when exo- or endogeneity and functional form are specified
correctly. The relevant part of the results is shown in
Figure <a href="ch-SMMR.html#fig:simcorrect">5.8</a> and grouped into four figures, according to
whether the data generating model implied an exogenous or endogenous covariate
and a linear or quadratic functional relation with the outcome. The six
data generating models are indicated by different plotting symbols.
The different approaches (sequential and multivariate normal, with independent
or correlated error terms) are represented by rows, whereas the columns show
three evaluation measures, summarized over all 200 simulated datasets.
The relative bias was calculated as the median of the ratios of the estimate
(REML estimate or posterior mean) from the analysis of the incomplete data and
the estimate from the corresponding complete data analysis,
the mean squared error (MSE) as the average of the squared differences between
the estimates from the missing and complete data analyses,
and the CI-coverage as the proportion of CIs from the missing data analysis that
covered the estimate from the corresponding complete data analysis.
The desired value for each of these measures is indicated by
the vertical line. Since results were similar under both missing mechanisms in
most settings and to facilitate readability of the figures, we present results
under <em>MAR.1</em> only. Furthermore, we only present results for the parameter
related to the time-varying covariate, <span class="math inline">\(\boldsymbol \gamma\)</span>.</p>
<div class="figure" style="text-align: center"><span id="fig:simcorrect"></span>
<img src="Dissertation_files/figure-html/simcorrect-1.png" alt="Relative bias, mean squared error (MSE), and proportion of CIs that
         covered the estimate from the
         analysis of the complete data, when imputation and analysis models
         were correctly specified with regards to exo- or endogeneity and
         functional form. The vertical lines mark the respective desired values." width="100%"  />
<p class="caption">
Figure 5.8: Relative bias, mean squared error (MSE), and proportion of CIs that
covered the estimate from the
analysis of the complete data, when imputation and analysis models
were correctly specified with regards to exo- or endogeneity and
functional form. The vertical lines mark the respective desired values.
</p>
</div>
<p>Figure <a href="ch-SMMR.html#fig:simcorrect">5.8</a>a shows that the sequential approach
as well as the multivariate normal approach with correlated error terms were
both unbiased and had CIs that covered the posterior mean from the
complete data analysis in all 200 simulations when data was generated with
a linear functional form and exogenous covariate.
The multivariate normal approach with independent error terms, however, was
clearly biased and had CIs that did not cover the estimate from the analysis
of the complete data for any of the simulated datasets.
It performed even worse in the endogenous setting
(shown in Figure <a href="ch-SMMR.html#fig:simcorrect">5.8</a>b), unless data was
generated by this very model.
The multivariate normal approach with correlated error terms and the sequential
approach performed well in data that was simulated from the sequential model
or the multivariate normal model with correlated error terms, but were
biased for data that was generated by the multivariate normal model with
independent error terms (relative bias approx. <span class="math inline">\(1.05\)</span> under <em>MAR.1</em> and
approx. <span class="math inline">\(1.3\)</span> under <em>MAR.2</em>, for both approaches), however, coverage
of the CIs was above 95%.</p>
<p>Corresponding results in the settings with a quadratic relation
are shown in Figures <a href="ch-SMMR.html#fig:simcorrect">5.8</a>c and <a href="ch-SMMR.html#fig:simcorrect">5.8</a>d
for the sequential approach, since a correct
specification of a quadratic functional form during the imputation procedure
is not possible in the multivariate normal approach. Also in these settings,
the sequential approach performed well.</p>
<p>The results from the linear setting demonstrate that misspecification of the
correlation structure of the error terms may have great impact on the results
and we will, therefore, exclude the multivariate normal model with independent
error terms in the subsequent comparisons. Note that, since in our simulation
<span class="math inline">\(\varepsilon_{ij}^s\)</span> enters the model for <span class="math inline">\(y_{ij}\)</span> through <span class="math inline">\(s_{ij}\)</span>, the
sequential approach also implies correlation between the error terms.</p>
<div class="figure" style="text-align: center"><span id="fig:simeemis"></span>
<img src="Dissertation_files/figure-html/simeemis-1.png" alt="Relative bias, mean squared error (MSE), and proportion of CIs that covered the estimate from the
         analysis of the complete data, when imputation and analysis models
         were correctly specified with regards to the functional form but
         misspecified with regards to the exo- or endogeneity of the
         time-varying covariate.
         The vertical lines mark the respective desired values." width="100%"  />
<p class="caption">
Figure 5.9: Relative bias, mean squared error (MSE), and proportion of CIs that covered the estimate from the
analysis of the complete data, when imputation and analysis models
were correctly specified with regards to the functional form but
misspecified with regards to the exo- or endogeneity of the
time-varying covariate.
The vertical lines mark the respective desired values.
</p>
</div>
<p>The second aim of this simulation study was to investigate the effect of
misspecification of the exo- or endogeneity during imputation and/or analysis.
Figure <a href="ch-SMMR.html#fig:simeemis">5.9</a> summarizes the relevant results, again split
into the different settings with regards to the assumption of exo- or
endogeneity and the functional form. The setting in which a linear endogenous
covariate is misspecified as exogenous is shown in
Figure <a href="ch-SMMR.html#fig:simeemis">5.9</a>a. There, imputation with the multivariate
normal approach did not add any bias compared to the (in the same way
misspecified) analysis of the complete data, irrespective if the data were
generated by the multivariate normal model or the (endogenous) sequential model.
Imputation and analysis with the sequential approach with independent random
effects introduced some additional bias: for data that was simulated from the
sequential approach with correlated random effects, the relative bias was
0.98 and the coverage
88%. When data was simulated from the
multivariate normal model, however, the relative bias worsened to
0.87 and the coverage to
2.5%.
In the reversed case, where a linear, exogenous covariate was misspecified as
endogenous, estimates from both the sequential and the multivariate normal
approach were unbiased (see Figure <a href="ch-SMMR.html#fig:simeemis">5.9</a>b).
Simulations in the quadratic setting led to corresponding results (for the
sequential approach), although the estimates of <span class="math inline">\(\gamma_2\)</span> were less biased than
the estimates of <span class="math inline">\(\gamma_1\)</span>, as can be seen in
Figures <a href="ch-SMMR.html#fig:simeemis">5.9</a>c and <a href="ch-SMMR.html#fig:simeemis">5.9</a>d.</p>
<div class="figure" style="text-align: center"><span id="fig:simffmis"></span>
<img src="Dissertation_files/figure-html/simffmis-1.png" alt="Relative bias, mean squared error (MSE), and proportion of CIs that covered the estimate from the
         analysis of the complete data, when imputation and analysis models
         were correctly specified with regards to exo- or endogeneity but
         misspecified with regards to the functional form.
         The vertical lines mark the respective desired values." width="100%"  />
<p class="caption">
Figure 5.10: Relative bias, mean squared error (MSE), and proportion of CIs that covered the estimate from the
analysis of the complete data, when imputation and analysis models
were correctly specified with regards to exo- or endogeneity but
misspecified with regards to the functional form.
The vertical lines mark the respective desired values.
</p>
</div>
<p>With regards to our third aim, the exploration of bias due to misspecification
of the functional form, we investigated two specific issues.
First, we explored to what extend misspecification of a
quadratic functional form as linear during imputation with the multivariate
normal approach, when the functional relation is correctly specified during
the subsequent analysis, had an impact on the results.
Our findings are summarized in Figure <a href="ch-SMMR.html#fig:simffmis">5.10</a> and show
that this type of misspecification resulted in a relative bias of approximately
0.8 and very bad coverage of the CIs of both parameters, <span class="math inline">\(\gamma_1\)</span> and
<span class="math inline">\(\gamma_2\)</span>, which did not cover the true parameters in any of the simulations.</p>
<p>Second, we extended the misspecification to the analysis model, i.e., assumed
that the functional form was linear when the true structure was quadratic.
In both approaches, this resulted in only little additional bias compared
to the misspecified analysis of the complete data, in the exogenous as well
as in the endogenous setting, and had no influence on the coverage of the
CIs (see Figure <a href="ch-SMMR.html#fig:simffmis">5.10</a>).</p>
<p>Summarizing the results from our simulation study, we saw that misspecification
of the error terms in the multivariate normal approach as independent had
the largest impact on the results, leading to estimates that were on average
half the value of the estimate from the analysis of the complete data and CIs
that had coverage of 0%.
For misspecification of an endogenous covariate as exogenous the most severe
relative bias that was observed was 0.87 (and a corresponding coverage of the
95% CI of only 2.5%) in the setting where the sequential approach (with
independent random effects) was used to impute data that was generated by
the multivariate normal model.
Imputation with the multivariate normal approach (with correlated error terms)
in a setting where the functional form was correctly assumed to be quadratic
had the second largest impact, with a relative bias of approximately 0.8,
and resulted in CIs that only covered the parameter estimated in the analysis
of the complete data in one single simulation for <em>MAR.2</em>.
The bias that was added due to misspecification of the functional form as
linear during imputation and analysis as compared to the results from the
analysis of the complete data under the same misspecification was small
(between 0.96 and 1.05) and overall comparable between the multivariate normal
and the sequential approach.</p>

</div>
<div id="c.5-jags-syntax" class="section level4 unnumbered">
<h4>5.C.5 JAGS Syntax</h4>
<p>We provide here an example of the JAGS <span class="citation">(Plummer <a href="#ref-JAGS" role="doc-biblioref">2003</a>)</span> syntax that was used in the
simulation study. The first part of syntax shows the sequential model assuming
<span class="math inline">\(\mathbf s\)</span> is exogenous and has a linear relation with <span class="math inline">\(\mathbf y\)</span>. We then
show how to adapt that syntax for the endogenous setting.
The second part contains example syntax that shows how the multivariate normal
approach can be implemented in JAGS. There, we present the syntax used in the
setting with correlated error terms.</p>
<p>When implementing mixed models in JAGS, it is convenient to use hierarchical
centring. This means that the fixed effects enter the linear predictor through
the random effects, i.e., the random effects are not centred around zero but
around the fixed effects. The syntax differs from the formulas provided in
the previous sections to this regard. Note also that normal distributions have to be
specified using the precision instead of the variance when using JAGS.</p>
<p><strong>Data / Notation:</strong>
</p>
<ul>
<li><code>TN</code>: number of observations in the dataset</li>
<li><code>N</code>: number of individuals</li>
<li><code>priorR</code>: <span class="math inline">\(4\times 4\)</span> diagonal matrix of NA values</li>
</ul>
<div id="sequential-approach" class="section level5 unnumbered">
<h5>Sequential Approach</h5>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="ch-SMMR.html#cb2-1"></a>model {</span>
<span id="cb2-2"><a href="ch-SMMR.html#cb2-2"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>TN) {</span>
<span id="cb2-3"><a href="ch-SMMR.html#cb2-3"></a>    <span class="co"># linear mixed effects models for y and s</span></span>
<span id="cb2-4"><a href="ch-SMMR.html#cb2-4"></a>    y[j] <span class="op">~</span><span class="st"> </span><span class="kw">dnorm</span>(mu.y[j], tau.y)</span>
<span id="cb2-5"><a href="ch-SMMR.html#cb2-5"></a>    s[j] <span class="op">~</span><span class="st"> </span><span class="kw">dnorm</span>(mu.s[j], tau.s)</span>
<span id="cb2-6"><a href="ch-SMMR.html#cb2-6"></a></span>
<span id="cb2-7"><a href="ch-SMMR.html#cb2-7"></a>    <span class="co"># linear predictors</span></span>
<span id="cb2-8"><a href="ch-SMMR.html#cb2-8"></a>    <span class="co"># (hierarchical centring specification for baseline effects)</span></span>
<span id="cb2-9"><a href="ch-SMMR.html#cb2-9"></a>    mu.y[j] &lt;-<span class="st"> </span><span class="kw">inprod</span>(b[subj[j], <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>], Z[j, ]) <span class="op">+</span><span class="st"> </span>beta[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>s[j]</span>
<span id="cb2-10"><a href="ch-SMMR.html#cb2-10"></a>    mu.s[j] &lt;-<span class="st"> </span><span class="kw">inprod</span>(b[subj[j], <span class="dv">3</span><span class="op">:</span><span class="dv">4</span>], Z[j, ])</span>
<span id="cb2-11"><a href="ch-SMMR.html#cb2-11"></a>  }</span>
<span id="cb2-12"><a href="ch-SMMR.html#cb2-12"></a></span>
<span id="cb2-13"><a href="ch-SMMR.html#cb2-13"></a>  <span class="co"># priors for the precision of y and s</span></span>
<span id="cb2-14"><a href="ch-SMMR.html#cb2-14"></a>  tau.y <span class="op">~</span><span class="st"> </span><span class="kw">dgamma</span>(<span class="fl">0.01</span>, <span class="fl">0.01</span>)</span>
<span id="cb2-15"><a href="ch-SMMR.html#cb2-15"></a>  tau.s <span class="op">~</span><span class="st"> </span><span class="kw">dgamma</span>(<span class="fl">0.01</span>, <span class="fl">0.01</span>)</span>
<span id="cb2-16"><a href="ch-SMMR.html#cb2-16"></a></span>
<span id="cb2-17"><a href="ch-SMMR.html#cb2-17"></a>  </span>
<span id="cb2-18"><a href="ch-SMMR.html#cb2-18"></a>  </span>
<span id="cb2-19"><a href="ch-SMMR.html#cb2-19"></a>  <span class="co"># specification of the random effects</span></span>
<span id="cb2-20"><a href="ch-SMMR.html#cb2-20"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) {</span>
<span id="cb2-21"><a href="ch-SMMR.html#cb2-21"></a>    <span class="co"># random effects in the model for y</span></span>
<span id="cb2-22"><a href="ch-SMMR.html#cb2-22"></a>    b[i, <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>] <span class="op">~</span><span class="st"> </span><span class="kw">dmnorm</span>(mu.b[i, <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>], inv.D.y[ , ])</span>
<span id="cb2-23"><a href="ch-SMMR.html#cb2-23"></a>    mu.b[i, <span class="dv">1</span>] &lt;-<span class="st"> </span>beta[<span class="dv">1</span>] <span class="co"># random intercept</span></span>
<span id="cb2-24"><a href="ch-SMMR.html#cb2-24"></a>    mu.b[i, <span class="dv">2</span>] &lt;-<span class="st"> </span>beta[<span class="dv">2</span>] <span class="co"># random slope</span></span>
<span id="cb2-25"><a href="ch-SMMR.html#cb2-25"></a></span>
<span id="cb2-26"><a href="ch-SMMR.html#cb2-26"></a>    <span class="co"># random effects in the model for s</span></span>
<span id="cb2-27"><a href="ch-SMMR.html#cb2-27"></a>    b[i, <span class="dv">3</span><span class="op">:</span><span class="dv">4</span>] <span class="op">~</span><span class="st"> </span><span class="kw">dmnorm</span>(mu.b[i, <span class="dv">3</span><span class="op">:</span><span class="dv">4</span>], inv.D.s[ , ])</span>
<span id="cb2-28"><a href="ch-SMMR.html#cb2-28"></a>    mu.b[i, <span class="dv">3</span>] &lt;-<span class="st"> </span>alpha[<span class="dv">1</span>] <span class="co"># random intercept</span></span>
<span id="cb2-29"><a href="ch-SMMR.html#cb2-29"></a>    mu.b[i, <span class="dv">4</span>] &lt;-<span class="st"> </span>alpha[<span class="dv">2</span>] <span class="co"># random slope</span></span>
<span id="cb2-30"><a href="ch-SMMR.html#cb2-30"></a>  }</span>
<span id="cb2-31"><a href="ch-SMMR.html#cb2-31"></a></span>
<span id="cb2-32"><a href="ch-SMMR.html#cb2-32"></a>  <span class="co"># priors for the fixed effects</span></span>
<span id="cb2-33"><a href="ch-SMMR.html#cb2-33"></a>  <span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>) {</span>
<span id="cb2-34"><a href="ch-SMMR.html#cb2-34"></a>    beta[k] <span class="op">~</span><span class="st"> </span><span class="kw">dnorm</span>(<span class="dv">0</span>, <span class="fl">0.001</span>)</span>
<span id="cb2-35"><a href="ch-SMMR.html#cb2-35"></a>  }</span>
<span id="cb2-36"><a href="ch-SMMR.html#cb2-36"></a>  <span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>) {</span>
<span id="cb2-37"><a href="ch-SMMR.html#cb2-37"></a>    alpha[k] <span class="op">~</span><span class="st"> </span><span class="kw">dnorm</span>(<span class="dv">0</span>, <span class="fl">0.001</span>)</span>
<span id="cb2-38"><a href="ch-SMMR.html#cb2-38"></a>  }</span>
<span id="cb2-39"><a href="ch-SMMR.html#cb2-39"></a></span>
<span id="cb2-40"><a href="ch-SMMR.html#cb2-40"></a></span>
<span id="cb2-41"><a href="ch-SMMR.html#cb2-41"></a>  <span class="co"># priors for the precision of the random effects</span></span>
<span id="cb2-42"><a href="ch-SMMR.html#cb2-42"></a>  <span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) {</span>
<span id="cb2-43"><a href="ch-SMMR.html#cb2-43"></a>    priorR[k, k] <span class="op">~</span><span class="st"> </span><span class="kw">dgamma</span>(<span class="fl">0.1</span>, <span class="fl">0.01</span>)</span>
<span id="cb2-44"><a href="ch-SMMR.html#cb2-44"></a>  }</span>
<span id="cb2-45"><a href="ch-SMMR.html#cb2-45"></a></span>
<span id="cb2-46"><a href="ch-SMMR.html#cb2-46"></a>  <span class="co"># precision and covariance matrix of the random effects </span></span>
<span id="cb2-47"><a href="ch-SMMR.html#cb2-47"></a>  <span class="co"># in the model for y</span></span>
<span id="cb2-48"><a href="ch-SMMR.html#cb2-48"></a>  inv.D.y[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>] <span class="op">~</span><span class="st"> </span><span class="kw">dwish</span>(priorR[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>], <span class="dv">2</span>)</span>
<span id="cb2-49"><a href="ch-SMMR.html#cb2-49"></a>  D.y[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">inverse</span>(inv.D.y[ , ])</span>
<span id="cb2-50"><a href="ch-SMMR.html#cb2-50"></a></span>
<span id="cb2-51"><a href="ch-SMMR.html#cb2-51"></a>  <span class="co"># precision and covariance matrix of the random effects </span></span>
<span id="cb2-52"><a href="ch-SMMR.html#cb2-52"></a>  <span class="co"># in the model for s</span></span>
<span id="cb2-53"><a href="ch-SMMR.html#cb2-53"></a>  inv.D.s[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>] <span class="op">~</span><span class="st"> </span><span class="kw">dwish</span>(priorR[<span class="dv">3</span><span class="op">:</span><span class="dv">4</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">4</span>], <span class="dv">2</span>)</span>
<span id="cb2-54"><a href="ch-SMMR.html#cb2-54"></a>  D.s[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">inverse</span>(inv.D.s[ , ])</span>
<span id="cb2-55"><a href="ch-SMMR.html#cb2-55"></a>}</span></code></pre></div>

<p>In the endogenous setting, the specification of the random effects and
related priors changes to:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="ch-SMMR.html#cb3-1"></a>  <span class="co"># specification of the random effects</span></span>
<span id="cb3-2"><a href="ch-SMMR.html#cb3-2"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) {</span>
<span id="cb3-3"><a href="ch-SMMR.html#cb3-3"></a>    b[i, <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>] <span class="op">~</span><span class="st"> </span><span class="kw">dmnorm</span>(mu.b[i, <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>], inv.D[ , ])</span>
<span id="cb3-4"><a href="ch-SMMR.html#cb3-4"></a></span>
<span id="cb3-5"><a href="ch-SMMR.html#cb3-5"></a>    <span class="co"># random effects in the model for y</span></span>
<span id="cb3-6"><a href="ch-SMMR.html#cb3-6"></a>    mu.b[i, <span class="dv">1</span>] &lt;-<span class="st"> </span>beta[<span class="dv">1</span>]</span>
<span id="cb3-7"><a href="ch-SMMR.html#cb3-7"></a>    mu.b[i, <span class="dv">2</span>] &lt;-<span class="st"> </span>beta[<span class="dv">2</span>]</span>
<span id="cb3-8"><a href="ch-SMMR.html#cb3-8"></a></span>
<span id="cb3-9"><a href="ch-SMMR.html#cb3-9"></a>    <span class="co"># random effects in the model for s</span></span>
<span id="cb3-10"><a href="ch-SMMR.html#cb3-10"></a>    mu.b[i, <span class="dv">3</span>] &lt;-<span class="st"> </span>alpha[<span class="dv">1</span>]</span>
<span id="cb3-11"><a href="ch-SMMR.html#cb3-11"></a>    mu.b[i, <span class="dv">4</span>] &lt;-<span class="st"> </span>alpha[<span class="dv">2</span>]</span>
<span id="cb3-12"><a href="ch-SMMR.html#cb3-12"></a>  }</span>
<span id="cb3-13"><a href="ch-SMMR.html#cb3-13"></a></span>
<span id="cb3-14"><a href="ch-SMMR.html#cb3-14"></a>  <span class="co"># priors for the precision of the random effects</span></span>
<span id="cb3-15"><a href="ch-SMMR.html#cb3-15"></a>  <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>){</span>
<span id="cb3-16"><a href="ch-SMMR.html#cb3-16"></a>    priorR[k, k] <span class="op">~</span><span class="st"> </span><span class="kw">dgamma</span>(<span class="fl">0.1</span>, <span class="fl">0.01</span>)</span>
<span id="cb3-17"><a href="ch-SMMR.html#cb3-17"></a>  }</span>
<span id="cb3-18"><a href="ch-SMMR.html#cb3-18"></a></span>
<span id="cb3-19"><a href="ch-SMMR.html#cb3-19"></a>  <span class="co"># precision and covariance matrix of the random effects</span></span>
<span id="cb3-20"><a href="ch-SMMR.html#cb3-20"></a>  inv.D[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>] <span class="op">~</span><span class="st"> </span><span class="kw">dwish</span>(priorR[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>], <span class="dv">4</span>)</span>
<span id="cb3-21"><a href="ch-SMMR.html#cb3-21"></a>  D[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>] &lt;-<span class="st"> </span><span class="kw">inverse</span>(inv.D[ , ])</span>
<span id="cb3-22"><a href="ch-SMMR.html#cb3-22"></a><span class="er">}</span></span></code></pre></div>
</div>
<div id="multivariate-normal-approach" class="section level5 unnumbered">
<h5>Multivariate Normal Approach</h5>
<p>A natural specification for the distribution of <span class="math inline">\(\boldsymbol y\)</span> and <span class="math inline">\(\mathbf s\)</span> in the
setting with correlated random effects would be to specify
<span class="math inline">\(\left\{y(t), s(t)\right\}^\top\)</span> as multivariate normal. However, JAGS cannot
sample from a multivariate normal distribution when only one component is
missing. We therefore have to specify separate univariate normal distributions
for <span class="math inline">\(y(t)\)</span> and <span class="math inline">\(s(t)\)</span> and additionally a multivariate normal distribution
for the error terms <span class="math inline">\(\left\{\varepsilon_i^y(t), \varepsilon_i^s(t)\right\}^\top\)</span>.
The precision in the univariate normal distributions for <span class="math inline">\(y(t)\)</span> and <span class="math inline">\(s(t)\)</span> is
then set to a large value to ``force’’ the variation to be modelled in the
multivariate normal distribution of the error terms rather than the two
univariate normal distributions.</p>

<p><strong>Data / Notation:</strong>
</p>
<ul>
<li><code>mu.eps</code> = c(0, 0)</li>
<li><code>tau</code> = 10000</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="ch-SMMR.html#cb4-1"></a>model {</span>
<span id="cb4-2"><a href="ch-SMMR.html#cb4-2"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>TN) {</span>
<span id="cb4-3"><a href="ch-SMMR.html#cb4-3"></a>    <span class="co"># linear mixed effects models for y and s</span></span>
<span id="cb4-4"><a href="ch-SMMR.html#cb4-4"></a>    y[j] <span class="op">~</span><span class="st"> </span><span class="kw">dnorm</span>(mu.y[j], tau)</span>
<span id="cb4-5"><a href="ch-SMMR.html#cb4-5"></a>    s[j] <span class="op">~</span><span class="st"> </span><span class="kw">dnorm</span>(mu.s[j], tau)</span>
<span id="cb4-6"><a href="ch-SMMR.html#cb4-6"></a></span>
<span id="cb4-7"><a href="ch-SMMR.html#cb4-7"></a>    <span class="co"># linear predictors</span></span>
<span id="cb4-8"><a href="ch-SMMR.html#cb4-8"></a>    <span class="co"># (hierarchical centring specification and &quot;epsilon trick&quot;)</span></span>
<span id="cb4-9"><a href="ch-SMMR.html#cb4-9"></a>    mu.y[j] &lt;-<span class="st"> </span><span class="kw">inprod</span>(b[subj[j], <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>], Z.y[j, ]) <span class="op">+</span><span class="st"> </span>eps[j, <span class="dv">1</span>]</span>
<span id="cb4-10"><a href="ch-SMMR.html#cb4-10"></a>    mu.s[j] &lt;-<span class="st"> </span><span class="kw">inprod</span>(b[subj[j], <span class="dv">3</span><span class="op">:</span><span class="dv">4</span>], Z.s[j, ]) <span class="op">+</span><span class="st"> </span>eps[j, <span class="dv">2</span>]</span>
<span id="cb4-11"><a href="ch-SMMR.html#cb4-11"></a></span>
<span id="cb4-12"><a href="ch-SMMR.html#cb4-12"></a>    eps[j, <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>] <span class="op">~</span><span class="st"> </span><span class="kw">dmnorm</span>(mu.eps[], inv.Sig[ , ])</span>
<span id="cb4-13"><a href="ch-SMMR.html#cb4-13"></a>  }</span>
<span id="cb4-14"><a href="ch-SMMR.html#cb4-14"></a></span>
<span id="cb4-15"><a href="ch-SMMR.html#cb4-15"></a>  <span class="co"># priors for the precision of y and s</span></span>
<span id="cb4-16"><a href="ch-SMMR.html#cb4-16"></a>  <span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>) {</span>
<span id="cb4-17"><a href="ch-SMMR.html#cb4-17"></a>    priorR.invSig[k, k] <span class="op">~</span><span class="st"> </span><span class="kw">dgamma</span>(<span class="fl">0.1</span>, <span class="fl">0.01</span>)</span>
<span id="cb4-18"><a href="ch-SMMR.html#cb4-18"></a>  }</span>
<span id="cb4-19"><a href="ch-SMMR.html#cb4-19"></a>  inv.Sig[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>] <span class="op">~</span><span class="st"> </span><span class="kw">dwish</span>(priorR.invSig[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>], <span class="dv">2</span>)</span>
<span id="cb4-20"><a href="ch-SMMR.html#cb4-20"></a>  Sig[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">inverse</span>(inv.Sig[ , ])</span>
<span id="cb4-21"><a href="ch-SMMR.html#cb4-21"></a></span>
<span id="cb4-22"><a href="ch-SMMR.html#cb4-22"></a></span>
<span id="cb4-23"><a href="ch-SMMR.html#cb4-23"></a>  <span class="co"># specification of the random effects</span></span>
<span id="cb4-24"><a href="ch-SMMR.html#cb4-24"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) {</span>
<span id="cb4-25"><a href="ch-SMMR.html#cb4-25"></a>    <span class="co"># random effects in the model for y</span></span>
<span id="cb4-26"><a href="ch-SMMR.html#cb4-26"></a>    b[i, <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>] <span class="op">~</span><span class="st"> </span><span class="kw">dmnorm</span>(mu.b[i, <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>], inv.D[ , ])</span>
<span id="cb4-27"><a href="ch-SMMR.html#cb4-27"></a>    mu.b[i, <span class="dv">1</span>] &lt;-<span class="st"> </span>beta[<span class="dv">1</span>, <span class="dv">1</span>]</span>
<span id="cb4-28"><a href="ch-SMMR.html#cb4-28"></a>    mu.b[i, <span class="dv">2</span>] &lt;-<span class="st"> </span>beta[<span class="dv">2</span>, <span class="dv">1</span>]</span>
<span id="cb4-29"><a href="ch-SMMR.html#cb4-29"></a></span>
<span id="cb4-30"><a href="ch-SMMR.html#cb4-30"></a>    <span class="co"># random effects in the model for s</span></span>
<span id="cb4-31"><a href="ch-SMMR.html#cb4-31"></a>    mu.b[i, <span class="dv">3</span>] &lt;-<span class="st"> </span>beta[<span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb4-32"><a href="ch-SMMR.html#cb4-32"></a>    mu.b[i, <span class="dv">4</span>] &lt;-<span class="st"> </span>beta[<span class="dv">2</span>, <span class="dv">2</span>]</span>
<span id="cb4-33"><a href="ch-SMMR.html#cb4-33"></a>  }</span>
<span id="cb4-34"><a href="ch-SMMR.html#cb4-34"></a></span>
<span id="cb4-35"><a href="ch-SMMR.html#cb4-35"></a>  </span>
<span id="cb4-36"><a href="ch-SMMR.html#cb4-36"></a>  <span class="co"># priors for the precision of the random effects</span></span>
<span id="cb4-37"><a href="ch-SMMR.html#cb4-37"></a>  <span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) {</span>
<span id="cb4-38"><a href="ch-SMMR.html#cb4-38"></a>    priorR.invD[k, k] <span class="op">~</span><span class="st"> </span><span class="kw">dgamma</span>(<span class="fl">0.1</span>, <span class="fl">0.01</span>)</span>
<span id="cb4-39"><a href="ch-SMMR.html#cb4-39"></a>  }</span>
<span id="cb4-40"><a href="ch-SMMR.html#cb4-40"></a></span>
<span id="cb4-41"><a href="ch-SMMR.html#cb4-41"></a>  <span class="co"># precision and covariance matrix of the random effects</span></span>
<span id="cb4-42"><a href="ch-SMMR.html#cb4-42"></a>  inv.D[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>] <span class="op">~</span><span class="st"> </span><span class="kw">dwish</span>(priorR.invD[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>], <span class="dv">4</span>)</span>
<span id="cb4-43"><a href="ch-SMMR.html#cb4-43"></a>  D[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>] &lt;-<span class="st"> </span><span class="kw">inverse</span>(inv.D[ , ])</span>
<span id="cb4-44"><a href="ch-SMMR.html#cb4-44"></a></span>
<span id="cb4-45"><a href="ch-SMMR.html#cb4-45"></a>  <span class="co"># priors for the fixed effects</span></span>
<span id="cb4-46"><a href="ch-SMMR.html#cb4-46"></a>  <span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>) {</span>
<span id="cb4-47"><a href="ch-SMMR.html#cb4-47"></a>    beta[k, <span class="dv">1</span>] <span class="op">~</span><span class="st"> </span><span class="kw">dnorm</span>(<span class="dv">0</span>, <span class="fl">0.001</span>)</span>
<span id="cb4-48"><a href="ch-SMMR.html#cb4-48"></a>    beta[k, <span class="dv">2</span>] <span class="op">~</span><span class="st"> </span><span class="kw">dnorm</span>(<span class="dv">0</span>, <span class="fl">0.001</span>)</span>
<span id="cb4-49"><a href="ch-SMMR.html#cb4-49"></a>  }</span>
<span id="cb4-50"><a href="ch-SMMR.html#cb4-50"></a>}</span></code></pre></div>



</div>
</div>
</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-Andrinopoulou2016">
<p>Andrinopoulou, Eleni-Rosalina, and Dimitris Rizopoulos. 2016. “Bayesian Shrinkage Approach for a Joint Model of Longitudinal and Survival Outcomes Assuming Different Association Structures.” <em>Statistics in Medicin</em> 35 (26): 4813–23. <a href="https://doi.org/10.1002/sim.7027">https://doi.org/10.1002/sim.7027</a>.</p>
</div>
<div id="ref-Bartlett2015">
<p>Bartlett, Jonathan W., Shaun R. Seaman, Ian R. White, and James R. Carpenter. 2015. “Multiple Imputation of Covariates by Fully Conditional Specification: Accommodating the Substantive Model.” <em>Statistical Methods in Medical Research</em> 24 (4): 462–87. <a href="https://doi.org/10.1177/0962280214521348">https://doi.org/10.1177/0962280214521348</a>.</p>
</div>
<div id="ref-lme4">
<p>Bates, Douglas, Martin Mächler, Ben Bolker, and Steve Walker. 2015. “Fitting Linear Mixed-Effects Models Using lme4.” <em>Journal of Statistical Software</em> 67 (1): 1–48. <a href="https://doi.org/10.18637/jss.v067.i01">https://doi.org/10.18637/jss.v067.i01</a>.</p>
</div>
<div id="ref-Realcom">
<p>Carpenter, James R., Harvey Goldstein, and Michael G. Kenward. 2011. “REALCOM-IMPUTE Software for Multilevel Multiple Imputation with Mixed Response Types.” <em>Journal of Statistical Software</em> 45 (1): 1–14. <a href="https://doi.org/10.18637/jss.v045.i05">https://doi.org/10.18637/jss.v045.i05</a>.</p>
</div>
<div id="ref-Carpenter2013">
<p>Carpenter, James R., and Michael G. Kenward. 2013. <em>Multiple Imputation and Its Application</em>. John Wiley &amp; Sons, Ltd. <a href="https://doi.org/10.1002/9781119942283">https://doi.org/10.1002/9781119942283</a>.</p>
</div>
<div id="ref-Daniels2008">
<p>Daniels, Michael J., and Joseph W. Hogan. 2008. <em>Missing Data in Longitudinal Studies: Strategies for Bayesian Modeling and Sensitivity Analysis</em>. Boca Raton, FL: Chapman &amp; Hall/CRC. <a href="https://doi.org/10.1201/9781420011180">https://doi.org/10.1201/9781420011180</a>.</p>
</div>
<div id="ref-Diggle2002">
<p>Diggle, Peter, Patrick Heagerty, Kung-Yee Liang, and Scott Zeger. 2002. <em>Analysis of Longitudinal Data</em>. Oxford, United Kingdom: Oxford University Press.</p>
</div>
<div id="ref-Engle1983">
<p>Engle, Robert F., David F. Hendry, and Jean-Francois Richard. 1983. “Exogeneity.” <em>Econometrica</em> 51 (2): 277–304. <a href="https://doi.org/10.2307/1911990">https://doi.org/10.2307/1911990</a>.</p>
</div>
<div id="ref-Erler2016">
<p>Erler, Nicole S., Dimitris Rizopoulos, Joost van Rosmalen, Vincent W. V. Jaddoe, Oscar H. Franco, and Emmanuel M. E. H. Lesaffre. 2016. “Dealing with Missing Covariates in Epidemiologic Studies: A Comparison Between Multiple Imputation and a Full Bayesian Approach.” <em>Statistics in Medicine</em> 35 (17): 2955–74. <a href="https://doi.org/10.1002/sim.6944">https://doi.org/10.1002/sim.6944</a>.</p>
</div>
<div id="ref-Garrett2000">
<p>Garrett, Elizabeth S., and Scott L. Zeger. 2000. “Latent Class Model Diagnosis.” <em>Biometrics</em> 56 (4): 1055–67. <a href="https://doi.org/10.1111/j.0006-341X.2000.01055.x">https://doi.org/10.1111/j.0006-341X.2000.01055.x</a>.</p>
</div>
<div id="ref-Gelman1996">
<p>Gelman, Andrew, Xiao-Li Meng, and Hal Stern. 1996. “Posterior Predictive Assessment of Model Fitness via Realized Discrepancies.” <em>Statistica Sinica</em> 6 (4): 733–60.</p>
</div>
<div id="ref-Ibrahim2002">
<p>Ibrahim, Joseph G., Ming-Hui Chen, and Stuart R. Lipsitz. 2002. “Bayesian Methods for Generalized Linear Models with Covariates Missing at Random.” <em>Canadian Journal of Statistics</em> 30 (1): 55–78. <a href="https://doi.org/10.2307/3315865">https://doi.org/10.2307/3315865</a>.</p>
</div>
<div id="ref-GenR2017">
<p>Kooijman, Marjolein N., Claudia J. Kruithof, Cornelia M. van Duijn, Liesbeth Duijts, Oscar H. Franco, Marinus H. van IJzendoorn, Johan C. de Jongste, et al. 2016. “The Generation R Study: Design and Cohort Update 2017.” <em>European Journal of Epidemiology</em> 31 (12): 1243–64. <a href="https://doi.org/10.1007/s10654-016-0224-9">https://doi.org/10.1007/s10654-016-0224-9</a>.</p>
</div>
<div id="ref-Lesaffre2012">
<p>Lesaffre, Emmanuel M. E. H., and Andrew B. Lawson. 2012. <em>Bayesian Biostatistics</em>. John Wiley &amp; Sons. <a href="https://doi.org/10.1002/9781119942412">https://doi.org/10.1002/9781119942412</a>.</p>
</div>
<div id="ref-Little2002">
<p>Little, Roderick J. A., and Donald B. Rubin. 2002. <em>Statistical Analysis with Missing Data</em>. Hoboken, New Jersey: John Wiley &amp; Sons, Inc. <a href="https://doi.org/10.1002/9781119013563">https://doi.org/10.1002/9781119013563</a>.</p>
</div>
<div id="ref-WinBUGS">
<p>Lunn, David J., Andrew Thomas, Nicky Best, and David Spiegelhalter. 2000. “WinBUGS – a Bayesian modelling framework: Concepts, structure, and extensibility.” <em>Statistics and Computing</em> 10 (4): 325–37. <a href="https://doi.org/10.1023/A:1008929526011">https://doi.org/10.1023/A:1008929526011</a>.</p>
</div>
<div id="ref-Mallick2013">
<p>Mallick, Himel, and Nengjun Yi. 2013. “Bayesian Methods for High Dimensional Linear Models.” <em>Journal of Biometrics &amp; Biostatistics</em> 4 (S3): S1–005. <a href="https://doi.org/10.4172/2155-6180.S1-005">https://doi.org/10.4172/2155-6180.S1-005</a>.</p>
</div>
<div id="ref-JAGS">
<p>Plummer, M. 2003. “JAGS: A Program for Analysis of Bayesian Graphical Models Using Gibbs Sampling.” Edited by Kurt Hornik, Friedrich Leisch, and Achim Zeileis.</p>
</div>
<div id="ref-rjags2016">
<p>Plummer, Martyn. 2016. <em>rjags: Bayesian Graphical Models using MCMC</em>. <a href="https://CRAN.R-project.org/package=rjags">https://CRAN.R-project.org/package=rjags</a>.</p>
</div>
<div id="ref-jomo2016">
<p>Quartagno, Matteo, and James R. 2016. <em>jomo: A Package for Multilevel Joint Modelling Multiple Imputation</em>. <a href="http://CRAN.R-project.org/package=jomo">http://CRAN.R-project.org/package=jomo</a>.</p>
</div>
<div id="ref-R2016">
<p>R Core Team. 2016. <em>R: A Language and Environment for Statistical Computing</em>. Vienna, Austria: R Foundation for Statistical Computing. <a href="http://www.R-project.org/">http://www.R-project.org/</a>.</p>
</div>
<div id="ref-Rubin1987">
<p>Rubin, Donald B. 1987. <em>Multiple Imputation for Nonresponse in Surveys</em>. Wiley Series in Probability and Statistics. Wiley. <a href="https://doi.org/10.1002/9780470316696">https://doi.org/10.1002/9780470316696</a>.</p>
</div>
<div id="ref-Seaman2012">
<p>Seaman, Shaun R., Jonathan W. Bartlett, and Ian R. White. 2012. “Multiple Imputation of Missing Covariates with Non-Linear Effects and Interactions: An Evaluation of Statistical Methods.” <em>BMC Medical Research Methodology</em> 12 (1): 46. <a href="https://doi.org/10.1186/1471-2288-12-46">https://doi.org/10.1186/1471-2288-12-46</a>.</p>
</div>
<div id="ref-Tielemans2015">
<p>Tielemans, Myrte J., Nicole S. Erler, Elisabeth T. M. Leermakers, Marion van den Broek, Vincent W. V. Jaddoe, Eric A. P. Steegers, Jessica C. Kiefte-de Jong, and Oscar H. Franco. 2015. “A Priori and a Posteriori Dietary Patterns During Pregnancy and Gestational Weight Gain: The Generation R Study.” <em>Nutrients</em> 7 (11): 9383–99. <a href="https://doi.org/10.3390/nu7115476">https://doi.org/10.3390/nu7115476</a>.</p>
</div>
<div id="ref-Buuren2012">
<p>Van Buuren, Stef. 2012. <em>Flexible Imputation of Missing Data</em>. Chapman &amp; Hall/CRC Interdisciplinary Statistics. Taylor &amp; Francis.</p>
</div>
<div id="ref-White2011">
<p>White, Ian R., Patrick Royston, and Angela M. Wood. 2011. “Multiple imputation using chained equations: Issues and guidance for practice.” <em>Statistics in Medicine</em> 30 (4): 377–99. <a href="https://doi.org/10.1002/sim.4067">https://doi.org/10.1002/sim.4067</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="ch-Vincent.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="ch-JSS.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
